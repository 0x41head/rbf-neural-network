<!DOCTYPE html>
<!-- Generated by Cython 0.23.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: geometry.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.23.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="geometry.c">geometry.c</a></p>
<div class="cython"><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0001</span>: <span class="c"># distutils: extra_compile_args = -fopenmp </span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="c"># distutils: extra_link_args = -fopenmp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="sd">Description </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="sd">----------- </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="sd">  Defines functions for basic computational geometry in 1, 2, and 3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="sd">  dimensions. This modules requires all volumes, surfaces and segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="sd">  to be described as simplicial complexes, that is, as a collection of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="sd">  simplexes defined by their vertices.  Most end user functions in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="sd">  this module have a vertices and simplices argument, the former is a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="sd">  (N,D) collection of all D dimensional vertices in the simplicial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="sd">  complex and the latter is an (M,D) array of vertex indices making up</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="sd">  each simplex. For example the unit square in two dimensions can be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="sd">  described as collection of line segments:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: <span class="sd">  &gt;&gt;&gt; vertices = [[0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="sd">                  [1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: <span class="sd">                  [1.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="sd">                  [0.0,1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="sd">  &gt;&gt;&gt; simplices = [[0,1],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: <span class="sd">                   [1,2],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="sd">                   [2,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: <span class="sd">                   [3,0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: <span class="sd">  A three dimensional cube can similarly be described as a collection</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="sd">  of triangles:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="sd">  &gt;&gt;&gt; vertices = [[0.0,0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="sd">                  [0.0,0.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="sd">                  [0.0,1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="sd">                  [0.0,1.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: <span class="sd">                  [1.0,0.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="sd">                  [1.0,0.0,1.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: <span class="sd">                  [1.0,1.0,0.0],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="sd">                  [1.0,1.0,1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>: <span class="sd">  &gt;&gt;&gt; simplices = [[0,1,4],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="sd">                   [1,5,4],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="sd">                   [1,7,5],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="sd">                   [1,3,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="sd">                   [0,1,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: <span class="sd">                   [0,2,3],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="sd">                   [0,2,6],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="sd">                   [0,4,6],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="sd">                   [4,5,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: <span class="sd">                   [4,6,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="sd">                   [2,3,7],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="sd">                   [2,6,7]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">  Although the notation is clumsy, a 1D domains can be described as a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">  collection of vertices in a manner that is consistent with the above</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="sd">  two examples:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="sd">   </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">  &gt;&gt;&gt; vertices = [[0.0],[1.0]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">  &gt;&gt;&gt; simplices = [[0],[1]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">  This module is primarily use to find whether and where line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="sd">  intersect a simplicial complex and whether points are contained</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>: <span class="sd">  within a closed simplicial complex.  For example, one can determine</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">  whether a collection of points, saved as &#39;points&#39;, are contained</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: <span class="sd">  within a simplicial complex, defined by &#39;vertices&#39; and &#39;simplices&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span class="sd">  with the command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="sd">  &gt;&gt;&gt; complex_contains(points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="sd">  which returns a boolean array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="sd">  One can find the number of times a collection of line segments,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="sd">  defined by &#39;start_points&#39; and &#39;end_points&#39;, intersect a simplicial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="sd">  complex with the command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="sd">  &gt;&gt; complex_cross_count(start_points,end_points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="sd">  which returns an array of the number of simplexes intersections for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="sd">  each segment. If it is known that a collection of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: <span class="sd">  intersect a simplicial complex then the intersection point can be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="sd">  found with the command</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>: <span class="sd">  &gt;&gt; complex_intersection(start_points,end_points,vertices,simplices)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: <span class="sd"> </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="sd">  This returns an (N,D) array of intersection points where N is the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: <span class="sd">  number of line segments.  If a line segment does not intersect the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="sd">  simplicial complex then the above command returns a ValueError. If</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="sd">  there are multiple intersections for a single segment then only the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="sd">  first detected intersection will be returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0087</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0088</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">cimport</span> <span class="n">prange</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>: <span class="k">from</span> <span class="nn">cython</span> <span class="k">cimport</span> <span class="n">boundscheck</span><span class="p">,</span><span class="n">wraparound</span><span class="p">,</span><span class="n">cdivision</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">rand</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span><span class="n">free</span></pre>
<pre class="cython line score-19" onclick='toggleDiv(this)'>+<span class="">0093</span>: <span class="k">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_combinations);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_combinations);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_combinations);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_combinations, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0094</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="c"># NOTE: fabs is not the same as abs in C!!! </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">fabs</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">sqrt</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;limits.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>:     <span class="nb">int</span> <span class="n">RAND_MAX</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0105</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector2d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_vector2d {
  double x;
  double y;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0106</span>:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0109</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment2d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_segment2d {
  struct __pyx_t_3rbf_8geometry_vector2d a;
  struct __pyx_t_3rbf_8geometry_vector2d b;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0110</span>:   <span class="n">vector2d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>:   <span class="n">vector2d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0113</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_vector3d {
  double x;
  double y;
  double z;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0114</span>:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>:   <span class="n">double</span> <span class="n">z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0118</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_segment3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0119</span>:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0122</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">triangle3d</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_3rbf_8geometry_triangle3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
  struct __pyx_t_3rbf_8geometry_vector3d c;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">0123</span>:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>:   <span class="n">vector3d</span> <span class="n">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0128</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min2</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_3rbf_8geometry_min2(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0129</span>:   <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_a &lt;= __pyx_v_b) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0130</span>:     <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_a;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0131</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0132</span>:     <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0134</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">max2</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_3rbf_8geometry_max2(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0135</span>:   <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_a &gt;= __pyx_v_b) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0136</span>:     <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_a;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0137</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0138</span>:     <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0140</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min3</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">,</span> <span class="n">double</span> <span class="n">c</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_3rbf_8geometry_min3(double __pyx_v_a, double __pyx_v_b, double __pyx_v_c) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0141</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_a &lt;= __pyx_v_b) &amp; (__pyx_v_a &lt;= __pyx_v_c)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0142</span>:     <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_a;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0143</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0144</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_b &lt;= __pyx_v_a) &amp; (__pyx_v_b &lt;= __pyx_v_c)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0145</span>:     <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0146</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0147</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">c</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_c &lt;= __pyx_v_a) &amp; (__pyx_v_c &lt;= __pyx_v_b)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0148</span>:     <span class="k">return</span> <span class="n">c</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_c;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0154</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">find_outside_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry_find_outside_2d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0155</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0159</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0160</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0161</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_v.shape[0]);
  for (__pyx_t_6 = 1; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0162</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_7 * __pyx_v_v.strides[0]) ) + __pyx_t_8 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_9) {
/* … */
    }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0163</span>:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_10 * __pyx_v_v.strides[0]) ) + __pyx_t_11 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0164</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0165</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_t_9 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_12 * __pyx_v_v.strides[0]) ) + __pyx_t_13 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_9) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0166</span>:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) ) + __pyx_t_15 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0168</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0169</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class="cython line score-0">&#xA0;<span class="">0170</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0171</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0176</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">find_outside_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry_find_outside_3d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0181</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0182</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0183</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = 0;
  __pyx_t_6 = 2;
  __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_5 * __pyx_v_v.strides[0]) ) + __pyx_t_6 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0184</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_v_v.shape[0]);
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0185</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_9 * __pyx_v_v.strides[0]) ) + __pyx_t_10 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0186</span>:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_12 * __pyx_v_v.strides[0]) ) + __pyx_t_13 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0187</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0188</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) ) + __pyx_t_15 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0189</span>:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_i;
      __pyx_t_17 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) ) + __pyx_t_17 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0190</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0191</span>:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">z</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) ) + __pyx_t_19 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.z) != 0);
    if (__pyx_t_11) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0192</span>:       <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = 2;
      __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) ) + __pyx_t_21 * __pyx_v_v.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0194</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0195</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0196</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">-=</span> <span class="mf">3.45678912</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (__pyx_v_out.z - 3.45678912);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0197</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0203</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_is_intersecting_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_n1;
  double __pyx_v_n2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_pnt;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0204</span>:                              <span class="n">segment2d</span> <span class="n">seg2</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>: <span class="sd">    Identifies whether two 2D segments intersect. An intersection is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>: <span class="sd">    detected if both segments are not colinear and if any part of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>: <span class="sd">    two segments touch</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>:     <span class="n">vector2d</span> <span class="n">pnt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>:   <span class="c"># find the normal vector components for segment 2</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0217</span>:   <span class="n">n1</span> <span class="o">=</span>  <span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n1 = (__pyx_v_seg2.b.y - __pyx_v_seg2.a.y);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0218</span>:   <span class="n">n2</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n2 = (-(__pyx_v_seg2.b.x - __pyx_v_seg2.a.x));
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>:   <span class="c"># project both points in segment 1 onto the normal vector</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0221</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n1) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n2));
</pre><pre class="cython line score-0">&#xA0;<span class="">0222</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0223</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n1) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n2));
</pre><pre class="cython line score-0">&#xA0;<span class="">0224</span>:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0225</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0226</span>:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0227</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0228</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0229</span>:   <span class="c"># return false if the segments are collinear</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0230</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0231</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>:   <span class="c"># find the point where segment 1 intersects the line overlapping </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>:   <span class="c"># segment 2 </span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0235</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.x = (__pyx_v_seg1.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.x - __pyx_v_seg1.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0236</span>:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0237</span>:   <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pnt.y = (__pyx_v_seg1.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.y - __pyx_v_seg1.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0238</span>:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>:   <span class="c"># if the normal x component is larger then compare y values</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0241</span>:   <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((fabs(__pyx_v_n1) &gt;= fabs(__pyx_v_n2)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0242</span>:     <span class="k">if</span> <span class="p">((</span><span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">min2</span><span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span> <span class="o">&amp;</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (((__pyx_v_pnt.y &gt;= __pyx_f_3rbf_8geometry_min2(__pyx_v_seg2.a.y, __pyx_v_seg2.b.y)) &amp; (__pyx_v_pnt.y &lt;= __pyx_f_3rbf_8geometry_max2(__pyx_v_seg2.a.y, __pyx_v_seg2.b.y))) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0243</span>:         <span class="p">(</span><span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">max2</span><span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))):</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0244</span>:       <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 1;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0245</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0246</span>:       <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = 0;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>:   <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0249</span>:     <span class="k">if</span> <span class="p">((</span><span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">min2</span><span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
/* … */
    __pyx_t_1 = (((__pyx_v_pnt.x &gt;= __pyx_f_3rbf_8geometry_min2(__pyx_v_seg2.a.x, __pyx_v_seg2.b.x)) &amp; (__pyx_v_pnt.x &lt;= __pyx_f_3rbf_8geometry_max2(__pyx_v_seg2.a.x, __pyx_v_seg2.b.x))) != 0);
/* … */
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0250</span>:         <span class="p">(</span><span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">max2</span><span class="p">(</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">))):</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0251</span>:       <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 1;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0252</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0253</span>:       <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = 0;
      goto __pyx_L0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0257</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0258</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_count_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_count_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_count_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_count_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>: <span class="sd">    returns an array containing the number of simplexes intersected</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0266</span>: <span class="sd">    between start_pnts and end_pnts.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0269</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0271</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0272</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0273</span>:     <span class="n">segment2d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0274</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0275</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0276</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0278</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0279</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0280</span>:       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_7 = __pyx_v_N;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_9 = (__pyx_t_7 - 0) / 1;
              if (__pyx_t_9 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)
                      #endif /* _OPENMP */
                      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_9; __pyx_t_8++){
                          {
                              __pyx_v_i = 0 + 1 * __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0281</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_i;
                              __pyx_t_11 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0282</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_12 = __pyx_v_i;
                              __pyx_t_13 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0283</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_14 = __pyx_v_i;
                              __pyx_t_15 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0284</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_16 = __pyx_v_i;
                              __pyx_t_17 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0285</span>:         <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cross_count_2d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_18 = __pyx_v_i;
                              *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__cross_count_2d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0288</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>: </pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0290</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0295</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_cross_count_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry__cross_count_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0296</span>:                          <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0297</span>:                          <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0300</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0301</span>:     <span class="n">segment2d</span> <span class="n">dummy_seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0303</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0304</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_dummy_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0305</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_dummy_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0306</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 0;
    __pyx_v_dummy_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0307</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 1;
    __pyx_v_dummy_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0308</span>:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">dummy_seg</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg, __pyx_v_dummy_seg) != 0);
    if (__pyx_t_19) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0309</span>:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0310</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0311</span>:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0316</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_which_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_which_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_which_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_which_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0317</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>:                                <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0323</span>: <span class="sd">    returns an array identifying which simplex is intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>: <span class="sd">    start_pnts and end_pnts. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0325</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0333</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0334</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0335</span>:     <span class="n">segment2d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0336</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0337</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0338</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0339</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0340</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0341</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0342</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0343</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0344</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0345</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0346</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cross_which_2d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_f_3rbf_8geometry__cross_which_2d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_t_18 = __pyx_v_i;
      *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) )) = __pyx_t_17;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0347</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0349</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0; __pyx_t_24 = 0; __pyx_t_25 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_23, &amp;__pyx_t_24, &amp;__pyx_t_25);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_20, &amp;__pyx_t_21, &amp;__pyx_t_22) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_20, &amp;__pyx_t_21, &amp;__pyx_t_22);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_22);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_23);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_25);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_19 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_23);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_25);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_23, __pyx_t_24, __pyx_t_25);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0; __pyx_t_24 = 0; __pyx_t_25 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_19;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0350</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0351</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_26 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_26);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_26, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_26, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_26, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0352</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0356</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_cross_which_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static int __pyx_f_3rbf_8geometry__cross_which_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_which_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_which_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0357</span>:                          <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>:                          <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>:     <span class="n">segment2d</span> <span class="n">dummy_seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0363</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0364</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_dummy_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0365</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_dummy_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0366</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 0;
    __pyx_v_dummy_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0367</span>:     <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 1;
    __pyx_v_dummy_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0368</span>:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">dummy_seg</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg, __pyx_v_dummy_seg) != 0);
    if (__pyx_t_19) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0369</span>:       <span class="k">return</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_i;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0370</span>: </pre>
<pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0371</span>:   <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-15 '>  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
  __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_23);
  __pyx_t_23 = 0;
  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_t_24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_23, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0372</span>:                    <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython code score-29 '>  __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_22 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 2, __pyx_t_22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 3, __pyx_t_23);
  __pyx_t_20 = 0;
  __pyx_t_21 = 0;
  __pyx_t_22 = 0;
  __pyx_t_23 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0373</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0374</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0376</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_where_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_where_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_where_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_where_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0377</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0378</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>:                                <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0380</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span class="sd">    returns an array of intersection points between line segments,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: <span class="sd">    defined in terms of start_pnts and end_pnts, and simplices. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0393</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0394</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0395</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0396</span>:     <span class="n">segment2d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0397</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0398</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0399</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0400</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0401</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0402</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0403</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0404</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0405</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0406</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0407</span>:       <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_where_2d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_f_3rbf_8geometry__cross_where_2d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 407; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_v_vec = __pyx_t_17;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0408</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_vec.x;
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = 0;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_19 * __pyx_v_out.strides[0]) ) + __pyx_t_20 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0409</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_vec.y;
      __pyx_t_21 = __pyx_v_i;
      __pyx_t_22 = 1;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) ) + __pyx_t_22 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0412</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_27, &amp;__pyx_t_28, &amp;__pyx_t_29);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_27);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_28);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_29);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_23 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_27);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_27, __pyx_t_28, __pyx_t_29);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_26);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_23;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0413</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0414</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_30 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_30, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0415</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0420</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_cross_where_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__cross_where_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_idx;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_n1;
  double __pyx_v_n2;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_where_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_where_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0421</span>:                               <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>:                               <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:     <span class="n">segment2d</span> <span class="n">dummy_seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0429</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_cross_which_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__cross_which_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0430</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_dummy_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0431</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_dummy_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0432</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 1;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 0;
  __pyx_v_dummy_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0433</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 1;
  __pyx_v_dummy_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0434</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0435</span>:   <span class="n">n1</span> <span class="o">=</span>  <span class="p">(</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n1 = (__pyx_v_dummy_seg.b.y - __pyx_v_dummy_seg.a.y);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0436</span>:   <span class="n">n2</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n2 = (-(__pyx_v_dummy_seg.b.x - __pyx_v_dummy_seg.a.x));
</pre><pre class="cython line score-0">&#xA0;<span class="">0437</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0438</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = (((__pyx_v_seg.a.x - __pyx_v_dummy_seg.a.x) * __pyx_v_n1) + ((__pyx_v_seg.a.y - __pyx_v_dummy_seg.a.y) * __pyx_v_n2));
</pre><pre class="cython line score-0">&#xA0;<span class="">0439</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0440</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = (((__pyx_v_seg.b.x - __pyx_v_dummy_seg.a.x) * __pyx_v_n1) + ((__pyx_v_seg.b.y - __pyx_v_dummy_seg.a.y) * __pyx_v_n2));
</pre><pre class="cython line score-0">&#xA0;<span class="">0441</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0443</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0444</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0445</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0446</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0448</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0449</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0451</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0452</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0453</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_normals_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_normals_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_seg_array;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_normals_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_normals_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:                                  <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>: <span class="sd">    returns an array of normal vectors to the simplices intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: <span class="sd">    the line segments described in terms of start_pnts and end_pnts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">    if there is not intersection then a ValueError is returned</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0470</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0471</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0472</span>:     <span class="n">segment2d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0473</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0475</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0476</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0477</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0478</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0479</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0480</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0481</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0482</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_13 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0483</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0484</span>:       <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_normals_2d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_f_3rbf_8geometry__cross_normals_2d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_v_vec = __pyx_t_17;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0485</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_vec.x;
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = 0;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_19 * __pyx_v_out.strides[0]) ) + __pyx_t_20 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0486</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_vec.y;
      __pyx_t_21 = __pyx_v_i;
      __pyx_t_22 = 1;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) ) + __pyx_t_22 * __pyx_v_out.strides[1]) )) = __pyx_t_18;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0489</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_27, &amp;__pyx_t_28, &amp;__pyx_t_29);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_27);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_28);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_29);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_23 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_27);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_27, __pyx_t_28, __pyx_t_29);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_26);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_23;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0490</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0491</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_30 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_30, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0497</span>: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_cross_normals_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__cross_normals_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_n;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_normals_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_normals_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0498</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:     <span class="n">segment2d</span> <span class="n">dummy_seg</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0506</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_cross_which_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__cross_which_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0507</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_dummy_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0508</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_dummy_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0509</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 1;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 0;
  __pyx_v_dummy_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0510</span>:   <span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 1;
  __pyx_v_dummy_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0511</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0512</span>:   <span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="p">(</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vec.x = (__pyx_v_dummy_seg.b.y - __pyx_v_dummy_seg.a.y);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0513</span>:   <span class="n">vec</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vec.y = (-(__pyx_v_dummy_seg.b.x - __pyx_v_dummy_seg.a.x));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0514</span>:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj = (((__pyx_v_seg.b.x - __pyx_v_dummy_seg.a.x) * __pyx_v_vec.x) + ((__pyx_v_seg.b.y - __pyx_v_dummy_seg.a.y) * __pyx_v_vec.y));
</pre><pre class="cython line score-0">&#xA0;<span class="">0515</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">dummy_seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0516</span>:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = ((__pyx_v_proj &lt;= 0.0) != 0);
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0517</span>:     <span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vec.x = (__pyx_v_vec.x * -1.0);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0518</span>:     <span class="n">vec</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vec.y = (__pyx_v_vec.y * -1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0519</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0520</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = sqrt((pow(__pyx_v_vec.x, 2.0) + pow(__pyx_v_vec.y, 2.0)));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0521</span>:   <span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vec.x = (__pyx_v_vec.x / __pyx_v_n);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0522</span>:   <span class="n">vec</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vec.y = (__pyx_v_vec.y / __pyx_v_n);
</pre><pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0524</span>:   <span class="k">return</span> <span class="n">vec</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_vec;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0525</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0527</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0528</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0529</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_2d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d *__pyx_v_seg_array;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0530</span>:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: <span class="sd">    returns a boolean array identifying which points are contained in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: <span class="sd">    the closed simplicial complex described by vertices and simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0541</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0542</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0543</span>:     <span class="n">segment2d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment2d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment2d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment2d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment2d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0544</span>:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0546</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0547</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0548</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0549</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0550</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">find_outside_2d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vec = __pyx_f_3rbf_8geometry_find_outside_2d(__pyx_v_vertices);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0551</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0552</span>:       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_7 = __pyx_v_N;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_9 = (__pyx_t_7 - 0) / 1;
              if (__pyx_t_9 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_count) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)
                      #endif /* _OPENMP */
                      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_9; __pyx_t_8++){
                          {
                              __pyx_v_i = 0 + 1 * __pyx_t_8;
                              /* Initialize private variables to invalid values */
                              __pyx_v_count = ((int)0xbad0bad0);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0553</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_vec.x;
                              (__pyx_v_seg_array[__pyx_v_i]).a.x = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0554</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_vec.y;
                              (__pyx_v_seg_array[__pyx_v_i]).a.y = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0555</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_11 = __pyx_v_i;
                              __pyx_t_12 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_11 * __pyx_v_pnt.strides[0]) ) + __pyx_t_12 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0556</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_13 = __pyx_v_i;
                              __pyx_t_14 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_13 * __pyx_v_pnt.strides[0]) ) + __pyx_t_14 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0557</span>:         <span class="n">count</span> <span class="o">=</span> <span class="n">_cross_count_2d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                              __pyx_v_count = __pyx_f_3rbf_8geometry__cross_count_2d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0558</span>:         <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_15 = __pyx_v_i;
                              *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_15 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0561</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0562</span>: </pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0563</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0564</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0569</span>: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry_is_intersecting_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri) {
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_dummy_pnt1;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_dummy_pnt2;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg1;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg2;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg3;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_dummy_seg4;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_n1;
  double __pyx_v_n2;
  double __pyx_v_n3;
  unsigned int __pyx_v_count;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0570</span>:                              <span class="n">triangle3d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0573</span>: <span class="sd">  ----------- </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0574</span>: <span class="sd">    returns True if the 3D segment intersects the 3D triangle. An</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>: <span class="sd">    intersection is detected if the segment and triangle are not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0576</span>: <span class="sd">    coplanar and if any part of the segment touches the triangle at an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: <span class="sd">    edge or in the interior. Intersections at corners are not detected</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="sd">    This function determines where the segment intersects the plane</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="sd">    containing the triangle and then projects the intersection point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: <span class="sd">    and triangle into 2D where a point in polygon test is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="sd">    performed. Although rare, 2D point in polygon tests can fail if</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="sd">    the randomly determined outside point and the test point cross a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="sd">    vertex of the polygon. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:     <span class="n">vector3d</span> <span class="n">dummy_pnt1</span><span class="p">,</span><span class="n">dummy_pnt2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:     <span class="n">segment2d</span> <span class="n">dummy_seg1</span><span class="p">,</span><span class="n">dummy_seg2</span><span class="p">,</span><span class="n">dummy_seg3</span><span class="p">,</span><span class="n">dummy_seg4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">n3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span><span class="p">,</span><span class="n">idx1</span><span class="p">,</span><span class="n">idx2</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0593</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>:   <span class="c"># find point which is definitively outside of the triangle when</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>:   <span class="c"># viewed from either the x, y, or z axis </span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0597</span>:   <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">min3</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt2.x = (__pyx_f_3rbf_8geometry_min3(__pyx_v_tri.a.x, __pyx_v_tri.b.x, __pyx_v_tri.c.x) - 1.23456789);
</pre><pre class="cython line score-0">&#xA0;<span class="">0598</span>:                   <span class="mf">1.23456789</span><span class="p">)</span><span class="c"># + rand()*1.0/RAND_MAX)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0599</span>:   <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">min3</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt2.y = (__pyx_f_3rbf_8geometry_min3(__pyx_v_tri.a.y, __pyx_v_tri.b.y, __pyx_v_tri.c.y) - 2.34567891);
</pre><pre class="cython line score-0">&#xA0;<span class="">0600</span>:                   <span class="mf">2.34567891</span><span class="p">)</span><span class="c"># + rand()*1.0/RAND_MAX)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0601</span>:   <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">min3</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt2.z = (__pyx_f_3rbf_8geometry_min3(__pyx_v_tri.a.z, __pyx_v_tri.b.z, __pyx_v_tri.c.z) - 3.45678912);
</pre><pre class="cython line score-0">&#xA0;<span class="">0602</span>:                   <span class="mf">3.45678912</span><span class="p">)</span><span class="c"># + rand()*1.0/RAND_MAX)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>:   <span class="c"># find triangle normal vector components</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0605</span>:   <span class="n">n1</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n1 = (((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0606</span>:          <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0607</span>:   <span class="n">n2</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n2 = (-(((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0608</span>:          <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0609</span>:   <span class="n">n3</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n3 = (((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)) - ((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0610</span>:          <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0613</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n1) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n2)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n3));
</pre><pre class="cython line score-0">&#xA0;<span class="">0614</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n1</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0616</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n2</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n1) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n2)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n3));
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n3</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0619</span>:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0620</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0621</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>:   <span class="c"># coplanar segments will always return false</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>:   <span class="c"># There is a possibility that the segment touches</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>:   <span class="c"># one point on the triangle</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0625</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0626</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0628</span>:   <span class="c"># intersection point</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0629</span>:   <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt1.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0630</span>:                   <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0631</span>:   <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt1.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0632</span>:                   <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0633</span>:   <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dummy_pnt1.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0634</span>:                   <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0636</span>:   <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n3</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n1) &gt;= fabs(__pyx_v_n2)) &amp; (fabs(__pyx_v_n1) &gt;= fabs(__pyx_v_n3))) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0637</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.y;
    __pyx_v_dummy_seg1.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0638</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.z;
    __pyx_v_dummy_seg1.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0639</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.y;
    __pyx_v_dummy_seg1.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0640</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.z;
    __pyx_v_dummy_seg1.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0641</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0642</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_dummy_seg2.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0643</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_dummy_seg2.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0644</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_dummy_seg2.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0645</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_dummy_seg2.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0646</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0647</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_dummy_seg3.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0648</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_dummy_seg3.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0649</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_dummy_seg3.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0650</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_dummy_seg3.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0651</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0652</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_dummy_seg4.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0653</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_dummy_seg4.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0654</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_dummy_seg4.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0655</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_dummy_seg4.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0656</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0657</span>:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n3</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n2) &gt;= fabs(__pyx_v_n1)) &amp; (fabs(__pyx_v_n2) &gt;= fabs(__pyx_v_n3))) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0658</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.x;
    __pyx_v_dummy_seg1.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0659</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.z;
    __pyx_v_dummy_seg1.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0660</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.x;
    __pyx_v_dummy_seg1.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0661</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.z;
    __pyx_v_dummy_seg1.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0662</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0663</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_dummy_seg2.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0664</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_dummy_seg2.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0665</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_dummy_seg2.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0666</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_dummy_seg2.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0667</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0668</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_dummy_seg3.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0669</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_dummy_seg3.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0670</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_dummy_seg3.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0671</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_dummy_seg3.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0673</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_dummy_seg4.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0674</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_dummy_seg4.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0675</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_dummy_seg4.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0676</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_dummy_seg4.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0677</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0678</span>:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n2</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((fabs(__pyx_v_n3) &gt;= fabs(__pyx_v_n1)) &amp; (fabs(__pyx_v_n3) &gt;= fabs(__pyx_v_n2))) != 0);
  if (__pyx_t_1) {
/* … */
  }
  __pyx_L5:;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0679</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.x;
    __pyx_v_dummy_seg1.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0680</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt1</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt1.y;
    __pyx_v_dummy_seg1.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0681</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.x;
    __pyx_v_dummy_seg1.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0682</span>:     <span class="n">dummy_seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">dummy_pnt2</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_dummy_pnt2.y;
    __pyx_v_dummy_seg1.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0683</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0684</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_dummy_seg2.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0685</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_dummy_seg2.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0686</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_dummy_seg2.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0687</span>:     <span class="n">dummy_seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_dummy_seg2.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0689</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_dummy_seg3.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0690</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_dummy_seg3.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0691</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_dummy_seg3.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0692</span>:     <span class="n">dummy_seg3</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_dummy_seg3.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0693</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0694</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_dummy_seg4.a.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0695</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_dummy_seg4.a.y = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0696</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_dummy_seg4.b.x = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0697</span>:     <span class="n">dummy_seg4</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_dummy_seg4.b.y = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0698</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0700</span>:   <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">dummy_seg1</span><span class="p">,</span><span class="n">dummy_seg2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_dummy_seg1, __pyx_v_dummy_seg2) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0701</span>:     <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0702</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0704</span>:   <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">dummy_seg1</span><span class="p">,</span><span class="n">dummy_seg3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_dummy_seg1, __pyx_v_dummy_seg3) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0705</span>:     <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0706</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0708</span>:   <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">dummy_seg1</span><span class="p">,</span><span class="n">dummy_seg4</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_dummy_seg1, __pyx_v_dummy_seg4) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0709</span>:     <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0711</span>:   <span class="k">return</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span> <span class="o">==</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((__pyx_v_count % 2) == 1);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0712</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0716</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_count_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_count_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_count_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_count_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0717</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>:                                <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: <span class="sd">    returns an array of the number of intersections between each line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: <span class="sd">    segment, described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0729</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0730</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0731</span>:     <span class="n">segment3d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0733</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0734</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0735</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0736</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0737</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0738</span>:       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_7 = __pyx_v_N;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_9 = (__pyx_t_7 - 0) / 1;
              if (__pyx_t_9 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)
                      #endif /* _OPENMP */
                      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_9; __pyx_t_8++){
                          {
                              __pyx_v_i = 0 + 1 * __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0739</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_i;
                              __pyx_t_11 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0740</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_12 = __pyx_v_i;
                              __pyx_t_13 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0741</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_14 = __pyx_v_i;
                              __pyx_t_15 = 2;
                              (__pyx_v_seg_array[__pyx_v_i]).a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_14 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0742</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_16 = __pyx_v_i;
                              __pyx_t_17 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0743</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_18 = __pyx_v_i;
                              __pyx_t_19 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_18 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_19 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0744</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_20 = __pyx_v_i;
                              __pyx_t_21 = 2;
                              (__pyx_v_seg_array[__pyx_v_i]).b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_20 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_21 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0745</span>:         <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cross_count_3d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_22 = __pyx_v_i;
                              *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_22 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__cross_count_3d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0746</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0748</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0749</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0750</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0755</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_cross_count_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_3rbf_8geometry__cross_count_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0756</span>:                          <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>:                          <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0760</span>:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0761</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0763</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0764</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0765</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0766</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 0;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0767</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0768</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 1;
    __pyx_t_21 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_19 * __pyx_v_simplices.strides[0]) ) + __pyx_t_20 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_22 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_21 * __pyx_v_vertices.strides[0]) ) + __pyx_t_22 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0769</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 1;
    __pyx_t_25 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_23 * __pyx_v_simplices.strides[0]) ) + __pyx_t_24 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_26 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_25 * __pyx_v_vertices.strides[0]) ) + __pyx_t_26 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0770</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    __pyx_t_29 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_27 * __pyx_v_simplices.strides[0]) ) + __pyx_t_28 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_30 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_29 * __pyx_v_vertices.strides[0]) ) + __pyx_t_30 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0771</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_31 = __pyx_v_i;
    __pyx_t_32 = 2;
    __pyx_t_33 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_31 * __pyx_v_simplices.strides[0]) ) + __pyx_t_32 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_34 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_33 * __pyx_v_vertices.strides[0]) ) + __pyx_t_34 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0772</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_35 = __pyx_v_i;
    __pyx_t_36 = 2;
    __pyx_t_37 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_35 * __pyx_v_simplices.strides[0]) ) + __pyx_t_36 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_38 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_37 * __pyx_v_vertices.strides[0]) ) + __pyx_t_38 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0773</span>:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_39 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_39) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0774</span>:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0776</span>:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0781</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_which_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_which_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_which_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_which_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0782</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>:                                <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: <span class="sd">    returns an array identifying which simplex is intersected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: <span class="sd">    start_pnts and end_pnts. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0799</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0800</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0801</span>:     <span class="n">segment3d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0803</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0804</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0805</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0806</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0807</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0808</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0809</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0810</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0811</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0812</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0813</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0814</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cross_which_3d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_f_3rbf_8geometry__cross_which_3d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_t_22 = __pyx_v_i;
      *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_22 * __pyx_v_out.strides[0]) )) = __pyx_t_21;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0817</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_27, &amp;__pyx_t_28, &amp;__pyx_t_29);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_24, &amp;__pyx_t_25, &amp;__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_26);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_27);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_28);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_29);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_23 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_27);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_27, __pyx_t_28, __pyx_t_29);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_25);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_26);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_24, __pyx_t_25, __pyx_t_26);
      __pyx_t_24 = 0; __pyx_t_25 = 0; __pyx_t_26 = 0; __pyx_t_27 = 0; __pyx_t_28 = 0; __pyx_t_29 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_23;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0818</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0819</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_30 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_30, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_30, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0820</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0824</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_cross_which_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-9 '>static int __pyx_f_3rbf_8geometry__cross_which_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_which_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_43);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_44);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_45);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_46);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_which_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0825</span>:                          <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:                          <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0829</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_simplices.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0830</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0832</span>:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_N;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0833</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0834</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0835</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 0;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0836</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0837</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 1;
    __pyx_t_21 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_19 * __pyx_v_simplices.strides[0]) ) + __pyx_t_20 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_22 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_21 * __pyx_v_vertices.strides[0]) ) + __pyx_t_22 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0838</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 1;
    __pyx_t_25 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_23 * __pyx_v_simplices.strides[0]) ) + __pyx_t_24 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_26 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_25 * __pyx_v_vertices.strides[0]) ) + __pyx_t_26 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0839</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    __pyx_t_29 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_27 * __pyx_v_simplices.strides[0]) ) + __pyx_t_28 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_30 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_29 * __pyx_v_vertices.strides[0]) ) + __pyx_t_30 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0840</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_31 = __pyx_v_i;
    __pyx_t_32 = 2;
    __pyx_t_33 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_31 * __pyx_v_simplices.strides[0]) ) + __pyx_t_32 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_34 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_33 * __pyx_v_vertices.strides[0]) ) + __pyx_t_34 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0841</span>:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_35 = __pyx_v_i;
    __pyx_t_36 = 2;
    __pyx_t_37 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_35 * __pyx_v_simplices.strides[0]) ) + __pyx_t_36 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_38 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_37 * __pyx_v_vertices.strides[0]) ) + __pyx_t_38 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0842</span>:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_39 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_39) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0843</span>:       <span class="k">return</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_i;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0844</span>: </pre>
<pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0845</span>:   <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-15 '>  __pyx_t_45 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen_2, __pyx_t_46);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_46); __pyx_t_46 = 0;
  __pyx_t_46 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_45);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 0, __pyx_t_45);
  __pyx_t_45 = 0;
  __pyx_t_45 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_t_46, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_46); __pyx_t_46 = 0;
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_45, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_45); __pyx_t_45 = 0;
  <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 845; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">0846</span>:                    <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">))</span></pre>
<pre class='cython code score-41 '>  __pyx_t_40 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  __pyx_t_42 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.z);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  __pyx_t_43 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_43);
  __pyx_t_44 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_44);
  __pyx_t_45 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.z);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
  __pyx_t_46 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_41);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 1, __pyx_t_41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 2, __pyx_t_42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_43);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 3, __pyx_t_43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_44);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 4, __pyx_t_44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_45);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 5, __pyx_t_45);
  __pyx_t_40 = 0;
  __pyx_t_41 = 0;
  __pyx_t_42 = 0;
  __pyx_t_43 = 0;
  __pyx_t_44 = 0;
  __pyx_t_45 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0847</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0850</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_where_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_where_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_seg_array;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_where_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_where_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0851</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>:                                <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>:                                <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="sd">    returns the intersection points between the line segments,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: <span class="sd">    described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0867</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0868</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0869</span>:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0870</span>:     <span class="n">segment3d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0871</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0872</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0873</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0874</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0875</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0876</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0877</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0878</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0879</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0880</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0881</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0882</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0883</span>:       <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_where_3d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_f_3rbf_8geometry__cross_where_3d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_v_vec = __pyx_t_21;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0884</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.x;
      __pyx_t_23 = __pyx_v_i;
      __pyx_t_24 = 0;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_23 * __pyx_v_out.strides[0]) ) + __pyx_t_24 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0885</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.y;
      __pyx_t_25 = __pyx_v_i;
      __pyx_t_26 = 1;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) ) + __pyx_t_26 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0886</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.z;
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_28 = 2;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_27 * __pyx_v_out.strides[0]) ) + __pyx_t_28 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0887</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0889</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_30 = 0; __pyx_t_31 = 0; __pyx_t_32 = 0; __pyx_t_33 = 0; __pyx_t_34 = 0; __pyx_t_35 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_33, &amp;__pyx_t_34, &amp;__pyx_t_35);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_30, &amp;__pyx_t_31, &amp;__pyx_t_32) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_30, &amp;__pyx_t_31, &amp;__pyx_t_32);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_30);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_31);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_32);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_33);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_34);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_35);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_29 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_33);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_34);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_35);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_33, __pyx_t_34, __pyx_t_35);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_31);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_32);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_30, __pyx_t_31, __pyx_t_32);
      __pyx_t_30 = 0; __pyx_t_31 = 0; __pyx_t_32 = 0; __pyx_t_33 = 0; __pyx_t_34 = 0; __pyx_t_35 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_29;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0890</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0891</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_36 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_36);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_36, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0892</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0897</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_cross_where_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__cross_where_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_norm;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_where_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_where_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0898</span>:                               <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:                               <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>:     <span class="n">vector3d</span> <span class="n">norm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0907</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_cross_which_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__cross_which_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0908</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0909</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0910</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 0;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0911</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0912</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = __pyx_v_idx;
  __pyx_t_19 = 1;
  __pyx_t_20 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_18 * __pyx_v_simplices.strides[0]) ) + __pyx_t_19 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_21 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_20 * __pyx_v_vertices.strides[0]) ) + __pyx_t_21 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0913</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_22 = __pyx_v_idx;
  __pyx_t_23 = 1;
  __pyx_t_24 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_22 * __pyx_v_simplices.strides[0]) ) + __pyx_t_23 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_25 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_24 * __pyx_v_vertices.strides[0]) ) + __pyx_t_25 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0914</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_26 = __pyx_v_idx;
  __pyx_t_27 = 2;
  __pyx_t_28 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_26 * __pyx_v_simplices.strides[0]) ) + __pyx_t_27 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_29 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_28 * __pyx_v_vertices.strides[0]) ) + __pyx_t_29 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0915</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = __pyx_v_idx;
  __pyx_t_31 = 2;
  __pyx_t_32 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_30 * __pyx_v_simplices.strides[0]) ) + __pyx_t_31 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_33 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_32 * __pyx_v_vertices.strides[0]) ) + __pyx_t_33 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0916</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = __pyx_v_idx;
  __pyx_t_35 = 2;
  __pyx_t_36 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_34 * __pyx_v_simplices.strides[0]) ) + __pyx_t_35 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_37 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_36 * __pyx_v_vertices.strides[0]) ) + __pyx_t_37 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0917</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0918</span>:   <span class="n">norm</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_norm.x = (((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0919</span>:              <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0920</span>:   <span class="n">norm</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_norm.y = (-(((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0921</span>:              <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0922</span>:   <span class="n">norm</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_norm.z = (((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)) - ((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0923</span>:              <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0925</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_norm.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_norm.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_norm.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0926</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0928</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_norm.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_norm.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_norm.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0929</span>:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0930</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0931</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0932</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0933</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0934</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0935</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0937</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0942</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_normals_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_normals_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_seg_array;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_normals_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_36);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_normals_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0943</span>:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>:                                  <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: <span class="sd">    returns the normal vectors to the simplices intersected start_pnts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: <span class="sd">    and end_pnts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0960</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0961</span>:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0962</span>:     <span class="n">segment3d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0963</span>:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0965</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0966</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0967</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0968</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0969</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_N;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0970</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_9 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_10 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0971</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_11 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_12 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0972</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_13 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_14 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0973</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = 0;
      (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_15 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_16 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0974</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = 1;
      (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_17 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_18 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0975</span>:       <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = 2;
      (__pyx_v_seg_array[__pyx_v_i]).b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_19 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_20 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0976</span>:       <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_normals_3d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_f_3rbf_8geometry__cross_normals_3d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 976; __pyx_clineno = __LINE__; goto __pyx_L5_error;}</span>
      __pyx_v_vec = __pyx_t_21;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0977</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.x;
      __pyx_t_23 = __pyx_v_i;
      __pyx_t_24 = 0;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_23 * __pyx_v_out.strides[0]) ) + __pyx_t_24 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0978</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.y;
      __pyx_t_25 = __pyx_v_i;
      __pyx_t_26 = 1;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) ) + __pyx_t_26 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0979</span>:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_vec.z;
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_28 = 2;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_27 * __pyx_v_out.strides[0]) ) + __pyx_t_28 * __pyx_v_out.strides[1]) )) = __pyx_t_22;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0980</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0982</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    /*exception exit:*/{
      __pyx_L5_error:;
      __pyx_t_30 = 0; __pyx_t_31 = 0; __pyx_t_32 = 0; __pyx_t_33 = 0; __pyx_t_34 = 0; __pyx_t_35 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_33, &amp;__pyx_t_34, &amp;__pyx_t_35);
      if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_30, &amp;__pyx_t_31, &amp;__pyx_t_32) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_30, &amp;__pyx_t_31, &amp;__pyx_t_32);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_30);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_31);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_32);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_33);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_34);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_35);
      __pyx_t_7 = __pyx_lineno; __pyx_t_8 = __pyx_clineno; __pyx_t_29 = __pyx_filename;
      {
        free(__pyx_v_seg_array);
      }
      if (PY_MAJOR_VERSION &gt;= 3) {
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_33);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_34);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_35);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_33, __pyx_t_34, __pyx_t_35);
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_31);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_32);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_30, __pyx_t_31, __pyx_t_32);
      __pyx_t_30 = 0; __pyx_t_31 = 0; __pyx_t_32 = 0; __pyx_t_33 = 0; __pyx_t_34 = 0; __pyx_t_35 = 0;
      __pyx_lineno = __pyx_t_7; __pyx_clineno = __pyx_t_8; __pyx_filename = __pyx_t_29;
      goto __pyx_L1_error;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0983</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0984</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_36 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_36);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_36, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_36, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_36); __pyx_t_36 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 984; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0985</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0990</span>: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_cross_normals_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__cross_normals_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_n;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_normals_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_normals_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0991</span>:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1000</span>:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_cross_which_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_f_3rbf_8geometry__cross_which_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1000; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1001</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_idx;
  __pyx_t_3 = 0;
  __pyx_t_4 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_2 * __pyx_v_simplices.strides[0]) ) + __pyx_t_3 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_5 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_4 * __pyx_v_vertices.strides[0]) ) + __pyx_t_5 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1002</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_idx;
  __pyx_t_7 = 0;
  __pyx_t_8 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_6 * __pyx_v_simplices.strides[0]) ) + __pyx_t_7 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_9 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_8 * __pyx_v_vertices.strides[0]) ) + __pyx_t_9 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1003</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_idx;
  __pyx_t_11 = 0;
  __pyx_t_12 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_10 * __pyx_v_simplices.strides[0]) ) + __pyx_t_11 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_13 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_12 * __pyx_v_vertices.strides[0]) ) + __pyx_t_13 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1004</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __pyx_v_idx;
  __pyx_t_15 = 1;
  __pyx_t_16 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_14 * __pyx_v_simplices.strides[0]) ) + __pyx_t_15 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_17 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_16 * __pyx_v_vertices.strides[0]) ) + __pyx_t_17 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1005</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_18 = __pyx_v_idx;
  __pyx_t_19 = 1;
  __pyx_t_20 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_18 * __pyx_v_simplices.strides[0]) ) + __pyx_t_19 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_21 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_20 * __pyx_v_vertices.strides[0]) ) + __pyx_t_21 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1006</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_22 = __pyx_v_idx;
  __pyx_t_23 = 1;
  __pyx_t_24 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_22 * __pyx_v_simplices.strides[0]) ) + __pyx_t_23 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_25 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_24 * __pyx_v_vertices.strides[0]) ) + __pyx_t_25 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1007</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_26 = __pyx_v_idx;
  __pyx_t_27 = 2;
  __pyx_t_28 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_26 * __pyx_v_simplices.strides[0]) ) + __pyx_t_27 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_29 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_28 * __pyx_v_vertices.strides[0]) ) + __pyx_t_29 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1008</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_30 = __pyx_v_idx;
  __pyx_t_31 = 2;
  __pyx_t_32 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_30 * __pyx_v_simplices.strides[0]) ) + __pyx_t_31 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_33 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_32 * __pyx_v_vertices.strides[0]) ) + __pyx_t_33 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1009</span>:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_34 = __pyx_v_idx;
  __pyx_t_35 = 2;
  __pyx_t_36 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_34 * __pyx_v_simplices.strides[0]) ) + __pyx_t_35 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_37 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_36 * __pyx_v_vertices.strides[0]) ) + __pyx_t_37 * __pyx_v_vertices.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1010</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1011</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1012</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1013</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (-(((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1014</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1015</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)) - ((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1016</span>:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1018</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0 '>  __pyx_v_proj = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_out.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_out.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_out.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">1019</span>:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">out</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1021</span>:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_38 = ((__pyx_v_proj &lt;= 0.0) != 0);
  if (__pyx_t_38) {
/* … */
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1022</span>:     <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_out.x = (__pyx_v_out.x * -1.0);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1023</span>:     <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_out.y = (__pyx_v_out.y * -1.0);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1024</span>:     <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_out.z = (__pyx_v_out.z * -1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1025</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1026</span>:   <span class="n">n</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">out</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n = sqrt(((pow(__pyx_v_out.x, 2.0) + pow(__pyx_v_out.y, 2.0)) + pow(__pyx_v_out.z, 2.0)));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1027</span>:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.x = (__pyx_v_out.x / __pyx_v_n);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1028</span>:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.y = (__pyx_v_out.y / __pyx_v_n);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1029</span>:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">/=</span> <span class="n">n</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out.z = (__pyx_v_out.z / __pyx_v_n);
</pre><pre class="cython line score-0">&#xA0;<span class="">1030</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1031</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1034</span>: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">1036</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_3d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d *__pyx_v_seg_array;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1037</span>:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1039</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>: <span class="sd">    returns a boolean array identifying whether the points are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>: <span class="sd">    contained within the closed simplicial complex described by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: <span class="sd">    vertices and simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1049</span>:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">1050</span>:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1050; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1051</span>:     <span class="n">segment3d</span> <span class="o">*</span><span class="n">seg_array</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">segment3d</span> <span class="o">*&gt;</span><span class="n">malloc</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="n">segment3d</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_seg_array = ((struct __pyx_t_3rbf_8geometry_segment3d *)malloc((__pyx_v_N * (sizeof(struct __pyx_t_3rbf_8geometry_segment3d)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1052</span>:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1054</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">seg_array</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((!(__pyx_v_seg_array != 0)) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1055</span>:     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1056</span>: </pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1057</span>:   <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1058</span>:     <span class="n">vec</span> <span class="o">=</span> <span class="n">find_outside_3d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vec = __pyx_f_3rbf_8geometry_find_outside_3d(__pyx_v_vertices);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1059</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
  }
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1060</span>:       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_7 = __pyx_v_N;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_9 = (__pyx_t_7 - 0) / 1;
              if (__pyx_t_9 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_count) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)
                      #endif /* _OPENMP */
                      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_9; __pyx_t_8++){
                          {
                              __pyx_v_i = 0 + 1 * __pyx_t_8;
                              /* Initialize private variables to invalid values */
                              __pyx_v_count = ((int)0xbad0bad0);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1061</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_vec.x;
                              (__pyx_v_seg_array[__pyx_v_i]).a.x = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1062</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_vec.y;
                              (__pyx_v_seg_array[__pyx_v_i]).a.y = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1063</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_10 = __pyx_v_vec.z;
                              (__pyx_v_seg_array[__pyx_v_i]).a.z = __pyx_t_10;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1064</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_11 = __pyx_v_i;
                              __pyx_t_12 = 0;
                              (__pyx_v_seg_array[__pyx_v_i]).b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_11 * __pyx_v_pnt.strides[0]) ) + __pyx_t_12 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1065</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_13 = __pyx_v_i;
                              __pyx_t_14 = 1;
                              (__pyx_v_seg_array[__pyx_v_i]).b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_13 * __pyx_v_pnt.strides[0]) ) + __pyx_t_14 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1066</span>:         <span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_15 = __pyx_v_i;
                              __pyx_t_16 = 2;
                              (__pyx_v_seg_array[__pyx_v_i]).b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_15 * __pyx_v_pnt.strides[0]) ) + __pyx_t_16 * __pyx_v_pnt.strides[1]) )));
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1067</span>:         <span class="n">count</span> <span class="o">=</span> <span class="n">_cross_count_3d</span><span class="p">(</span><span class="n">seg_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                              __pyx_v_count = __pyx_f_3rbf_8geometry__cross_count_3d((__pyx_v_seg_array[__pyx_v_i]), __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1068</span>:         <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_17 = __pyx_v_i;
                              *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_17 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1069</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>:   <span class="k">finally</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">1071</span>:     <span class="n">free</span><span class="p">(</span><span class="n">seg_array</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*finally:*/ {
    /*normal exit:*/{
      free(__pyx_v_seg_array);
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1073</span>:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>: </pre>
<pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1076</span>: <span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="n">M</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_1normal(PyObject *__pyx_self, PyObject *__pyx_v_M); /*proto*/
static char __pyx_doc_3rbf_8geometry_normal[] = "\n  Description\n  -----------\n    returns the normal vector to the D-1 vectors in D dimensional\n    space\n                                     \n  Parameters\n  ----------                 \n    M: (D-1,D) array of vectors  \n                           \n  Note\n  ----\n    supports broadcasting\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_1normal = {"normal", (PyCFunction)__pyx_pw_3rbf_8geometry_1normal, METH_O, __pyx_doc_3rbf_8geometry_normal};
static PyObject *__pyx_pw_3rbf_8geometry_1normal(PyObject *__pyx_self, PyObject *__pyx_v_M) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("normal (wrapper)", 0);
  __pyx_r = __pyx_pf_3rbf_8geometry_normal(__pyx_self, ((PyObject *)__pyx_v_M));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_normal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_M) {
  PyObject *__pyx_v_N = NULL;
  PyObject *__pyx_v_Msubs = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("normal", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_N);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Msubs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_M, __pyx_n_s_N, __pyx_n_s_Msubs, __pyx_n_s_out, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_1normal, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_normal, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_normal, 1076, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>: <span class="sd">    returns the normal vector to the D-1 vectors in D dimensional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>: <span class="sd">    space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>: <span class="sd">                                     </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1084</span>: <span class="sd">  ----------                 </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>: <span class="sd">    M: (D-1,D) array of vectors  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>: <span class="sd">                           </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1088</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>: <span class="sd">    supports broadcasting</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1091</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1092</span>:   <span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_M, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-96" onclick='toggleDiv(this)'>+<span class="">1093</span>:   <span class="n">Msubs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span></pre>
<pre class='cython code score-96 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_N);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_N);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_N);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_delete);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_M);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_M);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_v_M);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_int_neg_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_3))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Msubs = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1094</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Msubs</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_det);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_Msubs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Msubs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Msubs);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_Msubs);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1094; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1095</span>:   <span class="n">out</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice_);
  __pyx_t_10 = __pyx_slice_;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_out, __pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_2, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_10, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1096</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_rollaxis);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_int_neg_1);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1096; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">1097</span>:   <span class="n">out</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mf">1</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span></pre>
<pre class='cython code score-45 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_out);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_neg_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_tuple__2);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_v_out, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_Ellipsis, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1097; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1098</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1099</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>: </pre>
<pre class="cython line score-84" onclick='toggleDiv(this)'>+<span class="">1101</span>: <span class="k">def</span> <span class="nf">complex_intersection</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-84 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_3complex_intersection(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_2complex_intersection[] = "\n  Description\n  -----------\n    returns the intersection points between the line segments,\n    described by start_points and end_points, and the simplicial\n    complex, described by vertices and simplices. This function works\n    for 1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    start_points: (N,D) array of vertices describing one end of each\n      line segment. N is the number of line segments\n\n    end_points: (N,D) array of vertices describing the other end of\n      each line segment. N is the number of line segments.\n\n    vertices: (M,D) array of vertices within the simplicial complex. M\n      is the number of vertices\n\n    simplices: (P,D) array of vertex indices for each simplex. P is\n      the number of simplices\n\n  Returns\n  -------\n    out: (N,D) array of intersection points    \n\n  Note\n  ----\n    This function fails when a intersection is not found for a line\n    segment\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_3complex_intersection = {"complex_intersection", (PyCFunction)__pyx_pw_3rbf_8geometry_3complex_intersection, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_2complex_intersection};
static PyObject *__pyx_pw_3rbf_8geometry_3complex_intersection(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_intersection (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_intersection", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_intersection", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_intersection", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex_intersection") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_intersection", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_intersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_2complex_intersection(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_2complex_intersection(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_intersection", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_intersection", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_crossed_bool, __pyx_n_s_crossed_idx, __pyx_n_s_out, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_3complex_intersection, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_complex_intersection, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__35 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_complex_intersection, 1101, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1102</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1103</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1104</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1105</span>: <span class="sd">    returns the intersection points between the line segments,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1106</span>: <span class="sd">    described by start_points and end_points, and the simplicial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1107</span>: <span class="sd">    complex, described by vertices and simplices. This function works</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>: <span class="sd">    for 1, 2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1110</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1111</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1112</span>: <span class="sd">    start_points: (N,D) array of vertices describing one end of each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1113</span>: <span class="sd">      line segment. N is the number of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>: <span class="sd">    end_points: (N,D) array of vertices describing the other end of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>: <span class="sd">      each line segment. N is the number of line segments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>: <span class="sd">    vertices: (M,D) array of vertices within the simplicial complex. M</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>: <span class="sd">      is the number of vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1121</span>: <span class="sd">    simplices: (P,D) array of vertex indices for each simplex. P is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1122</span>: <span class="sd">      the number of simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1123</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1124</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1125</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1126</span>: <span class="sd">    out: (N,D) array of intersection points    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1130</span>: <span class="sd">    This function fails when a intersection is not found for a line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1131</span>: <span class="sd">    segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1133</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1134</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_start_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_start_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1135</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_end_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_end_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1136</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_vertices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1137</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_simplices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1138</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1139</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1140</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1141</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1142</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1143</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21 '>  __pyx_slice__3 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__3);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__4);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__3, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1144</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-115" onclick='toggleDiv(this)'>+<span class="">1145</span>:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crossed_bool</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-115 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_crossed_bool)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_crossed_bool)) {
      __pyx_t_4 = __pyx_v_crossed_bool; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_crossed_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_7(__pyx_t_4);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_i);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_2))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_idx = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1146</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_v_out = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1148</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1148; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1149</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_where_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_where_2d(__pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1150</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1151</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1152</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_where_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_where_3d(__pyx_t_13, __pyx_t_12, __pyx_t_11, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1153</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">1154</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>: </pre>
<pre class="cython line score-85" onclick='toggleDiv(this)'>+<span class="">1157</span>: <span class="k">def</span> <span class="nf">complex_normal</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_5complex_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_4complex_normal[] = "\n  Description\n  -----------\n    returns the normal vectors to the simplexes intersected by the\n    line segments, described by start_points and end_points. This\n    function works for 1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    start_points: (N,D) array of vertices describing one end of each\n      line segment. N is the number of line segments\n\n    end_points: (N,D) array of vertices describing the other end of\n      each line segment. N is the number of line segments.\n\n    vertices: (M,D) array of vertices within the simplicial complex. M\n      is the number of vertices\n\n    simplices: (P,D) array of vertex indices for each simplex. P is\n      the number of simplices\n\n  Returns\n  -------\n    out: (N,D) array of normal vectors\n\n  Note\n  ----\n    This function fails when a intersection is not found for a line\n    segment\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_5complex_normal = {"complex_normal", (PyCFunction)__pyx_pw_3rbf_8geometry_5complex_normal, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_4complex_normal};
static PyObject *__pyx_pw_3rbf_8geometry_5complex_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_normal (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_normal", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_normal", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_normal", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex_normal") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_normal", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_4complex_normal(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_4complex_normal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_crossed_vert = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_normal", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__36 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_vert, __pyx_n_s_crossed_bool, __pyx_n_s_crossed_idx, __pyx_n_s_crossed_vert, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__36);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_5complex_normal, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_complex_normal, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__37 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_complex_normal, 1157, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1158</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>: <span class="sd">    returns the normal vectors to the simplexes intersected by the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>: <span class="sd">    line segments, described by start_points and end_points. This</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1163</span>: <span class="sd">    function works for 1, 2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>: <span class="sd">    start_points: (N,D) array of vertices describing one end of each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>: <span class="sd">      line segment. N is the number of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1170</span>: <span class="sd">    end_points: (N,D) array of vertices describing the other end of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1171</span>: <span class="sd">      each line segment. N is the number of line segments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1173</span>: <span class="sd">    vertices: (M,D) array of vertices within the simplicial complex. M</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1174</span>: <span class="sd">      is the number of vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1175</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1176</span>: <span class="sd">    simplices: (P,D) array of vertex indices for each simplex. P is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1177</span>: <span class="sd">      the number of simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>: <span class="sd">    out: (N,D) array of normal vectors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1182</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1183</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>: <span class="sd">    This function fails when a intersection is not found for a line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: <span class="sd">    segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1188</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1189</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_start_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_start_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1190</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_end_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_end_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1191</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_vertices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1192</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_simplices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1193</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1194</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1195</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1195; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1196</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1197</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1198</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_out = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1199</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21 '>  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
/* … */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__6);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vert = __pyx_t_4;
    __pyx_t_4 = 0;
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__5, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1199; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1200</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_crossed_bool = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-115" onclick='toggleDiv(this)'>+<span class="">1201</span>:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crossed_bool</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-115 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_crossed_bool)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_crossed_bool)) {
      __pyx_t_2 = __pyx_v_crossed_bool; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_crossed_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_7(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_i);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_idx = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1202</span>:     <span class="n">crossed_vert</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_crossed_vert = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">1203</span>:     <span class="n">out</span><span class="p">[</span><span class="n">crossed_vert</span> <span class="o">&lt;</span> <span class="n">start_points</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_crossed_vert, __pyx_v_start_points, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_1, __pyx_float_neg_1_0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1205</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1206</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_normals_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_normals_2d(__pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1208</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1209</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_normals_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_normals_3d(__pyx_t_13, __pyx_t_12, __pyx_t_11, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1210</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">1211</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>: </pre>
<pre class="cython line score-95" onclick='toggleDiv(this)'>+<span class="">1214</span>: <span class="k">def</span> <span class="nf">complex_group</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">,</span><span class="n">group</span><span class="p">):</span></pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_7complex_group(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_6complex_group[] = "\n  Description\n  -----------\n    returns the group number of the simplex intersected by the line\n    segments, described by start_points and end_points. This function\n    works for 1, 2, and 3 spatial dimensions. \n\n  Parameters\n  ----------\n    start_points: (N,D) array of vertices describing one end of each\n      line segment. N is the number of line segments\n\n    end_points: (N,D) array of vertices describing the other end of\n      each line segment. N is the number of line segments.\n\n    vertices: (M,D) array of vertices within the simplicial complex. M\n      is the number of vertices\n\n    simplices: (P,D) array of vertex indices for each simplex. P is\n      the number of simplices\n    \n    group: (P,) array of integer group IDs for each simplex. \n\n  Returns\n  -------\n    out: (N,) array of group IDs\n\n  Note\n  ----\n    This function fails when a intersection is not found for a line\n    segment\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_7complex_group = {"complex_group", (PyCFunction)__pyx_pw_3rbf_8geometry_7complex_group, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_6complex_group};
static PyObject *__pyx_pw_3rbf_8geometry_7complex_group(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_v_group = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_group (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,&amp;__pyx_n_s_group,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_group", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_group", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_group", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_group)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_group", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex_group") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
    __pyx_v_group = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_group", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_group", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_6complex_group(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices, __pyx_v_group);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_6complex_group(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices, PyObject *__pyx_v_group) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_smp_ids = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_group", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_group);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_group", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp_ids);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_group);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_group, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_vert, __pyx_n_s_crossed_bool, __pyx_n_s_smp_ids, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_7complex_group, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_complex_group, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__39 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_complex_group, 1214, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1215</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>: <span class="sd">    returns the group number of the simplex intersected by the line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>: <span class="sd">    segments, described by start_points and end_points. This function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: <span class="sd">    works for 1, 2, and 3 spatial dimensions. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>: <span class="sd">    start_points: (N,D) array of vertices describing one end of each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>: <span class="sd">      line segment. N is the number of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>: <span class="sd">    end_points: (N,D) array of vertices describing the other end of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: <span class="sd">      each line segment. N is the number of line segments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>: <span class="sd">    vertices: (M,D) array of vertices within the simplicial complex. M</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>: <span class="sd">      is the number of vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>: <span class="sd">    simplices: (P,D) array of vertex indices for each simplex. P is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: <span class="sd">      the number of simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: <span class="sd">    group: (P,) array of integer group IDs for each simplex. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">    out: (N,) array of group IDs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">    This function fails when a intersection is not found for a line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">    segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1248</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1249</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1250</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1251</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1251; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1252</span>:   <span class="n">group</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">group</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_group);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_group);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_group);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_group, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1253</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1254</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1255</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1256</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1257</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1258</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_out = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1259</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21 '>  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
/* … */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__8);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__7, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1260</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-115" onclick='toggleDiv(this)'>+<span class="">1261</span>:     <span class="n">smp_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mf">0</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">crossed_bool</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-115 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_crossed_bool)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_crossed_bool)) {
      __pyx_t_2 = __pyx_v_crossed_bool; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_crossed_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_7(__pyx_t_2);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_i);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_9 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_4))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_smp_ids = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1262</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1263</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1264</span>:     <span class="n">smp_ids</span> <span class="o">=</span> <span class="n">cross_which_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_which_2d(__pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_smp_ids, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1265</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1266</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1267</span>:     <span class="n">smp_ids</span><span class="o">=</span> <span class="n">cross_which_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_which_3d(__pyx_t_13, __pyx_t_12, __pyx_t_11, __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_smp_ids, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1268</span>: </pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1269</span>:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="n">smp_ids</span><span class="p">],</span><span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_v_smp_ids)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("smp_ids"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_group, __pyx_v_smp_ids);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1270</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>: </pre>
<pre class="cython line score-79" onclick='toggleDiv(this)'>+<span class="">1273</span>: <span class="k">def</span> <span class="nf">complex_cross_count</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-79 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_9complex_cross_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_8complex_cross_count[] = "\n  Description\n  -----------\n    returns the number of simplexes crossed by the line segments\n    described by start_points and end_points. This function works for\n    1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    start_points: (N,D) array of vertices describing one end of each\n      line segment. N is the number of line segments\n\n    end_points: (N,D) array of vertices describing the other end of\n      each line segment. N is the number of line segments.\n\n    vertices: (M,D) array of vertices within the simplicial complex. M\n      is the number of vertices\n\n    simplices: (P,D) array of vertex indices for each simplex. P is\n      the number of simplices\n\n  Returns\n  -------\n    out: (N,) array of intersection counts\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_9complex_cross_count = {"complex_cross_count", (PyCFunction)__pyx_pw_3rbf_8geometry_9complex_cross_count, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_8complex_cross_count};
static PyObject *__pyx_pw_3rbf_8geometry_9complex_cross_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_cross_count (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_cross_count", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_cross_count", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_cross_count", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex_cross_count") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_cross_count", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_cross_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_8complex_cross_count(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_8complex_cross_count(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_cross_count", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_cross_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__40 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_crossed_bool, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__40);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_9complex_cross_count, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_complex_cross_count, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__41 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_complex_cross_count, 1273, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1275</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1276</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1277</span>: <span class="sd">    returns the number of simplexes crossed by the line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>: <span class="sd">    described by start_points and end_points. This function works for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>: <span class="sd">    1, 2, and 3 spatial dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>: <span class="sd">    start_points: (N,D) array of vertices describing one end of each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>: <span class="sd">      line segment. N is the number of line segments</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>: <span class="sd">    end_points: (N,D) array of vertices describing the other end of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>: <span class="sd">      each line segment. N is the number of line segments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="sd">    vertices: (M,D) array of vertices within the simplicial complex. M</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: <span class="sd">      is the number of vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">    simplices: (P,D) array of vertex indices for each simplex. P is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>: <span class="sd">      the number of simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>: <span class="sd">    out: (N,) array of intersection counts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1300</span>:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1301</span>:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1302</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1303</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1304</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1305</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1305; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1306</span>:   <span class="k">assert</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1307</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1308</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1309</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21 '>  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
/* … */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__10);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__9, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1310</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">1311</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_crossed_bool);
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1312</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1313</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1313; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1314</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_count_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_count_2d(__pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1314; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1315</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1316</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1317</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_count_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_count_3d(__pyx_t_8, __pyx_t_7, __pyx_t_6, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1318</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">1319</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>: </pre>
<pre class="cython line score-72" onclick='toggleDiv(this)'>+<span class="">1322</span>: <span class="k">def</span> <span class="nf">complex_contains</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_11complex_contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_10complex_contains[] = "\n  Description\n  -----------\n    returns a boolean array identifying whether the points are\n    contained within a closed simplicial complex described by vertices\n    and simplices.  This function works for 1, 2, and 3 spatial\n    dimensions.\n\n  Parameters\n  ----------\n    points: (N,D) array of points\n\n    vertices: (M,D) array of vertices within the simplicial complex. M\n      is the number of vertices\n\n    simplices: (P,D) array of vertex indices for each simplex. P is\n      the number of simplices\n\n  Returns\n  -------\n    out: (N,) boolean array identifying whether each point is in the\n      simplicial complex\n\n  Note\n  ----\n    This function does not ensure that the simplicial complex is\n    closed.  If it is not then bogus results will be returned.  The\n    closedness can be checked using the is_valid function.  \n\n    \n    This function determines whether a point is contained within the\n    simplicial complex by finding the number of intersections between\n    each point and an arbitrary outside point.  It is possible,\n    although rare, that this function will fail if the line segment\n    intersects a simplex at an edge.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_11complex_contains = {"complex_contains", (PyCFunction)__pyx_pw_3rbf_8geometry_11complex_contains, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_10complex_contains};
static PyObject *__pyx_pw_3rbf_8geometry_11complex_contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_contains (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_contains", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_contains", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "complex_contains") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_points = values[0];
    __pyx_v_vertices = values[1];
    __pyx_v_simplices = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("complex_contains", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_10complex_contains(__pyx_self, __pyx_v_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_10complex_contains(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_end_points = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_crossed_count = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("complex_contains", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.complex_contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__42 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_end_points, __pyx_n_s_crossed_bool, __pyx_n_s_crossed_count, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__42);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_11complex_contains, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_complex_contains, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__43 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_complex_contains, 1322, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1323</span>:   <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1324</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1325</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1326</span>: <span class="sd">    returns a boolean array identifying whether the points are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1327</span>: <span class="sd">    contained within a closed simplicial complex described by vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1328</span>: <span class="sd">    and simplices.  This function works for 1, 2, and 3 spatial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1329</span>: <span class="sd">    dimensions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1331</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1332</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1333</span>: <span class="sd">    points: (N,D) array of points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1335</span>: <span class="sd">    vertices: (M,D) array of vertices within the simplicial complex. M</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1336</span>: <span class="sd">      is the number of vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1338</span>: <span class="sd">    simplices: (P,D) array of vertex indices for each simplex. P is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1339</span>: <span class="sd">      the number of simplices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1340</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1341</span>: <span class="sd">  Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1342</span>: <span class="sd">  -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1343</span>: <span class="sd">    out: (N,) boolean array identifying whether each point is in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1344</span>: <span class="sd">      simplicial complex</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1345</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1346</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1347</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1348</span>: <span class="sd">    This function does not ensure that the simplicial complex is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span class="sd">    closed.  If it is not then bogus results will be returned.  The</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>: <span class="sd">    closedness can be checked using the is_valid function.  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1351</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1352</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1353</span>: <span class="sd">    This function determines whether a point is contained within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1354</span>: <span class="sd">    simplicial complex by finding the number of intersections between</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1355</span>: <span class="sd">    each point and an arbitrary outside point.  It is possible,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1356</span>: <span class="sd">    although rare, that this function will fail if the line segment</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1357</span>: <span class="sd">    intersects a simplex at an edge.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1360</span>:   <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1361</span>:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vertices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1362</span>:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_simplices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1363</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1363; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1364</span>:   <span class="k">assert</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5)) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1364; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1365</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1366</span>:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21 '>  __pyx_slice__11 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
/* … */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__12);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vert = __pyx_t_3;
    __pyx_t_3 = 0;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__11, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-97" onclick='toggleDiv(this)'>+<span class="">1367</span>:     <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">points</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-97 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_points);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_vertices);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFloat_SubtractObjC</span>(__pyx_t_2, __pyx_float_1_0, 1.0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1367; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_end_points = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1368</span>:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">1369</span>:     <span class="n">crossed_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_crossed_bool);
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1369; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_crossed_count = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1370</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">crossed_count</span><span class="o">%</span><span class="mf">2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_RemainderObjC</span>(__pyx_v_crossed_count, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1371</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1372</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1372; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1373</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_2d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_2d(__pyx_t_8, __pyx_t_9, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1373; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1374</span>: </pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1375</span>:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_dim, __pyx_int_3, 3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1376</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_3d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_3d(__pyx_t_9, __pyx_t_8, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1376; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1377</span>: </pre>
<pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">1378</span>:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1378; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>: </pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1382</span>: <span class="k">def</span> <span class="nf">contains_N_duplicates</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_13contains_N_duplicates(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_12contains_N_duplicates[] = "            \n  returns True if every element in iterable is repeated N times\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_13contains_N_duplicates = {"contains_N_duplicates", (PyCFunction)__pyx_pw_3rbf_8geometry_13contains_N_duplicates, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_12contains_N_duplicates};
static PyObject *__pyx_pw_3rbf_8geometry_13contains_N_duplicates(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_iterable = 0;
  PyObject *__pyx_v_N = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_N_duplicates (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_iterable,&amp;__pyx_n_s_N,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_iterable)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_N);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contains_N_duplicates") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_iterable = values[0];
    __pyx_v_N = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains_N_duplicates", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_N_duplicates", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_12contains_N_duplicates(__pyx_self, __pyx_v_iterable, __pyx_v_N);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_12contains_N_duplicates(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_iterable, PyObject *__pyx_v_N) {
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_count = NULL;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_N_duplicates", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_N_duplicates", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__44 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_iterable, __pyx_n_s_N, __pyx_n_s_s, __pyx_n_s_count, __pyx_n_s_t);<span class='error_goto'> if (unlikely(!__pyx_tuple__44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__44);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_13contains_N_duplicates, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_contains_N_duplicates, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__45 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_contains_N_duplicates, 1382, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1383</span>:   <span class="sd">&#39;&#39;&#39;            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="sd">  returns True if every element in iterable is repeated N times</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">1386</span>:   <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span></pre>
<pre class='cython code score-46 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_iterable)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_iterable)) {
    __pyx_t_1 = __pyx_v_iterable; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_s, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1387</span>:     <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_count, __pyx_int_0);
</pre><pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">1388</span>:     <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">iterable</span><span class="p">:</span></pre>
<pre class='cython code score-46 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_iterable)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_iterable)) {
      __pyx_t_4 = __pyx_v_iterable; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          #endif
        } else {
          if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          #endif
        }
      } else {
        __pyx_t_7 = __pyx_t_6(__pyx_t_4);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_7);
      __pyx_t_7 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1389</span>:       <span class="c"># s == t can either return a boolean, or a boolean array in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>:       <span class="c"># event of s and t being numpy arrays.  np.all returns the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>:       <span class="c"># appropriate value in either case</span></pre>
<pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">1392</span>:       <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">t</span><span class="p">):</span></pre>
<pre class='cython code score-37 '>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_all);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_s, __pyx_v_t, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_10 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_10) {
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      } else {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10); __pyx_t_10 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_12) {
/* … */
      }
</pre><pre class="cython line score-3" onclick='toggleDiv(this)'>+<span class="">1393</span>:         <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_count, __pyx_int_1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_count, __pyx_t_7);
        __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1394</span>: </pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">1395</span>:     <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="n">N</span><span class="p">:</span></pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_count, __pyx_v_N, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-3" onclick='toggleDiv(this)'>+<span class="">1396</span>:       <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-3 '>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1397</span>: </pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1398</span>:   <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  __pyx_r = Py_True;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>: </pre>
<pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">1401</span>: <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_15is_valid(PyObject *__pyx_self, PyObject *__pyx_v_smp); /*proto*/
static char __pyx_doc_3rbf_8geometry_14is_valid[] = "             \n  Description\n  -----------\n    Returns True if the following conditions are met:\n\n      every simplex is unique\n\n      every simplex contains unique vertices\n\n      (for 2D and 3D) every simplex shares an edge with exactly one \n      other simplex. (for 1D) exactly 2 simplexes are given                     \n\n  Parameters\n  ----------\n    smp: simplices defining the domain\n\n  Note\n  ----\n    This function can take a while for a large (&gt;1000) number of \n    simplexes \n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_15is_valid = {"is_valid", (PyCFunction)__pyx_pw_3rbf_8geometry_15is_valid, METH_O, __pyx_doc_3rbf_8geometry_14is_valid};
static PyObject *__pyx_pw_3rbf_8geometry_15is_valid(PyObject *__pyx_self, PyObject *__pyx_v_smp) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_valid (wrapper)", 0);
  __pyx_r = __pyx_pf_3rbf_8geometry_14is_valid(__pyx_self, ((PyObject *)__pyx_v_smp));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_14is_valid(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_sub_smp = NULL;
  PyObject *__pyx_v_s = NULL;
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_v_c_list = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_valid", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.is_valid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sub_smp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__46 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_sub_smp, __pyx_n_s_s, __pyx_n_s_c, __pyx_n_s_c_list, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__46);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_15is_valid, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_valid, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__47 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_is_valid, 1401, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__47)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1401; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1402</span>:   <span class="sd">&#39;&#39;&#39;             </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>: <span class="sd">  Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: <span class="sd">  -----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>: <span class="sd">    Returns True if the following conditions are met:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>: <span class="sd">      every simplex is unique</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="sd">      every simplex contains unique vertices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">      (for 2D and 3D) every simplex shares an edge with exactly one </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">      other simplex. (for 1D) exactly 2 simplexes are given                     </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">  Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>: <span class="sd">  ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">    smp: simplices defining the domain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">  Note</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>: <span class="sd">  ----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span class="sd">    This function can take a while for a large (&gt;1000) number of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>: <span class="sd">    simplexes </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1424</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_smp);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-113" onclick='toggleDiv(this)'>+<span class="">1425</span>:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">smp</span><span class="p">])</span></pre>
<pre class='cython code score-113 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_smp)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_smp)) {
    __pyx_t_2 = __pyx_v_smp; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_i);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_7))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1426</span>:   <span class="n">dim</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_smp, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1427</span>:   <span class="n">sub_smp</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_sub_smp = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1428</span>:   <span class="c"># check for repeated simplexes </span></pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1429</span>:   <span class="k">if</span> <span class="ow">not</span> <span class="n">contains_N_duplicates</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_contains_N_duplicates);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_7) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_5, __pyx_v_smp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_5, __pyx_int_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_11 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_12 = ((!__pyx_t_11) != 0);
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1430</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1431</span>: </pre>
<pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">1432</span>:   <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">smp</span><span class="p">:</span></pre>
<pre class='cython code score-46 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_smp)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_smp)) {
    __pyx_t_4 = __pyx_v_smp; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_s, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1433</span>:     <span class="c"># check for repeated vertices in a simplex</span></pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1434</span>:     <span class="k">if</span> <span class="ow">not</span> <span class="n">contains_N_duplicates</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-29 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_contains_N_duplicates);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_13, __pyx_v_s);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_13, __pyx_int_1);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = ((!__pyx_t_12) != 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-3" onclick='toggleDiv(this)'>+<span class="">1435</span>:       <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-3 '>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1436</span>: </pre>
<pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">1437</span>:     <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">dim</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-74 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_dim, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_13, __pyx_v_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_13, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_13 = 0;
      __pyx_t_14 = NULL;
    } else {
      __pyx_t_13 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_14)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_13 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_13 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_13++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_13); __pyx_t_13++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_14(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_c, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">1438</span>:       <span class="n">c_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>      __pyx_t_1 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_c);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_c_list, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1439</span>:       <span class="n">c_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>      __pyx_t_15 = <span class='py_c_api'>PyList_Sort</span>(__pyx_v_c_list);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1440</span>:       <span class="n">sub_smp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c_list</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_sub_smp, __pyx_v_c_list);<span class='error_goto'> if (unlikely(__pyx_t_15 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1441</span>: </pre>
<pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">1442</span>:   <span class="k">return</span> <span class="n">contains_N_duplicates</span><span class="p">(</span><span class="n">sub_smp</span><span class="p">,</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_contains_N_duplicates);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sub_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sub_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_v_sub_smp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_int_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1442; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1444</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1445</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1446</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1447</span>: </pre>
</div></body></html>
