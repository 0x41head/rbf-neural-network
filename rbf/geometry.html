<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: geometry.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="geometry.c">geometry.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+0001: <span class="c"># distutils: extra_compile_args = -fopenmp</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0002: <span class="c"># distutils: extra_link_args = -fopenmp</span></pre>
<pre class='cython line score-0'>&#xA0;0003: <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0004: <span class="sd">Defines functions for basic computational geometry in 1, 2, and 3 </span></pre>
<pre class='cython line score-0'>&#xA0;0005: <span class="sd">dimensions. This modules requires all volumes, surfaces and segments </span></pre>
<pre class='cython line score-0'>&#xA0;0006: <span class="sd">to be described as simplicial complexes, that is, as a collection of </span></pre>
<pre class='cython line score-0'>&#xA0;0007: <span class="sd">simplexes defined by their vertices.  Most end user functions in this </span></pre>
<pre class='cython line score-0'>&#xA0;0008: <span class="sd">module have a vertices and simplices argument, the former is a (N,D) </span></pre>
<pre class='cython line score-0'>&#xA0;0009: <span class="sd">collection of all D dimensional vertices in the simplicial complex and </span></pre>
<pre class='cython line score-0'>&#xA0;0010: <span class="sd">the latter is an (M,D) array of vertex indices making up each simplex. </span></pre>
<pre class='cython line score-0'>&#xA0;0011: <span class="sd">For example the unit square in two dimensions can be described as </span></pre>
<pre class='cython line score-0'>&#xA0;0012: <span class="sd">collection of line segments:</span></pre>
<pre class='cython line score-0'>&#xA0;0013: </pre>
<pre class='cython line score-0'>&#xA0;0014: <span class="sd">&gt;&gt;&gt; vertices = [[0.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0015: <span class="sd">                [1.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0016: <span class="sd">                [1.0,1.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0017: <span class="sd">                [0.0,1.0]]</span></pre>
<pre class='cython line score-0'>&#xA0;0018: <span class="sd">&gt;&gt;&gt; simplices = [[0,1],</span></pre>
<pre class='cython line score-0'>&#xA0;0019: <span class="sd">                 [1,2],</span></pre>
<pre class='cython line score-0'>&#xA0;0020: <span class="sd">                 [2,3],</span></pre>
<pre class='cython line score-0'>&#xA0;0021: <span class="sd">                 [3,0]]</span></pre>
<pre class='cython line score-0'>&#xA0;0022: </pre>
<pre class='cython line score-0'>&#xA0;0023: <span class="sd">A three dimensional cube can similarly be described as a collection</span></pre>
<pre class='cython line score-0'>&#xA0;0024: <span class="sd">of triangles:</span></pre>
<pre class='cython line score-0'>&#xA0;0025: </pre>
<pre class='cython line score-0'>&#xA0;0026: <span class="sd">&gt;&gt;&gt; vertices = [[0.0,0.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0027: <span class="sd">                [0.0,0.0,1.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0028: <span class="sd">                [0.0,1.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0029: <span class="sd">                [0.0,1.0,1.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0030: <span class="sd">                [1.0,0.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0031: <span class="sd">                [1.0,0.0,1.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0032: <span class="sd">                [1.0,1.0,0.0],</span></pre>
<pre class='cython line score-0'>&#xA0;0033: <span class="sd">                [1.0,1.0,1.0]]</span></pre>
<pre class='cython line score-0'>&#xA0;0034: <span class="sd">&gt;&gt;&gt; simplices = [[0,1,4],</span></pre>
<pre class='cython line score-0'>&#xA0;0035: <span class="sd">                 [1,5,4],</span></pre>
<pre class='cython line score-0'>&#xA0;0036: <span class="sd">                 [1,7,5],</span></pre>
<pre class='cython line score-0'>&#xA0;0037: <span class="sd">                 [1,3,7],</span></pre>
<pre class='cython line score-0'>&#xA0;0038: <span class="sd">                 [0,1,3],</span></pre>
<pre class='cython line score-0'>&#xA0;0039: <span class="sd">                 [0,2,3],</span></pre>
<pre class='cython line score-0'>&#xA0;0040: <span class="sd">                 [0,2,6],</span></pre>
<pre class='cython line score-0'>&#xA0;0041: <span class="sd">                 [0,4,6],</span></pre>
<pre class='cython line score-0'>&#xA0;0042: <span class="sd">                 [4,5,7],</span></pre>
<pre class='cython line score-0'>&#xA0;0043: <span class="sd">                 [4,6,7],</span></pre>
<pre class='cython line score-0'>&#xA0;0044: <span class="sd">                 [2,3,7],</span></pre>
<pre class='cython line score-0'>&#xA0;0045: <span class="sd">                 [2,6,7]]</span></pre>
<pre class='cython line score-0'>&#xA0;0046: </pre>
<pre class='cython line score-0'>&#xA0;0047: <span class="sd">Although the notation is clumsy, a 1D domains can be described as a </span></pre>
<pre class='cython line score-0'>&#xA0;0048: <span class="sd">collection of vertices in a manner that is consistent with the above </span></pre>
<pre class='cython line score-0'>&#xA0;0049: <span class="sd">two examples:</span></pre>
<pre class='cython line score-0'>&#xA0;0050: <span class="sd">   </span></pre>
<pre class='cython line score-0'>&#xA0;0051: <span class="sd">&gt;&gt;&gt; vertices = [[0.0],[1.0]]</span></pre>
<pre class='cython line score-0'>&#xA0;0052: <span class="sd">&gt;&gt;&gt; simplices = [[0],[1]]</span></pre>
<pre class='cython line score-0'>&#xA0;0053: </pre>
<pre class='cython line score-0'>&#xA0;0054: <span class="sd">This module is primarily use to find whether and where line segments </span></pre>
<pre class='cython line score-0'>&#xA0;0055: <span class="sd">intersect a simplicial complex and whether points are contained within </span></pre>
<pre class='cython line score-0'>&#xA0;0056: <span class="sd">a closed simplicial complex.  For example, one can determine whether a </span></pre>
<pre class='cython line score-0'>&#xA0;0057: <span class="sd">collection of points, saved as *points*, are contained within a </span></pre>
<pre class='cython line score-0'>&#xA0;0058: <span class="sd">simplicial complex, defined by *vertices* and *simplices* with the </span></pre>
<pre class='cython line score-0'>&#xA0;0059: <span class="sd">command</span></pre>
<pre class='cython line score-0'>&#xA0;0060: </pre>
<pre class='cython line score-0'>&#xA0;0061: <span class="sd">&gt;&gt;&gt; contains(points,vertices,simplices)</span></pre>
<pre class='cython line score-0'>&#xA0;0062: </pre>
<pre class='cython line score-0'>&#xA0;0063: <span class="sd">which returns a boolean array.</span></pre>
<pre class='cython line score-0'>&#xA0;0064: </pre>
<pre class='cython line score-0'>&#xA0;0065: <span class="sd">One can find the number of times a collection of line segments, </span></pre>
<pre class='cython line score-0'>&#xA0;0066: <span class="sd">defined by *start_points* and *end_points*, intersect a simplicial </span></pre>
<pre class='cython line score-0'>&#xA0;0067: <span class="sd">complex with the command</span></pre>
<pre class='cython line score-0'>&#xA0;0068: </pre>
<pre class='cython line score-0'>&#xA0;0069: <span class="sd">&gt;&gt; intersection_count(start_points,end_points,vertices,simplices)</span></pre>
<pre class='cython line score-0'>&#xA0;0070: </pre>
<pre class='cython line score-0'>&#xA0;0071: <span class="sd">which returns an array of the number of simplexes intersections for</span></pre>
<pre class='cython line score-0'>&#xA0;0072: <span class="sd">each segment. If it is known that a collection of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;0073: <span class="sd">intersect a simplicial complex then the intersection point can be</span></pre>
<pre class='cython line score-0'>&#xA0;0074: <span class="sd">found with the command</span></pre>
<pre class='cython line score-0'>&#xA0;0075: </pre>
<pre class='cython line score-0'>&#xA0;0076: <span class="sd">&gt;&gt; intersection_point(start_points,end_points,vertices,simplices)</span></pre>
<pre class='cython line score-0'>&#xA0;0077: <span class="sd"> </span></pre>
<pre class='cython line score-0'>&#xA0;0078: <span class="sd">This returns an (N,D) array of intersection points where N is the </span></pre>
<pre class='cython line score-0'>&#xA0;0079: <span class="sd">number of line segments.  If a line segment does not intersect the </span></pre>
<pre class='cython line score-0'>&#xA0;0080: <span class="sd">simplicial complex then the above command returns a ValueError. If </span></pre>
<pre class='cython line score-0'>&#xA0;0081: <span class="sd">there are multiple intersections for a single segment then only the </span></pre>
<pre class='cython line score-0'>&#xA0;0082: <span class="sd">first detected intersection will be returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0083: </pre>
<pre class='cython line score-0'>&#xA0;0084: <span class="sd">Note</span></pre>
<pre class='cython line score-0'>&#xA0;0085: <span class="sd">----</span></pre>
<pre class='cython line score-0'>&#xA0;0086: <span class="sd">  There are numerous other packages which can perform the same tasks </span></pre>
<pre class='cython line score-0'>&#xA0;0087: <span class="sd">  as this module.  For example geos (http://trac.osgeo.org/geos/) and </span></pre>
<pre class='cython line score-0'>&#xA0;0088: <span class="sd">  gts (http://gts.sourceforge.net/).  However, the python bindings for </span></pre>
<pre class='cython line score-0'>&#xA0;0089: <span class="sd">  these packages are too slow for RBF purposes.</span></pre>
<pre class='cython line score-0'>&#xA0;0090: </pre>
<pre class='cython line score-0'>&#xA0;0091: <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+0092: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 92; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0093: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;0094: <span class="k">from</span> <span class="nn">cython</span> <span class="k">cimport</span> <span class="n">boundscheck</span><span class="p">,</span><span class="n">wraparound</span><span class="p">,</span><span class="n">cdivision</span></pre>
<pre class='cython line score-0'>&#xA0;0095: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">import</span> <span class="n">prange</span></pre>
<pre class='cython line score-0'>&#xA0;0096: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">rand</span></pre>
<pre class='cython line score-0'>&#xA0;0097: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span><span class="n">free</span></pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+0098: <span class="k">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_combinations);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_combinations);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_combinations);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_combinations, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+0099: <span class="k">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">factorial</span></pre>
<pre class='cython code score-19'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_factorial);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_factorial);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_factorial);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_special, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_factorial, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0100: </pre>
<pre class='cython line score-0'>&#xA0;0101: <span class="c"># NOTE: fabs is not the same as abs in C!!! </span></pre>
<pre class='cython line score-0'>&#xA0;0102: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0103:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">fabs</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0104: </pre>
<pre class='cython line score-0'>&#xA0;0105: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;math.h&quot;</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0106:   <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">sqrt</span><span class="p">(</span><span class="nb">float</span> <span class="n">x</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0107: </pre>
<pre class='cython line score-0'>&#xA0;0108: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;limits.h&quot;</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0109:     <span class="nb">int</span> <span class="n">RAND_MAX</span></pre>
<pre class='cython line score-0'>&#xA0;0110: </pre>
<pre class='cython line score-0'>&#xA0;0111: <span class="c">## geometric data types</span></pre>
<pre class='cython line score-0'>&#xA0;0112: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;0113: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0114: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector1d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_vector1d {
  double x;
};
</pre><pre class='cython line score-0'>&#xA0;0115:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class='cython line score-0'>&#xA0;0116: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0117: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector2d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_vector2d {
  double x;
  double y;
};
</pre><pre class='cython line score-0'>&#xA0;0118:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class='cython line score-0'>&#xA0;0119:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class='cython line score-0'>&#xA0;0120: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0121: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">vector3d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_vector3d {
  double x;
  double y;
  double z;
};
</pre><pre class='cython line score-0'>&#xA0;0122:   <span class="n">double</span> <span class="n">x</span></pre>
<pre class='cython line score-0'>&#xA0;0123:   <span class="n">double</span> <span class="n">y</span></pre>
<pre class='cython line score-0'>&#xA0;0124:   <span class="n">double</span> <span class="n">z</span></pre>
<pre class='cython line score-0'>&#xA0;0125: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0126: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment1d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_segment1d {
  struct __pyx_t_3rbf_8geometry_vector1d a;
  struct __pyx_t_3rbf_8geometry_vector1d b;
};
</pre><pre class='cython line score-0'>&#xA0;0127:   <span class="n">vector1d</span> <span class="n">a</span></pre>
<pre class='cython line score-0'>&#xA0;0128:   <span class="n">vector1d</span> <span class="n">b</span></pre>
<pre class='cython line score-0'>&#xA0;0129: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0130: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment2d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_segment2d {
  struct __pyx_t_3rbf_8geometry_vector2d a;
  struct __pyx_t_3rbf_8geometry_vector2d b;
};
</pre><pre class='cython line score-0'>&#xA0;0131:   <span class="n">vector2d</span> <span class="n">a</span></pre>
<pre class='cython line score-0'>&#xA0;0132:   <span class="n">vector2d</span> <span class="n">b</span></pre>
<pre class='cython line score-0'>&#xA0;0133: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0134: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">segment3d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_segment3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
};
</pre><pre class='cython line score-0'>&#xA0;0135:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class='cython line score-0'>&#xA0;0136:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class='cython line score-0'>&#xA0;0137: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0138: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">triangle2d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_triangle2d {
  struct __pyx_t_3rbf_8geometry_vector2d a;
  struct __pyx_t_3rbf_8geometry_vector2d b;
  struct __pyx_t_3rbf_8geometry_vector2d c;
};
</pre><pre class='cython line score-0'>&#xA0;0139:   <span class="n">vector2d</span> <span class="n">a</span></pre>
<pre class='cython line score-0'>&#xA0;0140:   <span class="n">vector2d</span> <span class="n">b</span></pre>
<pre class='cython line score-0'>&#xA0;0141:   <span class="n">vector2d</span> <span class="n">c</span></pre>
<pre class='cython line score-0'>&#xA0;0142: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0143: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">triangle3d</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_t_3rbf_8geometry_triangle3d {
  struct __pyx_t_3rbf_8geometry_vector3d a;
  struct __pyx_t_3rbf_8geometry_vector3d b;
  struct __pyx_t_3rbf_8geometry_vector3d c;
};
</pre><pre class='cython line score-0'>&#xA0;0144:   <span class="n">vector3d</span> <span class="n">a</span></pre>
<pre class='cython line score-0'>&#xA0;0145:   <span class="n">vector3d</span> <span class="n">b</span></pre>
<pre class='cython line score-0'>&#xA0;0146:   <span class="n">vector3d</span> <span class="n">c</span></pre>
<pre class='cython line score-0'>&#xA0;0147: </pre>
<pre class='cython line score-0'>&#xA0;0148: <span class="c">## point in simplex functions</span></pre>
<pre class='cython line score-0'>&#xA0;0149: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;0150: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0151: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">point_in_segment</span><span class="p">(</span><span class="n">vector1d</span> <span class="n">vec</span><span class="p">,</span> <span class="n">segment1d</span> <span class="n">seg</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry_point_in_segment(struct __pyx_t_3rbf_8geometry_vector1d __pyx_v_vec, struct __pyx_t_3rbf_8geometry_segment1d __pyx_v_seg) {
  double __pyx_v_l1;
  double __pyx_v_l2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0152:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0153: <span class="sd">  Identifies whether a point in 1D space is within a 1D segment. For </span></pre>
<pre class='cython line score-0'>&#xA0;0154: <span class="sd">  the sake of consistency, this is done by projecting the point into a </span></pre>
<pre class='cython line score-0'>&#xA0;0155: <span class="sd">  barycentric coordinate system defined by the segment. The point is </span></pre>
<pre class='cython line score-0'>&#xA0;0156: <span class="sd">  then inside the segment if both of the barycentric coordinates are </span></pre>
<pre class='cython line score-0'>&#xA0;0157: <span class="sd">  positive</span></pre>
<pre class='cython line score-0'>&#xA0;0158: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0159:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0160:     <span class="n">double</span> <span class="n">l1</span><span class="p">,</span><span class="n">l2</span></pre>
<pre class='cython line score-0'>&#xA0;0161: </pre>
<pre class='cython line score-0'>&#xA0;0162:   <span class="c"># find barycentric coordinates  </span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0163:   <span class="n">l1</span> <span class="o">=</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1 = ((__pyx_v_seg.a.x - __pyx_v_vec.x) / (__pyx_v_seg.a.x - __pyx_v_seg.b.x));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0164:   <span class="n">l2</span> <span class="o">=</span> <span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_l2 = ((__pyx_v_vec.x - __pyx_v_seg.b.x) / (__pyx_v_seg.a.x - __pyx_v_seg.b.x));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0165:   <span class="k">if</span> <span class="p">(</span><span class="n">l1</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l2</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_l1 &gt;= 0.0) &amp; (__pyx_v_l2 &gt;= 0.0)) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0166:     <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_r = 1;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0167:   <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0168:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0169: </pre>
<pre class='cython line score-0'>&#xA0;0170: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0171: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">point_in_triangle</span><span class="p">(</span><span class="n">vector2d</span> <span class="n">vec</span><span class="p">,</span> <span class="n">triangle2d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry_point_in_triangle(struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec, struct __pyx_t_3rbf_8geometry_triangle2d __pyx_v_tri) {
  double __pyx_v_det;
  double __pyx_v_l1;
  double __pyx_v_l2;
  double __pyx_v_l3;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0172:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0173: <span class="sd">  Identifies whether a point in 2D space is within a 2D triangle. This </span></pre>
<pre class='cython line score-0'>&#xA0;0174: <span class="sd">  is done by projecting the point into a barycentric coordinate system </span></pre>
<pre class='cython line score-0'>&#xA0;0175: <span class="sd">  defined by the triangle. The point is then inside the segment if all </span></pre>
<pre class='cython line score-0'>&#xA0;0176: <span class="sd">  three of the barycentric coordinates are positive</span></pre>
<pre class='cython line score-0'>&#xA0;0177: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0178:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0179:     <span class="n">double</span> <span class="n">det</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">l2</span><span class="p">,</span><span class="n">l3</span></pre>
<pre class='cython line score-0'>&#xA0;0180: </pre>
<pre class='cython line score-0'>&#xA0;0181:   <span class="c"># find barycentric coordinates  </span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0182:   <span class="n">det</span> <span class="o">=</span>  <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_det = (((__pyx_v_tri.b.y - __pyx_v_tri.c.y) * (__pyx_v_tri.a.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.c.x - __pyx_v_tri.b.x) * (__pyx_v_tri.a.y - __pyx_v_tri.c.y)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0183:   <span class="n">l1</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">det</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1 = ((((__pyx_v_tri.b.y - __pyx_v_tri.c.y) * (__pyx_v_vec.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.c.x - __pyx_v_tri.b.x) * (__pyx_v_vec.y - __pyx_v_tri.c.y))) / __pyx_v_det);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0184:   <span class="n">l2</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">vec</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">det</span></pre>
<pre class='cython code score-0'>  __pyx_v_l2 = ((((__pyx_v_tri.c.y - __pyx_v_tri.a.y) * (__pyx_v_vec.x - __pyx_v_tri.c.x)) + ((__pyx_v_tri.a.x - __pyx_v_tri.c.x) * (__pyx_v_vec.y - __pyx_v_tri.c.y))) / __pyx_v_det);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0185:   <span class="n">l3</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">l1</span> <span class="o">-</span> <span class="n">l2</span></pre>
<pre class='cython code score-0'>  __pyx_v_l3 = ((1.0 - __pyx_v_l1) - __pyx_v_l2);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0186:   <span class="k">if</span> <span class="p">(</span><span class="n">l1</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l2</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l3</span><span class="o">&gt;=</span><span class="mf">0.0</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((((__pyx_v_l1 &gt;= 0.0) &amp; (__pyx_v_l2 &gt;= 0.0)) &amp; (__pyx_v_l3 &gt;= 0.0)) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0187:     <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0'>    __pyx_r = 1;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0188:   <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0189:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0190: </pre>
<pre class='cython line score-0'>&#xA0;0191: </pre>
<pre class='cython line score-0'>&#xA0;0192: <span class="c">## simplex normals functions</span></pre>
<pre class='cython line score-0'>&#xA0;0193: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0194: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">segment_normal_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry_segment_normal_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg) {
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0195:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0196: <span class="sd">  Returns the vector normal to a 2d line segment</span></pre>
<pre class='cython line score-0'>&#xA0;0197: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0198:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0199:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class='cython line score-0'>&#xA0;0200: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0201:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (__pyx_v_seg.b.y - __pyx_v_seg.a.y);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0202:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (-(__pyx_v_seg.b.x - __pyx_v_seg.a.x));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0203:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0204: </pre>
<pre class='cython line score-0'>&#xA0;0205: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0206: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">triangle_normal_3d</span><span class="p">(</span><span class="n">triangle3d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry_triangle_normal_3d(struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri) {
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0207:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0208: <span class="sd">  Returns the vector normal to a 3d triangle</span></pre>
<pre class='cython line score-0'>&#xA0;0209: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0210:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0211:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class='cython line score-0'>&#xA0;0212: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0213:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)));
</pre><pre class='cython line score-0'>&#xA0;0214:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0215:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (-(((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.z - __pyx_v_tri.a.z)) - ((__pyx_v_tri.b.z - __pyx_v_tri.a.z) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x))));
</pre><pre class='cython line score-0'>&#xA0;0216:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0217:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span>  <span class="p">((</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.z = (((__pyx_v_tri.b.x - __pyx_v_tri.a.x) * (__pyx_v_tri.c.y - __pyx_v_tri.a.y)) - ((__pyx_v_tri.b.y - __pyx_v_tri.a.y) * (__pyx_v_tri.c.x - __pyx_v_tri.a.x)));
</pre><pre class='cython line score-0'>&#xA0;0218:             <span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0219:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0220: </pre>
<pre class='cython line score-0'>&#xA0;0221: </pre>
<pre class='cython line score-0'>&#xA0;0222: <span class="c">## find point outside simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;0223: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;0224: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0225: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0226: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0227: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">find_outside_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry_find_outside_2d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0228:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0229: <span class="sd">  Finds a arbitrary point that is outside of a polygon defined by</span></pre>
<pre class='cython line score-0'>&#xA0;0230: <span class="sd">  the given vertices</span></pre>
<pre class='cython line score-0'>&#xA0;0231: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0232:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0233:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0'>&#xA0;0234:     <span class="n">vector2d</span> <span class="n">out</span></pre>
<pre class='cython line score-0'>&#xA0;0235: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0236:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0237:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0238:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_v.shape[0]);
  for (__pyx_t_6 = 1; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0239:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_7 * __pyx_v_v.strides[0]) ) + __pyx_t_8 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0240:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_10 * __pyx_v_v.strides[0]) ) + __pyx_t_11 * __pyx_v_v.strides[1]) )));
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;0241: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0242:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_t_9 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_12 * __pyx_v_v.strides[0]) ) + __pyx_t_13 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0243:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) ) + __pyx_t_15 * __pyx_v_v.strides[1]) )));
      goto __pyx_L6;
    }
    __pyx_L6:;
  }
</pre><pre class='cython line score-0'>&#xA0;0244: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0245:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0246:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class='cython line score-0'>&#xA0;0247: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0248:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0249: </pre>
<pre class='cython line score-0'>&#xA0;0250: </pre>
<pre class='cython line score-0'>&#xA0;0251: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0252: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0253: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0254: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">find_outside_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">v</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry_find_outside_3d(__Pyx_memviewslice __pyx_v_v) {
  unsigned int __pyx_v_i;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0255:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0256: <span class="sd">  Finds a arbitrary point that is outside of a polyhedron defined by</span></pre>
<pre class='cython line score-0'>&#xA0;0257: <span class="sd">  the given vertices</span></pre>
<pre class='cython line score-0'>&#xA0;0258: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0259:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0260:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0'>&#xA0;0261:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class='cython line score-0'>&#xA0;0262: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0263:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_1 * __pyx_v_v.strides[0]) ) + __pyx_t_2 * __pyx_v_v.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0264:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_3 * __pyx_v_v.strides[0]) ) + __pyx_t_4 * __pyx_v_v.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0265:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = 0;
  __pyx_t_6 = 2;
  __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_5 * __pyx_v_v.strides[0]) ) + __pyx_t_6 * __pyx_v_v.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0266:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_7 = (__pyx_v_v.shape[0]);
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0267:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">x</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_9 * __pyx_v_v.strides[0]) ) + __pyx_t_10 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.x) != 0);
    if (__pyx_t_11) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0268:       <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = 0;
      __pyx_v_out.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_12 * __pyx_v_v.strides[0]) ) + __pyx_t_13 * __pyx_v_v.strides[1]) )));
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;0269: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0270:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">y</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) ) + __pyx_t_15 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.y) != 0);
    if (__pyx_t_11) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0271:       <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_16 = __pyx_v_i;
      __pyx_t_17 = 1;
      __pyx_v_out.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) ) + __pyx_t_17 * __pyx_v_v.strides[1]) )));
      goto __pyx_L6;
    }
    __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;0272: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0273:     <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">out</span><span class="o">.</span><span class="n">z</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) ) + __pyx_t_19 * __pyx_v_v.strides[1]) ))) &lt; __pyx_v_out.z) != 0);
    if (__pyx_t_11) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0274:       <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = 2;
      __pyx_v_out.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) ) + __pyx_t_21 * __pyx_v_v.strides[1]) )));
      goto __pyx_L7;
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;0275: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0276:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">-=</span> <span class="mf">1.23456789</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (__pyx_v_out.x - 1.23456789);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0277:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="mf">2.34567891</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (__pyx_v_out.y - 2.34567891);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0278:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">-=</span> <span class="mf">3.45678912</span><span class="c"># + rand()*1.0/RAND_MAX</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.z = (__pyx_v_out.z - 3.45678912);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0279:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0280: </pre>
<pre class='cython line score-0'>&#xA0;0281: </pre>
<pre class='cython line score-0'>&#xA0;0282: <span class="c">## 2D point in polygon functions</span></pre>
<pre class='cython line score-0'>&#xA0;0283: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;0284: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0285: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry_is_intersecting_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_pnt;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector1d __pyx_v_pnt_proj;
  struct __pyx_t_3rbf_8geometry_segment1d __pyx_v_seg_proj;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0286:                              <span class="n">segment2d</span> <span class="n">seg2</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0287:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0288: <span class="sd">  Identifies whether two 2D segments intersect. An intersection is</span></pre>
<pre class='cython line score-0'>&#xA0;0289: <span class="sd">  detected if both segments are not colinear and if any part of the</span></pre>
<pre class='cython line score-0'>&#xA0;0290: <span class="sd">  two segments touch</span></pre>
<pre class='cython line score-0'>&#xA0;0291: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0292:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0293:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class='cython line score-0'>&#xA0;0294:     <span class="n">vector2d</span> <span class="n">pnt</span></pre>
<pre class='cython line score-0'>&#xA0;0295:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0296:     <span class="n">vector1d</span> <span class="n">pnt_proj</span></pre>
<pre class='cython line score-0'>&#xA0;0297:     <span class="n">segment1d</span> <span class="n">seg_proj</span></pre>
<pre class='cython line score-0'>&#xA0;0298: </pre>
<pre class='cython line score-0'>&#xA0;0299:   <span class="c"># find the normal vector components for segment 2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0300:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class='cython line score-0'>&#xA0;0301: </pre>
<pre class='cython line score-0'>&#xA0;0302:   <span class="c"># project both points in segment 1 onto the normal vector</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0303:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0304:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0305:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0306:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0307: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0308:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0309:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0310: </pre>
<pre class='cython line score-0'>&#xA0;0311:   <span class="c"># return false if the segments are collinear</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0312:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0313:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0314: </pre>
<pre class='cython line score-0'>&#xA0;0315:   <span class="c"># find the point where segment 1 intersects the line overlapping </span></pre>
<pre class='cython line score-0'>&#xA0;0316:   <span class="c"># segment 2 </span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0317:   <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0'>  __pyx_v_pnt.x = (__pyx_v_seg1.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.x - __pyx_v_seg1.a.x)));
</pre><pre class='cython line score-0'>&#xA0;0318:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">))</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0319:   <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span></pre>
<pre class='cython code score-0'>  __pyx_v_pnt.y = (__pyx_v_seg1.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.y - __pyx_v_seg1.a.y)));
</pre><pre class='cython line score-0'>&#xA0;0320:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython line score-0'>&#xA0;0321: </pre>
<pre class='cython line score-0'>&#xA0;0322:   <span class="c"># if the normal x component is larger then compare y values</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0323:   <span class="k">if</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.y)) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0324:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0325:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_seg2.a.y;
    __pyx_v_seg_proj.a.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0326:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_seg2.b.y;
    __pyx_v_seg_proj.b.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0327:     <span class="k">return</span> <span class="n">point_in_segment</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">seg_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_segment(__pyx_v_pnt_proj, __pyx_v_seg_proj);
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0328: </pre>
<pre class='cython line score-0'>&#xA0;0329:   <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0330:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0331:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_seg2.a.x;
    __pyx_v_seg_proj.a.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0332:     <span class="n">seg_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_seg2.b.x;
    __pyx_v_seg_proj.b.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0333:     <span class="k">return</span> <span class="n">point_in_segment</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">seg_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_segment(__pyx_v_pnt_proj, __pyx_v_seg_proj);
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0334: </pre>
<pre class='cython line score-0'>&#xA0;0335: </pre>
<pre class='cython line score-0'>&#xA0;0336: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0337: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+0338: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_count_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-6'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_count_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0339:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0340:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0341:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0342:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0343: <span class="sd">  Returns an array containing the number of simplices intersected </span></pre>
<pre class='cython line score-0'>&#xA0;0344: <span class="sd">  between start_pnts and end_pnts</span></pre>
<pre class='cython line score-0'>&#xA0;0345: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0346:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0347:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0348:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+0349:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0350:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0351: </pre>
<pre class='cython line score-0'>&#xA0;0352:   <span class="c"># This can be parallelized with prange</span></pre>
<pre class='cython line score-0'>&#xA0;0353:   <span class="c">#for i in prange(N):</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0354:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0355:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0356:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0357:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_12 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0358:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0359:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_count_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_16 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__intersection_count_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
  }
</pre><pre class='cython line score-0'>&#xA0;0360: </pre>
<pre class='cython line score-0'>&#xA0;0361: </pre>
<pre class='cython line score-29' onclick='toggleDiv(this)'>+0362:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-29'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0363: </pre>
<pre class='cython line score-0'>&#xA0;0364: </pre>
<pre class='cython line score-0'>&#xA0;0365: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0366: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0367: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_count_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry__intersection_count_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0368:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0369:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0370:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0371:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0372:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = 0;
</pre><pre class='cython line score-0'>&#xA0;0373:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class='cython line score-0'>&#xA0;0374: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0375:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0376:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0377:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0378:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 0;
    __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0379:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 1;
    __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0380:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">seg2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_19 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg1, __pyx_v_seg2) != 0);
    if (__pyx_t_19) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0381:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + 1);
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;0382: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0383:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0384: </pre>
<pre class='cython line score-0'>&#xA0;0385: </pre>
<pre class='cython line score-0'>&#xA0;0386: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0387: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0388: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_index_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_index_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0389:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0390:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0391:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0392:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0393: <span class="sd">  Returns an array identifying which simplex is intersected by</span></pre>
<pre class='cython line score-0'>&#xA0;0394: <span class="sd">  start_pnts and end_pnts</span></pre>
<pre class='cython line score-0'>&#xA0;0395: </pre>
<pre class='cython line score-0'>&#xA0;0396: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0397: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0398: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0399: </pre>
<pre class='cython line score-0'>&#xA0;0400: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0401:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0402:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0403:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+0404:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0405:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0406: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0407:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0408:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0409:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0410:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_12 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0411:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0412:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 412; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_17 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_17 * __pyx_v_out.strides[0]) )) = __pyx_t_16;
  }
</pre><pre class='cython line score-0'>&#xA0;0413: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0414:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0415: </pre>
<pre class='cython line score-0'>&#xA0;0416: </pre>
<pre class='cython line score-0'>&#xA0;0417: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0418: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0419: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0420: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_index_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static int __pyx_f_3rbf_8geometry__intersection_index_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_out;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_t;
  double __pyx_v_closest;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_index_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_index_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0421:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0422:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0423:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0424:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0425:     <span class="nb">int</span> <span class="n">out</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>  __pyx_v_out = -1;
</pre><pre class='cython line score-0'>&#xA0;0426:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">t</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0427:     <span class="n">double</span> <span class="n">closest</span> <span class="o">=</span> <span class="mf">999.9</span></pre>
<pre class='cython code score-0'>  __pyx_v_closest = 999.9;
</pre><pre class='cython line score-0'>&#xA0;0428:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class='cython line score-0'>&#xA0;0429:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0430: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0431:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0432:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0433:     <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0434:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 0;
    __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0435:     <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 1;
    __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0436:     <span class="k">if</span> <span class="n">is_intersecting_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">seg2</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_19 = (__pyx_f_3rbf_8geometry_is_intersecting_2d(__pyx_v_seg1, __pyx_v_seg2) != 0);
    if (__pyx_t_19) {
</pre><pre class='cython line score-0'>&#xA0;0437:       <span class="c"># the intersecting segment should be the first segment </span></pre>
<pre class='cython line score-0'>&#xA0;0438:       <span class="c"># intersected when going from seg1.a to seg1.b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0439:       <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0440:       <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>      __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0441:                <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0442:       <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>      __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0443:                <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0444:       <span class="c"># t is a scalar between 0 and 1. If t=0 then the intersection is </span></pre>
<pre class='cython line score-0'>&#xA0;0445:       <span class="c"># at seg1.a and if t=1 then the intersection is at seg1.b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0446:       <span class="n">t</span> <span class="o">=</span> <span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_t = (__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0447:       <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">closest</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_19 = ((__pyx_v_t &lt; __pyx_v_closest) != 0);
      if (__pyx_t_19) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0448:         <span class="n">closest</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0'>        __pyx_v_closest = __pyx_v_t;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0449:         <span class="n">out</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0'>        __pyx_v_out = __pyx_v_i;
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;0450: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0451:   <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_19 = ((__pyx_v_out == -1) != 0);
  if (__pyx_t_19) {
</pre><pre class='cython line score-0'>&#xA0;0452:     <span class="c"># out is -1 iff no intersection was found</span></pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+0453:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-15'>    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen, __pyx_t_24);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_23);
    __pyx_t_23 = 0;
    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_t_24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_23, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+0454:                      <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">))</span></pre>
<pre class='cython code score-29'>    __pyx_t_20 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_22 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg1.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_20);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 2, __pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 3, __pyx_t_23);
    __pyx_t_20 = 0;
    __pyx_t_21 = 0;
    __pyx_t_22 = 0;
    __pyx_t_23 = 0;
</pre><pre class='cython line score-0'>&#xA0;0455: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0456:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0457: </pre>
<pre class='cython line score-0'>&#xA0;0458: </pre>
<pre class='cython line score-0'>&#xA0;0459: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0460: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0461: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_point_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_point_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0462:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0463:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0464:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0465:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0466: <span class="sd">  Returns an array of intersection points between the line segments, </span></pre>
<pre class='cython line score-0'>&#xA0;0467: <span class="sd">  defined in terms of start_pnts and end_pnts, and the simplices.</span></pre>
<pre class='cython line score-0'>&#xA0;0468: </pre>
<pre class='cython line score-0'>&#xA0;0469: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0470: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0471: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0472: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0473:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0474:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0475:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-44' onclick='toggleDiv(this)'>+0476:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0477:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0478:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class='cython line score-0'>&#xA0;0479: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0480:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0481:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0482:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0483:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_12 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0484:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0485:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_point_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_f_3rbf_8geometry__intersection_point_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_vec = __pyx_t_16;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0486:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_17 = __pyx_v_vec.x;
    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) ) + __pyx_t_19 * __pyx_v_out.strides[1]) )) = __pyx_t_17;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0487:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_17 = __pyx_v_vec.y;
    __pyx_t_20 = __pyx_v_i;
    __pyx_t_21 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_20 * __pyx_v_out.strides[0]) ) + __pyx_t_21 * __pyx_v_out.strides[1]) )) = __pyx_t_17;
  }
</pre><pre class='cython line score-0'>&#xA0;0488: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0489:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0490: </pre>
<pre class='cython line score-0'>&#xA0;0491: </pre>
<pre class='cython line score-0'>&#xA0;0492: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0493: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0494: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+0495: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_intersection_point_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-2'>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__intersection_point_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_idx;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_point_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_point_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0496:                                      <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0497:                                      <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0498:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0499:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class='cython line score-0'>&#xA0;0500:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class='cython line score-0'>&#xA0;0501:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class='cython line score-0'>&#xA0;0502:     <span class="n">vector2d</span> <span class="n">out</span><span class="p">,</span><span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0503: </pre>
<pre class='cython line score-0'>&#xA0;0504: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0505:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg1, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0506:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_idx;
  __pyx_t_2 = 0;
  __pyx_t_3 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_1 * __pyx_v_simplices.strides[0]) ) + __pyx_t_2 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_4 = 0;
  __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_3 * __pyx_v_vertices.strides[0]) ) + __pyx_t_4 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0507:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = __pyx_v_idx;
  __pyx_t_6 = 0;
  __pyx_t_7 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_5 * __pyx_v_simplices.strides[0]) ) + __pyx_t_6 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_8 = 1;
  __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_7 * __pyx_v_vertices.strides[0]) ) + __pyx_t_8 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0508:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = __pyx_v_idx;
  __pyx_t_10 = 1;
  __pyx_t_11 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_9 * __pyx_v_simplices.strides[0]) ) + __pyx_t_10 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_12 = 0;
  __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_11 * __pyx_v_vertices.strides[0]) ) + __pyx_t_12 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0509:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_idx;
  __pyx_t_14 = 1;
  __pyx_t_15 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_13 * __pyx_v_simplices.strides[0]) ) + __pyx_t_14 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_16 = 1;
  __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_15 * __pyx_v_vertices.strides[0]) ) + __pyx_t_16 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0'>&#xA0;0510: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0511:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class='cython line score-0'>&#xA0;0512: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0513:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj1 = (((__pyx_v_seg1.a.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.a.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0514:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0515:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj2 = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0516:            <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0517: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0518:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (__pyx_v_seg1.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.x - __pyx_v_seg1.a.x)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0519:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg1</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (__pyx_v_seg1.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg1.b.y - __pyx_v_seg1.a.y)));
</pre><pre class='cython line score-0'>&#xA0;0520: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0521:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0522: </pre>
<pre class='cython line score-0'>&#xA0;0523: </pre>
<pre class='cython line score-0'>&#xA0;0524: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0525: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0526: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_normals_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_normals_2d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_normals_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_normals_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0527:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0528:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0529:                                  <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0530:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0531: <span class="sd">  Returns an array of normal vectors to the simplices intersected by</span></pre>
<pre class='cython line score-0'>&#xA0;0532: <span class="sd">  the line segments </span></pre>
<pre class='cython line score-0'>&#xA0;0533: </pre>
<pre class='cython line score-0'>&#xA0;0534: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0535: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0536: <span class="sd">    if there is not intersection then a ValueError is returned</span></pre>
<pre class='cython line score-0'>&#xA0;0537: </pre>
<pre class='cython line score-0'>&#xA0;0538: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0539:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0540:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0541:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-44' onclick='toggleDiv(this)'>+0542:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0543:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0544:     <span class="n">vector2d</span> <span class="n">vec</span></pre>
<pre class='cython line score-0'>&#xA0;0545: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0546:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0547:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0548:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0549:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_12 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0550:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0551:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_normals_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_f_3rbf_8geometry__cross_normals_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_vec = __pyx_t_16;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0552:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_17 = __pyx_v_vec.x;
    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_18 * __pyx_v_out.strides[0]) ) + __pyx_t_19 * __pyx_v_out.strides[1]) )) = __pyx_t_17;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0553:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_17 = __pyx_v_vec.y;
    __pyx_t_20 = __pyx_v_i;
    __pyx_t_21 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_20 * __pyx_v_out.strides[0]) ) + __pyx_t_21 * __pyx_v_out.strides[1]) )) = __pyx_t_17;
  }
</pre><pre class='cython line score-0'>&#xA0;0554: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0555:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0556: </pre>
<pre class='cython line score-0'>&#xA0;0557: </pre>
<pre class='cython line score-0'>&#xA0;0558: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0559: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0560: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+0561: <span class="k">cdef</span> <span class="kt">vector2d</span> <span class="nf">_cross_normals_2d</span><span class="p">(</span><span class="n">segment2d</span> <span class="n">seg1</span><span class="p">,</span></pre>
<pre class='cython code score-2'>static struct __pyx_t_3rbf_8geometry_vector2d __pyx_f_3rbf_8geometry__cross_normals_2d(struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg1, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_mag;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg2;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_normals_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_normals_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0562:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0563:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0564:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0565:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">mag</span></pre>
<pre class='cython line score-0'>&#xA0;0566:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class='cython line score-0'>&#xA0;0567:     <span class="n">segment2d</span> <span class="n">seg2</span></pre>
<pre class='cython line score-0'>&#xA0;0568:     <span class="n">vector2d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0569: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0570:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_2d</span><span class="p">(</span><span class="n">seg1</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_2d(__pyx_v_seg1, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0571:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_idx;
  __pyx_t_2 = 0;
  __pyx_t_3 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_1 * __pyx_v_simplices.strides[0]) ) + __pyx_t_2 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_4 = 0;
  __pyx_v_seg2.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_3 * __pyx_v_vertices.strides[0]) ) + __pyx_t_4 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0572:   <span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = __pyx_v_idx;
  __pyx_t_6 = 0;
  __pyx_t_7 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_5 * __pyx_v_simplices.strides[0]) ) + __pyx_t_6 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_8 = 1;
  __pyx_v_seg2.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_7 * __pyx_v_vertices.strides[0]) ) + __pyx_t_8 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0573:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = __pyx_v_idx;
  __pyx_t_10 = 1;
  __pyx_t_11 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_9 * __pyx_v_simplices.strides[0]) ) + __pyx_t_10 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_12 = 0;
  __pyx_v_seg2.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_11 * __pyx_v_vertices.strides[0]) ) + __pyx_t_12 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0574:   <span class="n">seg2</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_idx;
  __pyx_t_14 = 1;
  __pyx_t_15 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_13 * __pyx_v_simplices.strides[0]) ) + __pyx_t_14 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_16 = 1;
  __pyx_v_seg2.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_15 * __pyx_v_vertices.strides[0]) ) + __pyx_t_16 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0'>&#xA0;0575: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0576:   <span class="n">n</span> <span class="o">=</span> <span class="n">segment_normal_2d</span><span class="p">(</span><span class="n">seg2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_segment_normal_2d(__pyx_v_seg2);
</pre><pre class='cython line score-0'>&#xA0;0577: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0578:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj = (((__pyx_v_seg1.b.x - __pyx_v_seg2.a.x) * __pyx_v_n.x) + ((__pyx_v_seg1.b.y - __pyx_v_seg2.a.y) * __pyx_v_n.y));
</pre><pre class='cython line score-0'>&#xA0;0579:           <span class="p">(</span><span class="n">seg1</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg2</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0580: </pre>
<pre class='cython line score-0'>&#xA0;0581:   <span class="c"># This ensures that the normal vector points in the direction of seg1</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0582:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_17 = ((__pyx_v_proj &lt; 0.0) != 0);
  if (__pyx_t_17) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0583:     <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_n.x = (__pyx_v_n.x * -1.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0584:     <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_n.y = (__pyx_v_n.y * -1.0);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;0585: </pre>
<pre class='cython line score-0'>&#xA0;0586:   <span class="c"># normalize the normal vector to 1</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0587:   <span class="n">mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_mag = sqrt((pow(__pyx_v_n.x, 2.0) + pow(__pyx_v_n.y, 2.0)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0588:   <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0'>  __pyx_v_n.x = (__pyx_v_n.x / __pyx_v_mag);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0589:   <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0'>  __pyx_v_n.y = (__pyx_v_n.y / __pyx_v_mag);
</pre><pre class='cython line score-0'>&#xA0;0590: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0591:   <span class="k">return</span> <span class="n">n</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_n;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0592: </pre>
<pre class='cython line score-0'>&#xA0;0593: </pre>
<pre class='cython line score-0'>&#xA0;0594: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0595: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+0596: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_2d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6'>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_2d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment2d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_outside_pnt;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_2d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0597:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0598:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0599:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0600: <span class="sd">  Returns a boolean array identifying which points are contained in </span></pre>
<pre class='cython line score-0'>&#xA0;0601: <span class="sd">  the closed simplicial complex described by vertices and simplices</span></pre>
<pre class='cython line score-0'>&#xA0;0602: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0603:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0604:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0605:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+0606:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0607:     <span class="n">segment2d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0608:     <span class="n">vector2d</span> <span class="n">outside_pnt</span></pre>
<pre class='cython line score-0'>&#xA0;0609: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0610:   <span class="n">outside_pnt</span> <span class="o">=</span> <span class="n">find_outside_2d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_outside_pnt = __pyx_f_3rbf_8geometry_find_outside_2d(__pyx_v_vertices);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0611:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0612:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_outside_pnt.x;
    __pyx_v_seg.a.x = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0613:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_outside_pnt.y;
    __pyx_v_seg.a.y = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0614:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_9 * __pyx_v_pnt.strides[0]) ) + __pyx_t_10 * __pyx_v_pnt.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0615:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_11 * __pyx_v_pnt.strides[0]) ) + __pyx_t_12 * __pyx_v_pnt.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0616:     <span class="n">count</span> <span class="o">=</span> <span class="n">_intersection_count_2d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_count = __pyx_f_3rbf_8geometry__intersection_count_2d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0617:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0'>    __pyx_t_13 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_13 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
  }
</pre><pre class='cython line score-0'>&#xA0;0618: </pre>
<pre class='cython line score-29' onclick='toggleDiv(this)'>+0619:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-29'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0620: </pre>
<pre class='cython line score-0'>&#xA0;0621: </pre>
<pre class='cython line score-0'>&#xA0;0622: <span class="c">## 3D point in polygon functions</span></pre>
<pre class='cython line score-0'>&#xA0;0623: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-0'>&#xA0;0624: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0625: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0626: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0627: <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_intersecting_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry_is_intersecting_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri) {
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_pnt;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector2d __pyx_v_pnt_proj;
  struct __pyx_t_3rbf_8geometry_triangle2d __pyx_v_tri_proj;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0628:                              <span class="n">triangle3d</span> <span class="n">tri</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0629:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0630: <span class="sd">  Returns True if the 3D segment intersects the 3D triangle. An </span></pre>
<pre class='cython line score-0'>&#xA0;0631: <span class="sd">  intersection is detected if the segment and triangle are not </span></pre>
<pre class='cython line score-0'>&#xA0;0632: <span class="sd">  coplanar and if any part of the segment touches the triangle at an </span></pre>
<pre class='cython line score-0'>&#xA0;0633: <span class="sd">  edge or in the interior.</span></pre>
<pre class='cython line score-0'>&#xA0;0634: </pre>
<pre class='cython line score-0'>&#xA0;0635: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0636: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0637: <span class="sd">    This function determines where the segment intersects the plane</span></pre>
<pre class='cython line score-0'>&#xA0;0638: <span class="sd">    containing the triangle and then projects the intersection point</span></pre>
<pre class='cython line score-0'>&#xA0;0639: <span class="sd">    and triangle into a 2D plane where the point is then tested if it</span></pre>
<pre class='cython line score-0'>&#xA0;0640: <span class="sd">    is within the triangle.</span></pre>
<pre class='cython line score-0'>&#xA0;0641: </pre>
<pre class='cython line score-0'>&#xA0;0642: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0643:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0644:     <span class="n">vector3d</span> <span class="n">pnt</span><span class="p">,</span><span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0645:     <span class="n">vector2d</span> <span class="n">pnt_proj</span></pre>
<pre class='cython line score-0'>&#xA0;0646:     <span class="n">triangle2d</span> <span class="n">tri_proj</span></pre>
<pre class='cython line score-0'>&#xA0;0647:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class='cython line score-0'>&#xA0;0648: </pre>
<pre class='cython line score-0'>&#xA0;0649:   <span class="c"># find triangle normal vector components</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0650:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class='cython line score-0'>&#xA0;0651: </pre>
<pre class='cython line score-0'>&#xA0;0652:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0653:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0654:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0655:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0656:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0657:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0658: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0659:   <span class="k">if</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_proj1 * __pyx_v_proj2) &gt; 0.0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0660:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0661: </pre>
<pre class='cython line score-0'>&#xA0;0662:   <span class="c"># coplanar segments will always return false</span></pre>
<pre class='cython line score-0'>&#xA0;0663:   <span class="c"># There is a possibility that the segment touches</span></pre>
<pre class='cython line score-0'>&#xA0;0664:   <span class="c"># one point on the triangle</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0665:   <span class="k">if</span> <span class="p">(</span><span class="n">proj1</span> <span class="o">==</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proj2</span> <span class="o">==</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_proj1 == 0.0) &amp; (__pyx_v_proj2 == 0.0)) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0666:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0'>    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0667: </pre>
<pre class='cython line score-0'>&#xA0;0668:   <span class="c"># intersection point</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0669:   <span class="n">pnt</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_pnt.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0670:   <span class="n">pnt</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_pnt.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0671:   <span class="n">pnt</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_pnt.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class='cython line score-0'>&#xA0;0672: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0673:   <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.y)) &amp; (fabs(__pyx_v_n.x) &gt;= fabs(__pyx_v_n.z))) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0674:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0675:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.z;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0676:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0677:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0678:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0679:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0680:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0681:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0682:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0683: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0684:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((fabs(__pyx_v_n.y) &gt;= fabs(__pyx_v_n.x)) &amp; (fabs(__pyx_v_n.y) &gt;= fabs(__pyx_v_n.z))) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0685:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0686:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.z;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0687:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0688:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.z;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0689:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0690:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.z;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0691:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0692:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.z;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0693:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0694: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0695:   <span class="k">elif</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">fabs</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="p">)):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((fabs(__pyx_v_n.z) &gt;= fabs(__pyx_v_n.x)) &amp; (fabs(__pyx_v_n.z) &gt;= fabs(__pyx_v_n.y))) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0696:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.x;
    __pyx_v_pnt_proj.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0697:     <span class="n">pnt_proj</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_pnt.y;
    __pyx_v_pnt_proj.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0698:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.x;
    __pyx_v_tri_proj.a.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0699:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.a.y;
    __pyx_v_tri_proj.a.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0700:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.x;
    __pyx_v_tri_proj.b.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0701:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.b.y;
    __pyx_v_tri_proj.b.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0702:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.x;
    __pyx_v_tri_proj.c.x = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0703:     <span class="n">tri_proj</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = __pyx_v_tri.c.y;
    __pyx_v_tri_proj.c.y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0704:     <span class="k">return</span> <span class="n">point_in_triangle</span><span class="p">(</span><span class="n">pnt_proj</span><span class="p">,</span><span class="n">tri_proj</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_f_3rbf_8geometry_point_in_triangle(__pyx_v_pnt_proj, __pyx_v_tri_proj);
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;0705: </pre>
<pre class='cython line score-0'>&#xA0;0706: </pre>
<pre class='cython line score-0'>&#xA0;0707: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0708: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0709: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_count_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_count_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0710:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0711:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0712:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0713:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0714: <span class="sd">  Returns an array of the number of intersections between each line</span></pre>
<pre class='cython line score-0'>&#xA0;0715: <span class="sd">  segment, described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class='cython line score-0'>&#xA0;0716: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0717:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0718:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0719:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+0720:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 720; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0721:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0722: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0723:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0724:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0725:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0726:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0727:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0728:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0729:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_18 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_19 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0730:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_count_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_20 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_20 * __pyx_v_out.strides[0]) )) = __pyx_f_3rbf_8geometry__intersection_count_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
  }
</pre><pre class='cython line score-0'>&#xA0;0731: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0732:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0733: </pre>
<pre class='cython line score-0'>&#xA0;0734: </pre>
<pre class='cython line score-0'>&#xA0;0735: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0736: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0737: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_count_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-0'>static int __pyx_f_3rbf_8geometry__intersection_count_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_count;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0738:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0739:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0740:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0741:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0742:     <span class="n">unsigned</span> <span class="nb">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = 0;
</pre><pre class='cython line score-0'>&#xA0;0743:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class='cython line score-0'>&#xA0;0744: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0745:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_simplices.shape[0]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0746:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0747:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0748:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 0;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0749:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0750:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 1;
    __pyx_t_21 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_19 * __pyx_v_simplices.strides[0]) ) + __pyx_t_20 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_22 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_21 * __pyx_v_vertices.strides[0]) ) + __pyx_t_22 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0751:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 1;
    __pyx_t_25 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_23 * __pyx_v_simplices.strides[0]) ) + __pyx_t_24 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_26 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_25 * __pyx_v_vertices.strides[0]) ) + __pyx_t_26 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0752:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    __pyx_t_29 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_27 * __pyx_v_simplices.strides[0]) ) + __pyx_t_28 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_30 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_29 * __pyx_v_vertices.strides[0]) ) + __pyx_t_30 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0753:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_31 = __pyx_v_i;
    __pyx_t_32 = 2;
    __pyx_t_33 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_31 * __pyx_v_simplices.strides[0]) ) + __pyx_t_32 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_34 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_33 * __pyx_v_vertices.strides[0]) ) + __pyx_t_34 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0754:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_35 = __pyx_v_i;
    __pyx_t_36 = 2;
    __pyx_t_37 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_35 * __pyx_v_simplices.strides[0]) ) + __pyx_t_36 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_38 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_37 * __pyx_v_vertices.strides[0]) ) + __pyx_t_38 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0755:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_39 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_39) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0756:       <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + 1);
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;0757: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0758:   <span class="k">return</span> <span class="n">count</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_count;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0759: </pre>
<pre class='cython line score-0'>&#xA0;0760: </pre>
<pre class='cython line score-0'>&#xA0;0761: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0762: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0763: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_index_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_index_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0764:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0765:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0766:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0767:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0768: <span class="sd">  Returns an array identifying which simplex is intersected by</span></pre>
<pre class='cython line score-0'>&#xA0;0769: <span class="sd">  start_pnts and end_pnts. </span></pre>
<pre class='cython line score-0'>&#xA0;0770: </pre>
<pre class='cython line score-0'>&#xA0;0771: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0772: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0773: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0774: </pre>
<pre class='cython line score-0'>&#xA0;0775: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0776: </pre>
<pre class='cython line score-0'>&#xA0;0777:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0778:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0779:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+0780:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0781:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0782: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0783:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0784:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0785:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0786:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0787:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0788:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0789:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_18 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_19 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0790:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_20 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_21 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_21 * __pyx_v_out.strides[0]) )) = __pyx_t_20;
  }
</pre><pre class='cython line score-0'>&#xA0;0791: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0792:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 792; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0793: </pre>
<pre class='cython line score-0'>&#xA0;0794: </pre>
<pre class='cython line score-0'>&#xA0;0795: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0796: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0797: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+0798: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_intersection_index_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-9'>static int __pyx_f_3rbf_8geometry__intersection_index_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_out;
  int __pyx_v_N;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  double __pyx_v_t;
  double __pyx_v_closest;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_index_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_43);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_44);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_45);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_46);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_index_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0799:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0800:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0801:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0802:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0803:     <span class="nb">int</span> <span class="n">out</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>  __pyx_v_out = -1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0804:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">simplices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_simplices.shape[0]);
</pre><pre class='cython line score-0'>&#xA0;0805:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class='cython line score-0'>&#xA0;0806:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span><span class="p">,</span><span class="n">t</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0807:     <span class="n">double</span> <span class="n">closest</span> <span class="o">=</span> <span class="mf">999.9</span></pre>
<pre class='cython code score-0'>  __pyx_v_closest = 999.9;
</pre><pre class='cython line score-0'>&#xA0;0808:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0809: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0810:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_N;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0811:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_5 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_3 * __pyx_v_simplices.strides[0]) ) + __pyx_t_4 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_6 = 0;
    __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_5 * __pyx_v_vertices.strides[0]) ) + __pyx_t_6 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0812:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_9 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_7 * __pyx_v_simplices.strides[0]) ) + __pyx_t_8 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_10 = 1;
    __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_9 * __pyx_v_vertices.strides[0]) ) + __pyx_t_10 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0813:     <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 0;
    __pyx_t_13 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_11 * __pyx_v_simplices.strides[0]) ) + __pyx_t_12 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_14 = 2;
    __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_13 * __pyx_v_vertices.strides[0]) ) + __pyx_t_14 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0814:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_15 * __pyx_v_simplices.strides[0]) ) + __pyx_t_16 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_18 = 0;
    __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_17 * __pyx_v_vertices.strides[0]) ) + __pyx_t_18 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0815:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_19 = __pyx_v_i;
    __pyx_t_20 = 1;
    __pyx_t_21 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_19 * __pyx_v_simplices.strides[0]) ) + __pyx_t_20 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_22 = 1;
    __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_21 * __pyx_v_vertices.strides[0]) ) + __pyx_t_22 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0816:     <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 1;
    __pyx_t_25 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_23 * __pyx_v_simplices.strides[0]) ) + __pyx_t_24 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_26 = 2;
    __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_25 * __pyx_v_vertices.strides[0]) ) + __pyx_t_26 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0817:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 2;
    __pyx_t_29 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_27 * __pyx_v_simplices.strides[0]) ) + __pyx_t_28 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_30 = 0;
    __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_29 * __pyx_v_vertices.strides[0]) ) + __pyx_t_30 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0818:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_31 = __pyx_v_i;
    __pyx_t_32 = 2;
    __pyx_t_33 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_31 * __pyx_v_simplices.strides[0]) ) + __pyx_t_32 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_34 = 1;
    __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_33 * __pyx_v_vertices.strides[0]) ) + __pyx_t_34 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0819:     <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_35 = __pyx_v_i;
    __pyx_t_36 = 2;
    __pyx_t_37 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_35 * __pyx_v_simplices.strides[0]) ) + __pyx_t_36 * __pyx_v_simplices.strides[1]) )));
    __pyx_t_38 = 2;
    __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_37 * __pyx_v_vertices.strides[0]) ) + __pyx_t_38 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0820:     <span class="k">if</span> <span class="n">is_intersecting_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">tri</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_39 = (__pyx_f_3rbf_8geometry_is_intersecting_3d(__pyx_v_seg, __pyx_v_tri) != 0);
    if (__pyx_t_39) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0821:       <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class='cython line score-0'>&#xA0;0822:       <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0823:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>      __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0824:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0825:       <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0826:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>      __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0827:                <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0828:       <span class="c"># t is a scalar between 0 and 1. If t=0 then the intersection is </span></pre>
<pre class='cython line score-0'>&#xA0;0829:       <span class="c"># at seg1.a and if t=1 then the intersection is at seg1.b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0830:       <span class="n">t</span> <span class="o">=</span> <span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_t = (__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0831:       <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">closest</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_39 = ((__pyx_v_t &lt; __pyx_v_closest) != 0);
      if (__pyx_t_39) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0832:         <span class="n">closest</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0'>        __pyx_v_closest = __pyx_v_t;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0833:         <span class="n">out</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0'>        __pyx_v_out = __pyx_v_i;
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L5;
    }
    __pyx_L5:;
  }
</pre><pre class='cython line score-0'>&#xA0;0834: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0835:   <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_39 = ((__pyx_v_out == -1) != 0);
  if (__pyx_t_39) {
</pre><pre class='cython line score-0'>&#xA0;0836:     <span class="c"># out is -1 iff it has never been changed and no intersection was found</span></pre>
<pre class='cython line score-15' onclick='toggleDiv(this)'>+0837:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No intersection found for segment [[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">],[</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">]]&#39;</span> <span class="o">%</span></pre>
<pre class='cython code score-15'>    __pyx_t_45 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_No_intersection_found_for_segmen_2, __pyx_t_46);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_46); __pyx_t_46 = 0;
    __pyx_t_46 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_45);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 0, __pyx_t_45);
    __pyx_t_45 = 0;
    __pyx_t_45 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_t_46, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_46); __pyx_t_46 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_45, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_45); __pyx_t_45 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-41' onclick='toggleDiv(this)'>+0838:                      <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="p">))</span></pre>
<pre class='cython code score-41'>    __pyx_t_40 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.x);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
    __pyx_t_41 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.y);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
    __pyx_t_42 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.a.z);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
    __pyx_t_43 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.x);<span class='error_goto'> if (unlikely(!__pyx_t_43)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_43);
    __pyx_t_44 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.y);<span class='error_goto'> if (unlikely(!__pyx_t_44)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_44);
    __pyx_t_45 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_seg.b.z);<span class='error_goto'> if (unlikely(!__pyx_t_45)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
    __pyx_t_46 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_46);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 0, __pyx_t_40);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_41);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 1, __pyx_t_41);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_42);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 2, __pyx_t_42);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_43);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 3, __pyx_t_43);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_44);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 4, __pyx_t_44);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_45);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_46, 5, __pyx_t_45);
    __pyx_t_40 = 0;
    __pyx_t_41 = 0;
    __pyx_t_42 = 0;
    __pyx_t_43 = 0;
    __pyx_t_44 = 0;
    __pyx_t_45 = 0;
</pre><pre class='cython line score-0'>&#xA0;0839: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0840:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0841: </pre>
<pre class='cython line score-0'>&#xA0;0842: </pre>
<pre class='cython line score-0'>&#xA0;0843: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0844: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0845: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">intersection_point_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_intersection_point_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0846:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0847:                                       <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0848:                                       <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0849:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0850: <span class="sd">  Returns the intersection points between the line segments,</span></pre>
<pre class='cython line score-0'>&#xA0;0851: <span class="sd">  described by start_pnts and end_pnts, and the simplices</span></pre>
<pre class='cython line score-0'>&#xA0;0852: </pre>
<pre class='cython line score-0'>&#xA0;0853: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0854: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0855: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0856: </pre>
<pre class='cython line score-0'>&#xA0;0857: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0858:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0859:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0860:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-44' onclick='toggleDiv(this)'>+0861:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 861; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0862:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class='cython line score-0'>&#xA0;0863:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0864: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0865:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0866:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0867:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0868:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0869:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0870:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0871:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_18 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_19 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0872:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_intersection_point_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_20 = __pyx_f_3rbf_8geometry__intersection_point_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 872; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_vec = __pyx_t_20;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0873:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.x;
    __pyx_t_22 = __pyx_v_i;
    __pyx_t_23 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_22 * __pyx_v_out.strides[0]) ) + __pyx_t_23 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0874:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.y;
    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_24 * __pyx_v_out.strides[0]) ) + __pyx_t_25 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0875:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.z;
    __pyx_t_26 = __pyx_v_i;
    __pyx_t_27 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_26 * __pyx_v_out.strides[0]) ) + __pyx_t_27 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
  }
</pre><pre class='cython line score-0'>&#xA0;0876: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0877:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 877; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0878: </pre>
<pre class='cython line score-0'>&#xA0;0879: </pre>
<pre class='cython line score-0'>&#xA0;0880: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0881: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0882: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+0883: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_intersection_point_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2'>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__intersection_point_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj1;
  double __pyx_v_proj2;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_out;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersection_point_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._intersection_point_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0884:                                      <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0885:                                      <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0886:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0887:     <span class="n">double</span> <span class="n">proj1</span><span class="p">,</span><span class="n">proj2</span></pre>
<pre class='cython line score-0'>&#xA0;0888:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class='cython line score-0'>&#xA0;0889:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0890:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class='cython line score-0'>&#xA0;0891:     <span class="n">vector3d</span> <span class="n">out</span></pre>
<pre class='cython line score-0'>&#xA0;0892: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0893:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0894:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_idx;
  __pyx_t_2 = 0;
  __pyx_t_3 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_1 * __pyx_v_simplices.strides[0]) ) + __pyx_t_2 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_4 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_3 * __pyx_v_vertices.strides[0]) ) + __pyx_t_4 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0895:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = __pyx_v_idx;
  __pyx_t_6 = 0;
  __pyx_t_7 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_5 * __pyx_v_simplices.strides[0]) ) + __pyx_t_6 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_8 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_7 * __pyx_v_vertices.strides[0]) ) + __pyx_t_8 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0896:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = __pyx_v_idx;
  __pyx_t_10 = 0;
  __pyx_t_11 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_9 * __pyx_v_simplices.strides[0]) ) + __pyx_t_10 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_12 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_11 * __pyx_v_vertices.strides[0]) ) + __pyx_t_12 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0897:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_idx;
  __pyx_t_14 = 1;
  __pyx_t_15 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_13 * __pyx_v_simplices.strides[0]) ) + __pyx_t_14 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_16 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_15 * __pyx_v_vertices.strides[0]) ) + __pyx_t_16 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0898:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_17 = __pyx_v_idx;
  __pyx_t_18 = 1;
  __pyx_t_19 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_17 * __pyx_v_simplices.strides[0]) ) + __pyx_t_18 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_20 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_19 * __pyx_v_vertices.strides[0]) ) + __pyx_t_20 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0899:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_21 = __pyx_v_idx;
  __pyx_t_22 = 1;
  __pyx_t_23 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_21 * __pyx_v_simplices.strides[0]) ) + __pyx_t_22 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_24 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_23 * __pyx_v_vertices.strides[0]) ) + __pyx_t_24 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0900:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_25 = __pyx_v_idx;
  __pyx_t_26 = 2;
  __pyx_t_27 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_25 * __pyx_v_simplices.strides[0]) ) + __pyx_t_26 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_28 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_27 * __pyx_v_vertices.strides[0]) ) + __pyx_t_28 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0901:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_29 = __pyx_v_idx;
  __pyx_t_30 = 2;
  __pyx_t_31 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_29 * __pyx_v_simplices.strides[0]) ) + __pyx_t_30 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_32 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_31 * __pyx_v_vertices.strides[0]) ) + __pyx_t_32 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0902:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_33 = __pyx_v_idx;
  __pyx_t_34 = 2;
  __pyx_t_35 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_33 * __pyx_v_simplices.strides[0]) ) + __pyx_t_34 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_36 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_35 * __pyx_v_vertices.strides[0]) ) + __pyx_t_36 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0'>&#xA0;0903: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0904:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class='cython line score-0'>&#xA0;0905: </pre>
<pre class='cython line score-0'>&#xA0;0906:   <span class="n">proj1</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0907:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj1 = ((((__pyx_v_seg.a.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.a.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.a.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0908:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0909:   <span class="n">proj2</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0910:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj2 = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0911:            <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0912: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0913:   <span class="n">out</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.x = (__pyx_v_seg.a.x + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.x - __pyx_v_seg.a.x)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0914:   <span class="n">out</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.y = (__pyx_v_seg.a.y + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.y - __pyx_v_seg.a.y)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0915:   <span class="n">out</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="n">proj1</span><span class="o">/</span><span class="p">(</span><span class="n">proj1</span><span class="o">-</span><span class="n">proj2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_out.z = (__pyx_v_seg.a.z + ((__pyx_v_proj1 / (__pyx_v_proj1 - __pyx_v_proj2)) * (__pyx_v_seg.b.z - __pyx_v_seg.a.z)));
</pre><pre class='cython line score-0'>&#xA0;0916: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0917:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0918: </pre>
<pre class='cython line score-0'>&#xA0;0919: </pre>
<pre class='cython line score-0'>&#xA0;0920: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0921: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+0922: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">cross_normals_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">start_pnts</span><span class="p">,</span></pre>
<pre class='cython code score-7'>static PyArrayObject *__pyx_f_3rbf_8geometry_cross_normals_3d(__Pyx_memviewslice __pyx_v_start_pnts, __Pyx_memviewslice __pyx_v_end_pnts, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_vec;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_normals_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.cross_normals_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0923:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">end_pnts</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0924:                                  <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0925:                                  <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;0926:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;0927: <span class="sd">  Returns the normal vectors to the simplices intersected by </span></pre>
<pre class='cython line score-0'>&#xA0;0928: <span class="sd">  start_pnts and end_pnts</span></pre>
<pre class='cython line score-0'>&#xA0;0929: </pre>
<pre class='cython line score-0'>&#xA0;0930: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;0931: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;0932: <span class="sd">    if there is no intersection then a ValueError is returned.</span></pre>
<pre class='cython line score-0'>&#xA0;0933: </pre>
<pre class='cython line score-0'>&#xA0;0934: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0935: </pre>
<pre class='cython line score-0'>&#xA0;0936:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0937:     <span class="nb">int</span> <span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0938:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_start_pnts.shape[0]);
</pre><pre class='cython line score-44' onclick='toggleDiv(this)'>+0939:     <span class="n">double</span><span class="p">[:,:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-44'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;0940:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;0941:     <span class="n">vector3d</span> <span class="n">vec</span></pre>
<pre class='cython line score-0'>&#xA0;0942: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0943:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0944:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_v_seg.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_8 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_9 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0945:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = 1;
    __pyx_v_seg.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_10 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_11 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0946:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">start_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 2;
    __pyx_v_seg.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_start_pnts.data + __pyx_t_12 * __pyx_v_start_pnts.strides[0]) ) + __pyx_t_13 * __pyx_v_start_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0947:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_14 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_15 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0948:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_16 = __pyx_v_i;
    __pyx_t_17 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_16 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_17 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0949:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">end_pnts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_18 = __pyx_v_i;
    __pyx_t_19 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_end_pnts.data + __pyx_t_18 * __pyx_v_end_pnts.strides[0]) ) + __pyx_t_19 * __pyx_v_end_pnts.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0950:     <span class="n">vec</span> <span class="o">=</span> <span class="n">_cross_normals_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_t_20 = __pyx_f_3rbf_8geometry__cross_normals_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_vec = __pyx_t_20;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0951:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.x;
    __pyx_t_22 = __pyx_v_i;
    __pyx_t_23 = 0;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_22 * __pyx_v_out.strides[0]) ) + __pyx_t_23 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0952:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.y;
    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = 1;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_24 * __pyx_v_out.strides[0]) ) + __pyx_t_25 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0953:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_21 = __pyx_v_vec.z;
    __pyx_t_26 = __pyx_v_i;
    __pyx_t_27 = 2;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_26 * __pyx_v_out.strides[0]) ) + __pyx_t_27 * __pyx_v_out.strides[1]) )) = __pyx_t_21;
  }
</pre><pre class='cython line score-0'>&#xA0;0954: </pre>
<pre class='cython line score-32' onclick='toggleDiv(this)'>+0955:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_out, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0956: </pre>
<pre class='cython line score-0'>&#xA0;0957: </pre>
<pre class='cython line score-0'>&#xA0;0958: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0959: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0960: <span class="nd">@cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+0961: <span class="k">cdef</span> <span class="kt">vector3d</span> <span class="nf">_cross_normals_3d</span><span class="p">(</span><span class="n">segment3d</span> <span class="n">seg</span><span class="p">,</span></pre>
<pre class='cython code score-2'>static struct __pyx_t_3rbf_8geometry_vector3d __pyx_f_3rbf_8geometry__cross_normals_3d(struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  double __pyx_v_proj;
  double __pyx_v_mag;
  int __pyx_v_idx;
  struct __pyx_t_3rbf_8geometry_triangle3d __pyx_v_tri;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_n;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cross_normals_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry._cross_normals_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0962:                                 <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0963:                                 <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0964:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0965:     <span class="n">double</span> <span class="n">proj</span><span class="p">,</span><span class="n">mag</span></pre>
<pre class='cython line score-0'>&#xA0;0966:     <span class="nb">int</span> <span class="n">idx</span></pre>
<pre class='cython line score-0'>&#xA0;0967:     <span class="n">triangle3d</span> <span class="n">tri</span></pre>
<pre class='cython line score-0'>&#xA0;0968:     <span class="n">vector3d</span> <span class="n">n</span></pre>
<pre class='cython line score-0'>&#xA0;0969: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0970:   <span class="n">idx</span> <span class="o">=</span> <span class="n">_intersection_index_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_3rbf_8geometry__intersection_index_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);<span class='error_goto'> if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_idx = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0971:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_idx;
  __pyx_t_2 = 0;
  __pyx_t_3 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_1 * __pyx_v_simplices.strides[0]) ) + __pyx_t_2 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_4 = 0;
  __pyx_v_tri.a.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_3 * __pyx_v_vertices.strides[0]) ) + __pyx_t_4 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0972:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = __pyx_v_idx;
  __pyx_t_6 = 0;
  __pyx_t_7 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_5 * __pyx_v_simplices.strides[0]) ) + __pyx_t_6 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_8 = 1;
  __pyx_v_tri.a.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_7 * __pyx_v_vertices.strides[0]) ) + __pyx_t_8 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0973:   <span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = __pyx_v_idx;
  __pyx_t_10 = 0;
  __pyx_t_11 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_9 * __pyx_v_simplices.strides[0]) ) + __pyx_t_10 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_12 = 2;
  __pyx_v_tri.a.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_11 * __pyx_v_vertices.strides[0]) ) + __pyx_t_12 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0974:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_13 = __pyx_v_idx;
  __pyx_t_14 = 1;
  __pyx_t_15 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_13 * __pyx_v_simplices.strides[0]) ) + __pyx_t_14 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_16 = 0;
  __pyx_v_tri.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_15 * __pyx_v_vertices.strides[0]) ) + __pyx_t_16 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0975:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_17 = __pyx_v_idx;
  __pyx_t_18 = 1;
  __pyx_t_19 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_17 * __pyx_v_simplices.strides[0]) ) + __pyx_t_18 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_20 = 1;
  __pyx_v_tri.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_19 * __pyx_v_vertices.strides[0]) ) + __pyx_t_20 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0976:   <span class="n">tri</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_21 = __pyx_v_idx;
  __pyx_t_22 = 1;
  __pyx_t_23 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_21 * __pyx_v_simplices.strides[0]) ) + __pyx_t_22 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_24 = 2;
  __pyx_v_tri.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_23 * __pyx_v_vertices.strides[0]) ) + __pyx_t_24 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0977:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_25 = __pyx_v_idx;
  __pyx_t_26 = 2;
  __pyx_t_27 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_25 * __pyx_v_simplices.strides[0]) ) + __pyx_t_26 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_28 = 0;
  __pyx_v_tri.c.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_27 * __pyx_v_vertices.strides[0]) ) + __pyx_t_28 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0978:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_29 = __pyx_v_idx;
  __pyx_t_30 = 2;
  __pyx_t_31 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_29 * __pyx_v_simplices.strides[0]) ) + __pyx_t_30 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_32 = 1;
  __pyx_v_tri.c.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_31 * __pyx_v_vertices.strides[0]) ) + __pyx_t_32 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0979:   <span class="n">tri</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_33 = __pyx_v_idx;
  __pyx_t_34 = 2;
  __pyx_t_35 = (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_simplices.data + __pyx_t_33 * __pyx_v_simplices.strides[0]) ) + __pyx_t_34 * __pyx_v_simplices.strides[1]) )));
  __pyx_t_36 = 2;
  __pyx_v_tri.c.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vertices.data + __pyx_t_35 * __pyx_v_vertices.strides[0]) ) + __pyx_t_36 * __pyx_v_vertices.strides[1]) )));
</pre><pre class='cython line score-0'>&#xA0;0980: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0981:   <span class="n">n</span> <span class="o">=</span> <span class="n">triangle_normal_3d</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_n = __pyx_f_3rbf_8geometry_triangle_normal_3d(__pyx_v_tri);
</pre><pre class='cython line score-0'>&#xA0;0982: </pre>
<pre class='cython line score-0'>&#xA0;0983:   <span class="n">proj</span> <span class="o">=</span> <span class="p">((</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0984:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span></pre>
<pre class='cython code score-0'>  __pyx_v_proj = ((((__pyx_v_seg.b.x - __pyx_v_tri.a.x) * __pyx_v_n.x) + ((__pyx_v_seg.b.y - __pyx_v_tri.a.y) * __pyx_v_n.y)) + ((__pyx_v_seg.b.z - __pyx_v_tri.a.z) * __pyx_v_n.z));
</pre><pre class='cython line score-0'>&#xA0;0985:           <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span><span class="o">-</span><span class="n">tri</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0986: </pre>
<pre class='cython line score-0'>&#xA0;0987:   <span class="c"># ensures that normal points in the direction of the segment</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0988:   <span class="k">if</span> <span class="n">proj</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_37 = ((__pyx_v_proj &lt; 0.0) != 0);
  if (__pyx_t_37) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0989:     <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_n.x = (__pyx_v_n.x * -1.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0990:     <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_n.y = (__pyx_v_n.y * -1.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0991:     <span class="n">n</span><span class="o">.</span><span class="n">z</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_n.z = (__pyx_v_n.z * -1.0);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;0992: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0993:   <span class="n">mag</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_mag = sqrt(((pow(__pyx_v_n.x, 2.0) + pow(__pyx_v_n.y, 2.0)) + pow(__pyx_v_n.z, 2.0)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0994:   <span class="n">n</span><span class="o">.</span><span class="n">x</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0'>  __pyx_v_n.x = (__pyx_v_n.x / __pyx_v_mag);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0995:   <span class="n">n</span><span class="o">.</span><span class="n">y</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0'>  __pyx_v_n.y = (__pyx_v_n.y / __pyx_v_mag);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0996:   <span class="n">n</span><span class="o">.</span><span class="n">z</span> <span class="o">/=</span> <span class="n">mag</span></pre>
<pre class='cython code score-0'>  __pyx_v_n.z = (__pyx_v_n.z / __pyx_v_mag);
</pre><pre class='cython line score-0'>&#xA0;0997: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0998:   <span class="k">return</span> <span class="n">n</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_n;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0999: </pre>
<pre class='cython line score-0'>&#xA0;1000: </pre>
<pre class='cython line score-0'>&#xA0;1001: <span class="nd">@boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;1002: <span class="nd">@wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+1003: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">contains_3d</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">pnt</span><span class="p">,</span></pre>
<pre class='cython code score-6'>static PyArrayObject *__pyx_f_3rbf_8geometry_contains_3d(__Pyx_memviewslice __pyx_v_pnt, __Pyx_memviewslice __pyx_v_vertices, __Pyx_memviewslice __pyx_v_simplices) {
  int __pyx_v_count;
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_out = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_3rbf_8geometry_segment3d __pyx_v_seg;
  struct __pyx_t_3rbf_8geometry_vector3d __pyx_v_outside_pnt;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains_3d", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains_3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;1004:                             <span class="n">double</span><span class="p">[:,:]</span> <span class="n">vertices</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1005:                             <span class="nb">long</span><span class="p">[:,:]</span> <span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython line score-0'>&#xA0;1006:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1007: <span class="sd">  Returns a boolean array identifying whether the points are contained </span></pre>
<pre class='cython line score-0'>&#xA0;1008: <span class="sd">  within the closed simplicial complex described by vertices and </span></pre>
<pre class='cython line score-0'>&#xA0;1009: <span class="sd">  simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1010: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;1011:   <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1012:     <span class="nb">int</span> <span class="n">count</span><span class="p">,</span><span class="n">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1013:     <span class="nb">int</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pnt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_N = (__pyx_v_pnt.shape[0]);
</pre><pre class='cython line score-42' onclick='toggleDiv(this)'>+1014:     <span class="nb">long</span><span class="p">[:]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-42'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_c) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1014; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='cython line score-0'>&#xA0;1015:     <span class="n">segment3d</span> <span class="n">seg</span></pre>
<pre class='cython line score-0'>&#xA0;1016:     <span class="n">vector3d</span> <span class="n">outside_pnt</span></pre>
<pre class='cython line score-0'>&#xA0;1017: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1018:   <span class="n">outside_pnt</span> <span class="o">=</span> <span class="n">find_outside_3d</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_outside_pnt = __pyx_f_3rbf_8geometry_find_outside_3d(__pyx_v_vertices);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1019:   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1020:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">x</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_outside_pnt.x;
    __pyx_v_seg.a.x = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1021:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_outside_pnt.y;
    __pyx_v_seg.a.y = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1022:     <span class="n">seg</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">outside_pnt</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0'>    __pyx_t_8 = __pyx_v_outside_pnt.z;
    __pyx_v_seg.a.z = __pyx_t_8;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1023:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_v_seg.b.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_9 * __pyx_v_pnt.strides[0]) ) + __pyx_t_10 * __pyx_v_pnt.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1024:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_v_seg.b.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_11 * __pyx_v_pnt.strides[0]) ) + __pyx_t_12 * __pyx_v_pnt.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1025:     <span class="n">seg</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">pnt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    __pyx_v_seg.b.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pnt.data + __pyx_t_13 * __pyx_v_pnt.strides[0]) ) + __pyx_t_14 * __pyx_v_pnt.strides[1]) )));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1026:     <span class="n">count</span> <span class="o">=</span> <span class="n">_intersection_count_3d</span><span class="p">(</span><span class="n">seg</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_count = __pyx_f_3rbf_8geometry__intersection_count_3d(__pyx_v_seg, __pyx_v_vertices, __pyx_v_simplices);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1027:     <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span><span class="o">%</span><span class="mf">2</span></pre>
<pre class='cython code score-0'>    __pyx_t_15 = __pyx_v_i;
    *((long *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_15 * __pyx_v_out.strides[0]) )) = __Pyx_mod_long(__pyx_v_count, 2);
  }
</pre><pre class='cython line score-0'>&#xA0;1028: </pre>
<pre class='cython line score-29' onclick='toggleDiv(this)'>+1029:   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-29'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_out, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1029; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1030: </pre>
<pre class='cython line score-0'>&#xA0;1031: <span class="c">## end-user functions</span></pre>
<pre class='cython line score-0'>&#xA0;1032: <span class="c">#####################################################################</span></pre>
<pre class='cython line score-79' onclick='toggleDiv(this)'>+1033: <span class="k">def</span> <span class="nf">intersection_point</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-79'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_1intersection_point(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_intersection_point[] = " \n  Returns the intersection points between the line segments, described \n  by start_points and end_points, and the simplicial complex, \n  described by vertices and simplices. This function works for 1, 2, \n  and 3 spatial dimensions. \n\n  Parameters\n  ----------\n    start_points : (N,D) array\n      Vertices describing one end of the line segments. N is the \n      number of line segments\n\n    end_points : (N,D) array \n      Vertices describing the other end of the line segments. N is the \n      number of line segments\n\n    vertices : (M,D) array \n      Vertices within the simplicial complex. M is the number of \n      vertices\n\n    simplices : (P,D) array\n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (N,D) array\n      intersection points    \n\n  Note\n  ----\n    This function fails when a intersection is not found for a line \n    segment. If there are multiple intersections then the intersection \n    closest to start_point is used.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_1intersection_point = {"intersection_point", (PyCFunction)__pyx_pw_3rbf_8geometry_1intersection_point, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_intersection_point};
static PyObject *__pyx_pw_3rbf_8geometry_1intersection_point(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_point") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_point", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_intersection_point(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_intersection_point(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_point", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_point", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__58 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_crossed_idx, __pyx_n_s_vert, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__58)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__58);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__58);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_1intersection_point, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_point, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__59 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__58, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_intersection_point, 1033, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__59)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1033; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1034:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1035: <span class="sd">  Returns the intersection points between the line segments, described </span></pre>
<pre class='cython line score-0'>&#xA0;1036: <span class="sd">  by start_points and end_points, and the simplicial complex, </span></pre>
<pre class='cython line score-0'>&#xA0;1037: <span class="sd">  described by vertices and simplices. This function works for 1, 2, </span></pre>
<pre class='cython line score-0'>&#xA0;1038: <span class="sd">  and 3 spatial dimensions. </span></pre>
<pre class='cython line score-0'>&#xA0;1039: </pre>
<pre class='cython line score-0'>&#xA0;1040: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1041: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1042: <span class="sd">    start_points : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1043: <span class="sd">      Vertices describing one end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1044: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1045: </pre>
<pre class='cython line score-0'>&#xA0;1046: <span class="sd">    end_points : (N,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1047: <span class="sd">      Vertices describing the other end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1048: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1049: </pre>
<pre class='cython line score-0'>&#xA0;1050: <span class="sd">    vertices : (M,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1051: <span class="sd">      Vertices within the simplicial complex. M is the number of </span></pre>
<pre class='cython line score-0'>&#xA0;1052: <span class="sd">      vertices</span></pre>
<pre class='cython line score-0'>&#xA0;1053: </pre>
<pre class='cython line score-0'>&#xA0;1054: <span class="sd">    simplices : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1055: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1056: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1057: </pre>
<pre class='cython line score-0'>&#xA0;1058: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1059: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1060: <span class="sd">    out : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1061: <span class="sd">      intersection points    </span></pre>
<pre class='cython line score-0'>&#xA0;1062: </pre>
<pre class='cython line score-0'>&#xA0;1063: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1064: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1065: <span class="sd">    This function fails when a intersection is not found for a line </span></pre>
<pre class='cython line score-0'>&#xA0;1066: <span class="sd">    segment. If there are multiple intersections then the intersection </span></pre>
<pre class='cython line score-0'>&#xA0;1067: <span class="sd">    closest to start_point is used.</span></pre>
<pre class='cython line score-0'>&#xA0;1068: </pre>
<pre class='cython line score-0'>&#xA0;1069: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1070:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1070; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1071:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1071; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1072:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1073:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+1074:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1074; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1075:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class='cython line score-0'>&#xA0;1076: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1077:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1078:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class='cython line score-0'>&#xA0;1079: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1080:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1081:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class='cython line score-0'>&#xA0;1082: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1083:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1084:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1085:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_intersection_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_v_start_points);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, __pyx_v_end_points);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_7, __pyx_v_vertices);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3+__pyx_t_7, __pyx_v_simplices);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_idx = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+1086:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21'>  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
/* … */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__5);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__4, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1086; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1087:     <span class="n">out</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-5'>    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1087; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_out = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;1088: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1089:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1089; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1089; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1090:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_point_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_point_2d(__pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1090; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;1091: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1092:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1092; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1093:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_point_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_point_3d(__pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1093; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;1094: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+1095:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1096: </pre>
<pre class='cython line score-0'>&#xA0;1097: </pre>
<pre class='cython line score-80' onclick='toggleDiv(this)'>+1098: <span class="k">def</span> <span class="nf">intersection_normal</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-80'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_3intersection_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_2intersection_normal[] = " \n  Returns the normal vectors to the simplices intersected by the line \n  segments, described by start_points and end_points. This function \n  works for 1, 2, and 3 spatial dimensions. The normal vector is in \n  the direction that points towards end_points\n\n  Parameters\n  ----------\n    start_points : (N,D) array\n      Vertices describing one end of the line segments. N is the \n      number of line segments\n\n    end_points : (N,D) array \n      Vertices describing the other end of the line segments. N is the \n      number of line segments\n\n    vertices : (M,D) array \n      Vertices within the simplicial complex. M is the number of \n      vertices\n\n    simplices : (P,D) array\n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (N,D) array\n      normal vectors\n\n  Note\n  ----\n    This function fails when a intersection is not found for a line \n    segment. If there are multiple intersections then the intersection \n    closest to start_point is used.\n\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_3intersection_normal = {"intersection_normal", (PyCFunction)__pyx_pw_3rbf_8geometry_3intersection_normal, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_2intersection_normal};
static PyObject *__pyx_pw_3rbf_8geometry_3intersection_normal(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_normal") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_normal", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_2intersection_normal(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_2intersection_normal(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_vert = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_normal", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_normal", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__60 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_crossed_idx, __pyx_n_s_vert, __pyx_n_s_crossed_vert);<span class='error_goto'> if (unlikely(!__pyx_tuple__60)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__60);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_3intersection_normal, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_normal, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__61 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_intersection_normal, 1098, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__61)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1098; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1099:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1100: <span class="sd">  Returns the normal vectors to the simplices intersected by the line </span></pre>
<pre class='cython line score-0'>&#xA0;1101: <span class="sd">  segments, described by start_points and end_points. This function </span></pre>
<pre class='cython line score-0'>&#xA0;1102: <span class="sd">  works for 1, 2, and 3 spatial dimensions. The normal vector is in </span></pre>
<pre class='cython line score-0'>&#xA0;1103: <span class="sd">  the direction that points towards end_points</span></pre>
<pre class='cython line score-0'>&#xA0;1104: </pre>
<pre class='cython line score-0'>&#xA0;1105: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1106: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1107: <span class="sd">    start_points : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1108: <span class="sd">      Vertices describing one end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1109: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1110: </pre>
<pre class='cython line score-0'>&#xA0;1111: <span class="sd">    end_points : (N,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1112: <span class="sd">      Vertices describing the other end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1113: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1114: </pre>
<pre class='cython line score-0'>&#xA0;1115: <span class="sd">    vertices : (M,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1116: <span class="sd">      Vertices within the simplicial complex. M is the number of </span></pre>
<pre class='cython line score-0'>&#xA0;1117: <span class="sd">      vertices</span></pre>
<pre class='cython line score-0'>&#xA0;1118: </pre>
<pre class='cython line score-0'>&#xA0;1119: <span class="sd">    simplices : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1120: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1121: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1122: </pre>
<pre class='cython line score-0'>&#xA0;1123: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1124: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1125: <span class="sd">    out : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1126: <span class="sd">      normal vectors</span></pre>
<pre class='cython line score-0'>&#xA0;1127: </pre>
<pre class='cython line score-0'>&#xA0;1128: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1129: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1130: <span class="sd">    This function fails when a intersection is not found for a line </span></pre>
<pre class='cython line score-0'>&#xA0;1131: <span class="sd">    segment. If there are multiple intersections then the intersection </span></pre>
<pre class='cython line score-0'>&#xA0;1132: <span class="sd">    closest to start_point is used.</span></pre>
<pre class='cython line score-0'>&#xA0;1133: </pre>
<pre class='cython line score-0'>&#xA0;1134: </pre>
<pre class='cython line score-0'>&#xA0;1135: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1136:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1137:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1138:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1139:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+1140:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1141:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class='cython line score-0'>&#xA0;1142: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1143:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1144:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class='cython line score-0'>&#xA0;1145: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1146:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1147:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='cython line score-0'>&#xA0;1148: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1149:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1149; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1150:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1151:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1152:     <span class="n">crossed_idx</span> <span class="o">=</span> <span class="n">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_intersection_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_7, __pyx_v_start_points);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_7, __pyx_v_end_points);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2+__pyx_t_7, __pyx_v_vertices);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3+__pyx_t_7, __pyx_v_simplices);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_idx = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+1153:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21'>  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__10);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_vert = __pyx_t_3;
    __pyx_t_3 = 0;
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__9, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1154:     <span class="n">crossed_vert</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-5'>    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_crossed_idx);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_v_crossed_vert = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1155:     <span class="n">out</span><span class="p">[</span><span class="n">crossed_vert</span> <span class="o">&lt;</span> <span class="n">start_points</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-11'>    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_crossed_vert, __pyx_v_start_points, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_3, __pyx_float_neg_1_0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;1156: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1157:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1157; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1158:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_normals_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_normals_2d(__pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;1159: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1160:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1160; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1161:     <span class="n">out</span> <span class="o">=</span> <span class="n">cross_normals_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = ((PyObject *)__pyx_f_3rbf_8geometry_cross_normals_3d(__pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1161; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;1162: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+1163:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1164: </pre>
<pre class='cython line score-0'>&#xA0;1165: </pre>
<pre class='cython line score-88' onclick='toggleDiv(this)'>+1166: <span class="k">def</span> <span class="nf">intersection_index</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-88'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_5intersection_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_4intersection_index[] = " \n  Returns the indices of the simplices intersected by the line\n  segments. This function works for 1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    start_points : (N,D) array\n      Vertices describing one end of the line segments. N is the \n      number of line segments\n\n    end_points : (N,D) array \n      Vertices describing the other end of the line segments. N is the \n      number of line segments\n\n    vertices : (M,D) array \n      Vertices within the simplicial complex. M is the number of \n      vertices\n\n    simplices : (P,D) array\n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (N,) int array\n      simplex indices \n\n  Note\n  ----\n    This function fails when a intersection is not found for a line\n    segment. If there are multiple intersections then the intersection \n    closest to start_point is used.\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_5intersection_index = {"intersection_index", (PyCFunction)__pyx_pw_3rbf_8geometry_5intersection_index, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_4intersection_index};
static PyObject *__pyx_pw_3rbf_8geometry_5intersection_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_index") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_index", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_4intersection_index(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_4intersection_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_proj1 = NULL;
  PyObject *__pyx_v_proj2 = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_crossed_idx = NULL;
  PyObject *__pyx_v_proj1i = NULL;
  PyObject *__pyx_v_proj2i = NULL;
  PyObject *__pyx_v_idx = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_index", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj1i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_proj2i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__62 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_out, __pyx_n_s_vert, __pyx_n_s_proj1, __pyx_n_s_proj2, __pyx_n_s_crossed_bool, __pyx_n_s_i, __pyx_n_s_crossed_idx, __pyx_n_s_proj1i, __pyx_n_s_proj2i, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_tuple__62)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__62);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__62);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_5intersection_index, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_index, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__63 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__62, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_intersection_index, 1166, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__63)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1167:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1168: <span class="sd">  Returns the indices of the simplices intersected by the line</span></pre>
<pre class='cython line score-0'>&#xA0;1169: <span class="sd">  segments. This function works for 1, 2, and 3 spatial dimensions.</span></pre>
<pre class='cython line score-0'>&#xA0;1170: </pre>
<pre class='cython line score-0'>&#xA0;1171: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1172: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1173: <span class="sd">    start_points : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1174: <span class="sd">      Vertices describing one end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1175: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1176: </pre>
<pre class='cython line score-0'>&#xA0;1177: <span class="sd">    end_points : (N,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1178: <span class="sd">      Vertices describing the other end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1179: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1180: </pre>
<pre class='cython line score-0'>&#xA0;1181: <span class="sd">    vertices : (M,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1182: <span class="sd">      Vertices within the simplicial complex. M is the number of </span></pre>
<pre class='cython line score-0'>&#xA0;1183: <span class="sd">      vertices</span></pre>
<pre class='cython line score-0'>&#xA0;1184: </pre>
<pre class='cython line score-0'>&#xA0;1185: <span class="sd">    simplices : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1186: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1187: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1188: </pre>
<pre class='cython line score-0'>&#xA0;1189: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1190: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1191: <span class="sd">    out : (N,) int array</span></pre>
<pre class='cython line score-0'>&#xA0;1192: <span class="sd">      simplex indices </span></pre>
<pre class='cython line score-0'>&#xA0;1193: </pre>
<pre class='cython line score-0'>&#xA0;1194: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1195: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1196: <span class="sd">    This function fails when a intersection is not found for a line</span></pre>
<pre class='cython line score-0'>&#xA0;1197: <span class="sd">    segment. If there are multiple intersections then the intersection </span></pre>
<pre class='cython line score-0'>&#xA0;1198: <span class="sd">    closest to start_point is used.</span></pre>
<pre class='cython line score-0'>&#xA0;1199: </pre>
<pre class='cython line score-0'>&#xA0;1200: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1201:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1202:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1202; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1203:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1204:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+1205:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1206:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimesions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimesions);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class='cython line score-0'>&#xA0;1207: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1208:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1209:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class='cython line score-0'>&#xA0;1210: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1211:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1212:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1212; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class='cython line score-0'>&#xA0;1213: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1214:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1214; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1215:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+1216:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-31'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+1217:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21'>  __pyx_slice__14 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__15);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_vert = __pyx_t_2;
    __pyx_t_2 = 0;
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__14, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1217; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1218:     <span class="n">proj1</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_proj1 = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1219:     <span class="n">proj2</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_proj2 = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1220:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="n">proj1</span><span class="o">*</span><span class="n">proj2</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-11'>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_proj1, __pyx_v_proj2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1220; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_crossed_bool = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-61' onclick='toggleDiv(this)'>+1221:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-61'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      __pyx_t_4 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_8(__pyx_t_4);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
      __pyx_t_2 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;1222:       <span class="c"># indices of all simplices crossed for segment i</span></pre>
<pre class='cython line score-78' onclick='toggleDiv(this)'>+1223:       <span class="n">crossed_idx</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-78'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crossed_bool, __pyx_v_i);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        PyObject* sequence = __pyx_t_2;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 1)) {
          if (size &gt; 1) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(1);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        } else {
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_11 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
        index = 0; __pyx_t_1 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_1)) goto __pyx_L9_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_10), 1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L10_unpacking_done;
        __pyx_L9_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L10_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_crossed_idx, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+1224:       <span class="n">proj1i</span> <span class="o">=</span> <span class="n">proj1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-16'>      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_idx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_crossed_idx);
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_proj1, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_proj1i, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+1225:       <span class="n">proj2i</span> <span class="o">=</span> <span class="n">proj2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">crossed_idx</span><span class="p">]</span></pre>
<pre class='cython code score-16'>      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_idx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_idx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_crossed_idx);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_proj2, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_proj2i, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1226:       <span class="c"># find the intersection closest to start_point i</span></pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+1227:       <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">proj1i</span><span class="o">/</span><span class="p">(</span><span class="n">proj1i</span><span class="o">-</span><span class="n">proj2i</span><span class="p">))</span></pre>
<pre class='cython code score-38'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_proj1i, __pyx_v_proj2i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_proj1i, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1227; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_idx, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1228:       <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">crossed_idx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-11'>      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crossed_idx, __pyx_v_idx);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_v_i, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1229: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1230:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1231:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_index_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_index_2d(__pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;1232: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1233:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1234:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_index_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_index_3d(__pyx_t_14, __pyx_t_13, __pyx_t_12, __pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;1235: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+1236:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1237: </pre>
<pre class='cython line score-0'>&#xA0;1238: </pre>
<pre class='cython line score-79' onclick='toggleDiv(this)'>+1239: <span class="k">def</span> <span class="nf">intersection_count</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-79'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_7intersection_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_6intersection_count[] = " \n  Returns the number of simplices crossed by the line segments \n  described by start_points and end_points. This function works for 1, \n  2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    start_points : (N,D) array\n      Vertices describing one end of the line segments. N is the \n      number of line segments\n\n    end_points : (N,D) array \n      Vertices describing the other end of the line segments. N is the \n      number of line segments\n\n    vertices : (M,D) array \n      Vertices within the simplicial complex. M is the number of \n      vertices\n\n    simplices : (P,D) array\n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (N,) int array\n      intersection counts\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_7intersection_count = {"intersection_count", (PyCFunction)__pyx_pw_3rbf_8geometry_7intersection_count, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_6intersection_count};
static PyObject *__pyx_pw_3rbf_8geometry_7intersection_count(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start_points = 0;
  PyObject *__pyx_v_end_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_points,&amp;__pyx_n_s_end_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersection_count") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_start_points = values[0];
    __pyx_v_end_points = values[1];
    __pyx_v_vertices = values[2];
    __pyx_v_simplices = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersection_count", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_6intersection_count(__pyx_self, __pyx_v_start_points, __pyx_v_end_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_6intersection_count(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_points, PyObject *__pyx_v_end_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersection_count", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.intersection_count", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__64 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_start_points, __pyx_n_s_end_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_crossed_bool, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__64)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__64);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__64);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_7intersection_count, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_intersection_count, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__65 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__64, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_intersection_count, 1239, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__65)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1240:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1241: <span class="sd">  Returns the number of simplices crossed by the line segments </span></pre>
<pre class='cython line score-0'>&#xA0;1242: <span class="sd">  described by start_points and end_points. This function works for 1, </span></pre>
<pre class='cython line score-0'>&#xA0;1243: <span class="sd">  2, and 3 spatial dimensions.</span></pre>
<pre class='cython line score-0'>&#xA0;1244: </pre>
<pre class='cython line score-0'>&#xA0;1245: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1246: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1247: <span class="sd">    start_points : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1248: <span class="sd">      Vertices describing one end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1249: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1250: </pre>
<pre class='cython line score-0'>&#xA0;1251: <span class="sd">    end_points : (N,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1252: <span class="sd">      Vertices describing the other end of the line segments. N is the </span></pre>
<pre class='cython line score-0'>&#xA0;1253: <span class="sd">      number of line segments</span></pre>
<pre class='cython line score-0'>&#xA0;1254: </pre>
<pre class='cython line score-0'>&#xA0;1255: <span class="sd">    vertices : (M,D) array </span></pre>
<pre class='cython line score-0'>&#xA0;1256: <span class="sd">      Vertices within the simplicial complex. M is the number of </span></pre>
<pre class='cython line score-0'>&#xA0;1257: <span class="sd">      vertices</span></pre>
<pre class='cython line score-0'>&#xA0;1258: </pre>
<pre class='cython line score-0'>&#xA0;1259: <span class="sd">    simplices : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1260: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1261: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1262: </pre>
<pre class='cython line score-0'>&#xA0;1263: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1264: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1265: <span class="sd">    out : (N,) int array</span></pre>
<pre class='cython line score-0'>&#xA0;1266: <span class="sd">      intersection counts</span></pre>
<pre class='cython line score-0'>&#xA0;1267: </pre>
<pre class='cython line score-0'>&#xA0;1268: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1269:   <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_start_points);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_start_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1270:   <span class="n">end_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_points</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_end_points);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_end_points, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1271:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_vertices);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1272:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_simplices);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+1273:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1274:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class='cython line score-0'>&#xA0;1275: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1276:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = ((!__pyx_t_6) != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1277:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class='cython line score-0'>&#xA0;1278: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1279:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">end_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_end_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1280:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;start points and end points must have the same length&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_start_points_and_end_points_must);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class='cython line score-0'>&#xA0;1281: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1282:   <span class="n">dim</span> <span class="o">=</span> <span class="n">start_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_start_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1283:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+1284:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21'>  __pyx_slice__19 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__19);
/* … */
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__20);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_vert = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__19, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+1285:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_start_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_crossed_bool = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+1286:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_crossed_bool);
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_out = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;1287: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1288:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1288; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1289:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_count_2d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_count_2d(__pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;1290: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1291:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+1292:     <span class="n">out</span> <span class="o">=</span> <span class="n">intersection_count_3d</span><span class="p">(</span><span class="n">start_points</span><span class="p">,</span><span class="n">end_points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_start_points);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_end_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = ((PyObject *)__pyx_f_3rbf_8geometry_intersection_count_3d(__pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_4);
    __pyx_t_4 = 0;
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;1293: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+1294:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1295: </pre>
<pre class='cython line score-0'>&#xA0;1296: </pre>
<pre class='cython line score-71' onclick='toggleDiv(this)'>+1297: <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">):</span></pre>
<pre class='cython code score-71'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_9contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_8contains[] = " \n  Returns a boolean array identifying whether the points are contained \n  within a closed simplicial complex described by vertices and \n  simplices. This function works for 1, 2, and 3 spatial dimensions.\n\n  Parameters\n  ----------\n    points : (N,D) array\n      Test points\n\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (N,) bool array \n      indicates which test points are in the simplicial complex\n\n  Note\n  ----\n    This function does not ensure that the simplicial complex is\n    closed.  If it is not then bogus results will be returned. \n    \n    This function determines whether a point is contained within the\n    simplicial complex by finding the number of intersections between\n    each point and an arbitrary outside point.  It is possible,\n    although rare, that this function will fail if the line segment\n    intersects a simplex at an edge.\n\n    This function does not require any particular orientation for the \n    simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_9contains = {"contains", (PyCFunction)__pyx_pw_3rbf_8geometry_9contains, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_8contains};
static PyObject *__pyx_pw_3rbf_8geometry_9contains(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_points = 0;
  PyObject *__pyx_v_vertices = 0;
  PyObject *__pyx_v_simplices = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_points,&amp;__pyx_n_s_vertices,&amp;__pyx_n_s_simplices,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_points)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vertices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_simplices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "contains") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_points = values[0];
    __pyx_v_vertices = values[1];
    __pyx_v_simplices = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("contains", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_8contains(__pyx_self, __pyx_v_points, __pyx_v_vertices, __pyx_v_simplices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_8contains(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_points, PyObject *__pyx_v_vertices, PyObject *__pyx_v_simplices) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_vert = NULL;
  PyObject *__pyx_v_outside_point = NULL;
  PyObject *__pyx_v_end_points = NULL;
  PyObject *__pyx_v_crossed_bool = NULL;
  PyObject *__pyx_v_crossed_count = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("contains", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.contains", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_outside_point);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_bool);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crossed_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vertices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_simplices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__66 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_points, __pyx_n_s_vertices, __pyx_n_s_simplices, __pyx_n_s_dim, __pyx_n_s_vert, __pyx_n_s_outside_point, __pyx_n_s_end_points, __pyx_n_s_crossed_bool, __pyx_n_s_crossed_count, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__66)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__66);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__66);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_9contains, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_contains, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__67 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 10, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_contains, 1297, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__67)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1298:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1299: <span class="sd">  Returns a boolean array identifying whether the points are contained </span></pre>
<pre class='cython line score-0'>&#xA0;1300: <span class="sd">  within a closed simplicial complex described by vertices and </span></pre>
<pre class='cython line score-0'>&#xA0;1301: <span class="sd">  simplices. This function works for 1, 2, and 3 spatial dimensions.</span></pre>
<pre class='cython line score-0'>&#xA0;1302: </pre>
<pre class='cython line score-0'>&#xA0;1303: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1304: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1305: <span class="sd">    points : (N,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1306: <span class="sd">      Test points</span></pre>
<pre class='cython line score-0'>&#xA0;1307: </pre>
<pre class='cython line score-0'>&#xA0;1308: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1309: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1310: </pre>
<pre class='cython line score-0'>&#xA0;1311: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1312: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1313: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1314: </pre>
<pre class='cython line score-0'>&#xA0;1315: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1316: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1317: <span class="sd">    out : (N,) bool array </span></pre>
<pre class='cython line score-0'>&#xA0;1318: <span class="sd">      indicates which test points are in the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1319: </pre>
<pre class='cython line score-0'>&#xA0;1320: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1321: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1322: <span class="sd">    This function does not ensure that the simplicial complex is</span></pre>
<pre class='cython line score-0'>&#xA0;1323: <span class="sd">    closed.  If it is not then bogus results will be returned. </span></pre>
<pre class='cython line score-0'>&#xA0;1324: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;1325: <span class="sd">    This function determines whether a point is contained within the</span></pre>
<pre class='cython line score-0'>&#xA0;1326: <span class="sd">    simplicial complex by finding the number of intersections between</span></pre>
<pre class='cython line score-0'>&#xA0;1327: <span class="sd">    each point and an arbitrary outside point.  It is possible,</span></pre>
<pre class='cython line score-0'>&#xA0;1328: <span class="sd">    although rare, that this function will fail if the line segment</span></pre>
<pre class='cython line score-0'>&#xA0;1329: <span class="sd">    intersects a simplex at an edge.</span></pre>
<pre class='cython line score-0'>&#xA0;1330: </pre>
<pre class='cython line score-0'>&#xA0;1331: <span class="sd">    This function does not require any particular orientation for the </span></pre>
<pre class='cython line score-0'>&#xA0;1332: <span class="sd">    simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1333: </pre>
<pre class='cython line score-0'>&#xA0;1334: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+1335:   <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">points</span><span class="p">)</span></pre>
<pre class='cython code score-30'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_points);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_points, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1336:   <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span></pre>
<pre class='cython code score-30'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vertices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vertices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vertices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vertices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vertices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1337:   <span class="n">simplices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-30'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_simplices);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_simplices);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_simplices);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_simplices, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1338:   <span class="n">dim</span> <span class="o">=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='cython line score-20' onclick='toggleDiv(this)'>+1339:   <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">vertices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-20'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vertices, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1340:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;inconsistent spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_inconsistent_spatial_dimensions);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class='cython line score-0'>&#xA0;1341: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1342:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-21' onclick='toggleDiv(this)'>+1343:     <span class="n">vert</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">simplices</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-21'>  __pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
/* … */
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_simplices, __pyx_tuple__23);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vertices, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_vert = __pyx_t_3;
    __pyx_t_3 = 0;
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class='cython line score-33' onclick='toggleDiv(this)'>+1344:     <span class="n">outside_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-33'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_vert);
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_float_1_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_outside_point = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='cython line score-44' onclick='toggleDiv(this)'>+1345:     <span class="n">end_points</span> <span class="o">=</span> <span class="n">outside_point</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-44'>  __pyx_slice__24 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__24);
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_outside_point, __pyx_tuple__25);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_repeat);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_points, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_end_points = __pyx_t_2;
    __pyx_t_2 = 0;
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__24, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1345; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+1346:     <span class="n">crossed_bool</span> <span class="o">=</span> <span class="p">(</span><span class="n">points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">end_points</span><span class="o">-</span><span class="n">vert</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-29'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_points, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_points, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_float_0_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_crossed_bool = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+1347:     <span class="n">crossed_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">crossed_bool</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_crossed_bool);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_crossed_bool);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_crossed_bool);
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1347; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_crossed_count = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+1348:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">crossed_count</span><span class="o">%</span><span class="mf">2</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span></pre>
<pre class='cython code score-31'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_crossed_count, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject*)&amp;PyBool_Type)) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_out = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='cython line score-0'>&#xA0;1349: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1350:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+1351:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_2d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-7'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_2d(__pyx_t_7, __pyx_t_8, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;1352: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1353:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+1354:     <span class="n">out</span> <span class="o">=</span> <span class="n">contains_3d</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vertices</span><span class="p">,</span><span class="n">simplices</span><span class="p">)</span></pre>
<pre class='cython code score-7'>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_points);
    if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_vertices);
    if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(__pyx_v_simplices);
    if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((PyObject *)__pyx_f_3rbf_8geometry_contains_3d(__pyx_t_8, __pyx_t_7, __pyx_t_9));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_out, __pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;1355: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+1356:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_out)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("out"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1357: </pre>
<pre class='cython line score-0'>&#xA0;1358: </pre>
<pre class='cython line score-61' onclick='toggleDiv(this)'>+1359: <span class="k">def</span> <span class="nf">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-61'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_11simplex_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_10simplex_normals[] = " \n  Returns the normal vectors for each simplex. Orientation is \n  determined by the right hand rule\n\n  Parameters\n  ----------\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (P,D) array\n      normals vectors\n      \n  Note\n  ----\n    This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_11simplex_normals = {"simplex_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_11simplex_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_10simplex_normals};
static PyObject *__pyx_pw_3rbf_8geometry_11simplex_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_normals", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_normals") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_10simplex_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_10simplex_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_M = NULL;
  PyObject *__pyx_v_Msubs = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_M);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Msubs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__68 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_M, __pyx_n_s_Msubs, __pyx_n_s_out, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__68)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__68);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__68);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_11simplex_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__69 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__68, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_simplex_normals, 1359, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__69)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1360:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1361: <span class="sd">  Returns the normal vectors for each simplex. Orientation is </span></pre>
<pre class='cython line score-0'>&#xA0;1362: <span class="sd">  determined by the right hand rule</span></pre>
<pre class='cython line score-0'>&#xA0;1363: </pre>
<pre class='cython line score-0'>&#xA0;1364: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1365: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1366: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1367: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1368: </pre>
<pre class='cython line score-0'>&#xA0;1369: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1370: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1371: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1372: </pre>
<pre class='cython line score-0'>&#xA0;1373: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1374: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1375: <span class="sd">    out : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1376: <span class="sd">      normals vectors</span></pre>
<pre class='cython line score-0'>&#xA0;1377: <span class="sd">      </span></pre>
<pre class='cython line score-0'>&#xA0;1378: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1379: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1380: <span class="sd">    This is only defined for two and three dimensional simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1381: </pre>
<pre class='cython line score-0'>&#xA0;1382: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1383:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1384:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1384; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1385: </pre>
<pre class='cython line score-0'>&#xA0;1386:   <span class="c"># spatial dimensions        </span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1387:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1388: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1389:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1389; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1390:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplices must have two or three spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__26, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplices_must_have_two_or_three);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
</pre><pre class='cython line score-0'>&#xA0;1391: </pre>
<pre class='cython line score-0'>&#xA0;1392:   <span class="c"># Create a N by D-1 by D matrix    </span></pre>
<pre class='cython line score-65' onclick='toggleDiv(this)'>+1393:   <span class="n">M</span> <span class="o">=</span> <span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">[:,</span><span class="mf">1</span><span class="p">:]]</span> <span class="o">-</span> <span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">[:,[</span><span class="mf">0</span><span class="p">]]]</span></pre>
<pre class='cython code score-65'>  __pyx_slice__27 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__27);
  __pyx_slice__28 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_smp, __pyx_tuple__29);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__27, __pyx_slice__28);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__30);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_smp, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_M = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_slice__30 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__30);
</pre><pre class='cython line score-0'>&#xA0;1394: </pre>
<pre class='cython line score-96' onclick='toggleDiv(this)'>+1395:   <span class="n">Msubs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span></pre>
<pre class='cython code score-96'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dim);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dim);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dim);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_delete);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_9 = 1;
      }
    }
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_M);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_M);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_v_M);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_int_neg_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_2))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Msubs = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+1396:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">Msubs</span><span class="p">)</span></pre>
<pre class='cython code score-32'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_det);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_Msubs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Msubs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Msubs);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_v_Msubs);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+1397:   <span class="n">out</span><span class="p">[</span><span class="mf">1</span><span class="p">::</span><span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-24'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__31);
  __pyx_t_11 = __pyx_slice__31;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_out, __pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_11, __pyx_t_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__31 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_slice__31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__31);
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1398:   <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-30'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_rollaxis);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_6, __pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_6, __pyx_int_neg_1);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-45' onclick='toggleDiv(this)'>+1399:   <span class="n">out</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mf">1</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span></pre>
<pre class='cython code score-45'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_out);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_neg_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__32);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_v_out, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_out, __pyx_t_4);
  __pyx_t_4 = 0;
/* … */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_Ellipsis, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+1400:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1401: </pre>
<pre class='cython line score-0'>&#xA0;1402: </pre>
<pre class='cython line score-54' onclick='toggleDiv(this)'>+1403: <span class="k">def</span> <span class="nf">simplex_outward_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-54'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_13simplex_outward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_12simplex_outward_normals[] = " \n  Returns the outward normal vectors for each simplex. The sign of the \n  returned vectors are only meaningful if the simplices enclose an \n  area in two-dimensional space or a volume in three-dimensional space\n\n  Parameters\n  ----------\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (P,D) array\n      normals vectors\n      \n  Note\n  ----\n    This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_13simplex_outward_normals = {"simplex_outward_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_13simplex_outward_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_12simplex_outward_normals};
static PyObject *__pyx_pw_3rbf_8geometry_13simplex_outward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_outward_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_outward_normals", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_outward_normals") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_outward_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_outward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_12simplex_outward_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_12simplex_outward_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_outward_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_outward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__70 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim);<span class='error_goto'> if (unlikely(!__pyx_tuple__70)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__70);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__70);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_13simplex_outward_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_outward_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__71 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__70, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_simplex_outward_normals, 1403, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__71)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1404:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1405: <span class="sd">  Returns the outward normal vectors for each simplex. The sign of the </span></pre>
<pre class='cython line score-0'>&#xA0;1406: <span class="sd">  returned vectors are only meaningful if the simplices enclose an </span></pre>
<pre class='cython line score-0'>&#xA0;1407: <span class="sd">  area in two-dimensional space or a volume in three-dimensional space</span></pre>
<pre class='cython line score-0'>&#xA0;1408: </pre>
<pre class='cython line score-0'>&#xA0;1409: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1410: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1411: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1412: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1413: </pre>
<pre class='cython line score-0'>&#xA0;1414: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1415: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1416: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1417: </pre>
<pre class='cython line score-0'>&#xA0;1418: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1419: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1420: <span class="sd">    out : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1421: <span class="sd">      normals vectors</span></pre>
<pre class='cython line score-0'>&#xA0;1422: <span class="sd">      </span></pre>
<pre class='cython line score-0'>&#xA0;1423: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1424: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1425: <span class="sd">    This is only defined for two and three dimensional simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1426: </pre>
<pre class='cython line score-0'>&#xA0;1427: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1428:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1429:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1429; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1430: </pre>
<pre class='cython line score-0'>&#xA0;1431:   <span class="c"># spatial dimensions        </span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1432:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1433: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1434:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1434; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1435:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplices must have two or three spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__33, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplices_must_have_two_or_three);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1435; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
</pre><pre class='cython line score-0'>&#xA0;1436: </pre>
<pre class='cython line score-27' onclick='toggleDiv(this)'>+1437:   <span class="n">smp</span> <span class="o">=</span> <span class="n">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-27'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_oriented_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+1438:   <span class="k">return</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-27'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_6, __pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_6, __pyx_v_smp);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1438; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1439: </pre>
<pre class='cython line score-0'>&#xA0;1440: </pre>
<pre class='cython line score-55' onclick='toggleDiv(this)'>+1441: <span class="k">def</span> <span class="nf">simplex_upward_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-55'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_15simplex_upward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_14simplex_upward_normals[] = " \n  Returns the normal vectors for each simplex whose sign for the last \n  spatial dimension is positive.\n\n  Parameters\n  ----------\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (P,D) array\n      normals vectors\n      \n  Note\n  ----\n    This is only defined for two and three dimensional simplices\n\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_15simplex_upward_normals = {"simplex_upward_normals", (PyCFunction)__pyx_pw_3rbf_8geometry_15simplex_upward_normals, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_14simplex_upward_normals};
static PyObject *__pyx_pw_3rbf_8geometry_15simplex_upward_normals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_upward_normals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_upward_normals", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "simplex_upward_normals") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("simplex_upward_normals", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_upward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_14simplex_upward_normals(__pyx_self, __pyx_v_vert, __pyx_v_smp);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_14simplex_upward_normals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("simplex_upward_normals", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.simplex_upward_normals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__72 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_out);<span class='error_goto'> if (unlikely(!__pyx_tuple__72)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__72);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__72);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_15simplex_upward_normals, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_simplex_upward_normals, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__73 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__72, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_simplex_upward_normals, 1441, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__73)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1442:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1443: <span class="sd">  Returns the normal vectors for each simplex whose sign for the last </span></pre>
<pre class='cython line score-0'>&#xA0;1444: <span class="sd">  spatial dimension is positive.</span></pre>
<pre class='cython line score-0'>&#xA0;1445: </pre>
<pre class='cython line score-0'>&#xA0;1446: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1447: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1448: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1449: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1450: </pre>
<pre class='cython line score-0'>&#xA0;1451: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1452: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1453: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1454: </pre>
<pre class='cython line score-0'>&#xA0;1455: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1456: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1457: <span class="sd">    out : (P,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1458: <span class="sd">      normals vectors</span></pre>
<pre class='cython line score-0'>&#xA0;1459: <span class="sd">      </span></pre>
<pre class='cython line score-0'>&#xA0;1460: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1461: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1462: <span class="sd">    This is only defined for two and three dimensional simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1463: </pre>
<pre class='cython line score-0'>&#xA0;1464: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1465:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1465; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1466:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1467: </pre>
<pre class='cython line score-0'>&#xA0;1468:   <span class="c"># spatial dimensions        </span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1469:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1470: </pre>
<pre class='cython line score-20' onclick='toggleDiv(this)'>+1471:   <span class="k">if</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dim</span> <span class="o">!=</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-20'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1471; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+1472:     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;simplices must have two or three spatial dimensions&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__34, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_simplices_must_have_two_or_three);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
</pre><pre class='cython line score-0'>&#xA0;1473: </pre>
<pre class='cython line score-26' onclick='toggleDiv(this)'>+1474:   <span class="n">out</span> <span class="o">=</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-26'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1474; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+1475:   <span class="n">out</span><span class="p">[</span><span class="n">out</span><span class="p">[:,</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-39'>  __pyx_slice__35 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__35);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_out, __pyx_tuple__36);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_out, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_4, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_2, __pyx_t_3) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__36 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__35, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1475; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__36);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+1476:   <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1477: </pre>
<pre class='cython line score-0'>&#xA0;1478: </pre>
<pre class='cython line score-61' onclick='toggleDiv(this)'>+1479: <span class="k">def</span> <span class="nf">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">):</span></pre>
<pre class='cython code score-61'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_17oriented_simplices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_16oriented_simplices[] = " \n  Returns simplex indices that are ordered such that each simplex \n  normal vector, as defined by the right hand rule, points outward\n                                    \n  Parameters\n  ----------\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n  Returns\n  -------\n    out : (P,D) int array\n      oriented simplices\n\n  Note                                \n  ----                         \n    If one dimensional simplices are given, then the simplices are\n    returned unaltered.\n\n    This function does not ensure that the simplicial complex is\n    closed.  If it is not then bogus results will be returned. \n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_17oriented_simplices = {"oriented_simplices", (PyCFunction)__pyx_pw_3rbf_8geometry_17oriented_simplices, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_16oriented_simplices};
static PyObject *__pyx_pw_3rbf_8geometry_17oriented_simplices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("oriented_simplices (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("oriented_simplices", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "oriented_simplices") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("oriented_simplices", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.oriented_simplices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_16oriented_simplices(__pyx_self, __pyx_v_vert, __pyx_v_smp);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_16oriented_simplices(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_scale = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_norms = NULL;
  PyObject *__pyx_v_points = NULL;
  PyObject *__pyx_v_faces_inside = NULL;
  PyObject *__pyx_v_flip_smp = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("oriented_simplices", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.oriented_simplices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scale);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_norms);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_faces_inside);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flip_smp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__74 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_dim, __pyx_n_s_scale, __pyx_n_s_dx, __pyx_n_s_norms, __pyx_n_s_points, __pyx_n_s_faces_inside, __pyx_n_s_flip_smp);<span class='error_goto'> if (unlikely(!__pyx_tuple__74)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__74);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__74);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_17oriented_simplices, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_oriented_simplices, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__75 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__74, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_oriented_simplices, 1479, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__75)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1480:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1481: <span class="sd">  Returns simplex indices that are ordered such that each simplex </span></pre>
<pre class='cython line score-0'>&#xA0;1482: <span class="sd">  normal vector, as defined by the right hand rule, points outward</span></pre>
<pre class='cython line score-0'>&#xA0;1483: <span class="sd">                                    </span></pre>
<pre class='cython line score-0'>&#xA0;1484: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1485: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1486: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1487: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1488: </pre>
<pre class='cython line score-0'>&#xA0;1489: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1490: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1491: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1492: </pre>
<pre class='cython line score-0'>&#xA0;1493: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1494: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1495: <span class="sd">    out : (P,D) int array</span></pre>
<pre class='cython line score-0'>&#xA0;1496: <span class="sd">      oriented simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1497: </pre>
<pre class='cython line score-0'>&#xA0;1498: <span class="sd">  Note                                </span></pre>
<pre class='cython line score-0'>&#xA0;1499: <span class="sd">  ----                         </span></pre>
<pre class='cython line score-0'>&#xA0;1500: <span class="sd">    If one dimensional simplices are given, then the simplices are</span></pre>
<pre class='cython line score-0'>&#xA0;1501: <span class="sd">    returned unaltered.</span></pre>
<pre class='cython line score-0'>&#xA0;1502: </pre>
<pre class='cython line score-0'>&#xA0;1503: <span class="sd">    This function does not ensure that the simplicial complex is</span></pre>
<pre class='cython line score-0'>&#xA0;1504: <span class="sd">    closed.  If it is not then bogus results will be returned. </span></pre>
<pre class='cython line score-0'>&#xA0;1505: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1506:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-33' onclick='toggleDiv(this)'>+1507:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-33'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;1508: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1509:   <span class="n">dim</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_vert, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1510: </pre>
<pre class='cython line score-0'>&#xA0;1511:   <span class="c"># if 1D then return smp</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1512:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+1513:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-30'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_smp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_smp);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;1514: </pre>
<pre class='cython line score-0'>&#xA0;1515:   <span class="c"># length scale of the domain</span></pre>
<pre class='cython line score-65' onclick='toggleDiv(this)'>+1516:   <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span></pre>
<pre class='cython code score-65'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vert);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_vert);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_scale = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1517:   <span class="n">dx</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="o">*</span><span class="n">scale</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_1eneg_10, __pyx_v_scale);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_dx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;1518: </pre>
<pre class='cython line score-0'>&#xA0;1519:   <span class="c"># find the normal for each simplex    </span></pre>
<pre class='cython line score-26' onclick='toggleDiv(this)'>+1520:   <span class="n">norms</span> <span class="o">=</span> <span class="n">simplex_normals</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-26'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_simplex_normals);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_7, __pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_7, __pyx_v_smp);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_norms = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;1521: </pre>
<pre class='cython line score-0'>&#xA0;1522:   <span class="c"># find the centroid for each simplex      </span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+1523:   <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-31'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_points = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1524: </pre>
<pre class='cython line score-0'>&#xA0;1525:   <span class="c"># push points in the direction of the normals  </span></pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+1526:   <span class="n">points</span> <span class="o">+=</span> <span class="n">dx</span><span class="o">*</span><span class="n">norms</span></pre>
<pre class='cython code score-12'>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_dx, __pyx_v_norms);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_points, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_points, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;1527: </pre>
<pre class='cython line score-0'>&#xA0;1528:   <span class="c"># find which simplices are oriented such that their normals point  </span></pre>
<pre class='cython line score-0'>&#xA0;1529:   <span class="c"># inside                           </span></pre>
<pre class='cython line score-28' onclick='toggleDiv(this)'>+1530:   <span class="n">faces_inside</span> <span class="o">=</span> <span class="n">contains</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_contains);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_6) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_points);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_7, __pyx_v_points);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_7, __pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_7, __pyx_v_smp);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_faces_inside = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-0'>&#xA0;1531: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1532:   <span class="n">flip_smp</span> <span class="o">=</span> <span class="n">smp</span><span class="p">[</span><span class="n">faces_inside</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_smp, __pyx_v_faces_inside);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_flip_smp = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='cython line score-57' onclick='toggleDiv(this)'>+1533:   <span class="n">flip_smp</span><span class="p">[:,[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flip_smp</span><span class="p">[:,[</span><span class="mf">1</span><span class="p">,</span><span class="mf">0</span><span class="p">]]</span></pre>
<pre class='cython code score-57'>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_flip_smp, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__37 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_flip_smp, __pyx_t_3, __pyx_t_4) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_slice__38 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
</pre><pre class='cython line score-0'>&#xA0;1534: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1535:   <span class="n">smp</span><span class="p">[</span><span class="n">faces_inside</span><span class="p">]</span> <span class="o">=</span> <span class="n">flip_smp</span></pre>
<pre class='cython code score-5'>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_smp, __pyx_v_faces_inside, __pyx_v_flip_smp) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+1536:   <span class="k">return</span> <span class="n">smp</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  __pyx_r = __pyx_v_smp;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1537: </pre>
<pre class='cython line score-0'>&#xA0;1538: </pre>
<pre class='cython line score-66' onclick='toggleDiv(this)'>+1539: <span class="k">def</span> <span class="nf">enclosure</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-66'>/* Python wrapper */
static PyObject *__pyx_pw_3rbf_8geometry_19enclosure(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3rbf_8geometry_18enclosure[] = " \n  Returns the volume of a polyhedra, area of a polygon, or length of\n  a segment enclosed by the simplices\n\n  Parameters\n  ----------\n    vertices : (M,D) array\n      Vertices within the simplicial complex\n\n    simplices : (P,D) int array \n      Connectivity of the vertices. Each row contains the vertex \n      indices which form one simplex of the simplicial complex\n\n    orient : bool, optional\n      If true, the simplices are reordered with oriented_simplices. \n      The time for this function increase quadratically with the \n      number of simplices. Set to false if you are confident that the \n      simplices are properly oriented. This does nothing for \n      one-dimensional simplices\n\n  Returns\n  -------\n    out : float\n     \n  Note\n  ----\n    This function does not ensure that the simplicial complex is \n    closed and does not intersect itself. If it is not then bogus \n    results will be returned.\n  ";
static PyMethodDef __pyx_mdef_3rbf_8geometry_19enclosure = {"enclosure", (PyCFunction)__pyx_pw_3rbf_8geometry_19enclosure, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3rbf_8geometry_18enclosure};
static PyObject *__pyx_pw_3rbf_8geometry_19enclosure(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vert = 0;
  PyObject *__pyx_v_smp = 0;
  PyObject *__pyx_v_orient = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("enclosure (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vert,&amp;__pyx_n_s_smp,&amp;__pyx_n_s_orient,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_vert)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_smp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("enclosure", 0, 2, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_orient);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "enclosure") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vert = values[0];
    __pyx_v_smp = values[1];
    __pyx_v_orient = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("enclosure", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.enclosure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3rbf_8geometry_18enclosure(__pyx_self, __pyx_v_vert, __pyx_v_smp, __pyx_v_orient);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3rbf_8geometry_18enclosure(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vert, PyObject *__pyx_v_smp, PyObject *__pyx_v_orient) {
  PyObject *__pyx_v_dim = NULL;
  PyObject *__pyx_v_signed_volumes = NULL;
  PyObject *__pyx_v_volume = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("enclosure", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("rbf.geometry.enclosure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_signed_volumes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_volume);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vert);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__76 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_vert, __pyx_n_s_smp, __pyx_n_s_orient, __pyx_n_s_dim, __pyx_n_s_signed_volumes, __pyx_n_s_volume);<span class='error_goto'> if (unlikely(!__pyx_tuple__76)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__76);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__76);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3rbf_8geometry_19enclosure, NULL, __pyx_n_s_rbf_geometry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_enclosure, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__77 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__76, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_hinest_Packages_RBF_rbf_ge, __pyx_n_s_enclosure, 1539, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__77)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;1540:   <span class="sd">&#39;&#39;&#39; </span></pre>
<pre class='cython line score-0'>&#xA0;1541: <span class="sd">  Returns the volume of a polyhedra, area of a polygon, or length of</span></pre>
<pre class='cython line score-0'>&#xA0;1542: <span class="sd">  a segment enclosed by the simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1543: </pre>
<pre class='cython line score-0'>&#xA0;1544: <span class="sd">  Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;1545: <span class="sd">  ----------</span></pre>
<pre class='cython line score-0'>&#xA0;1546: <span class="sd">    vertices : (M,D) array</span></pre>
<pre class='cython line score-0'>&#xA0;1547: <span class="sd">      Vertices within the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1548: </pre>
<pre class='cython line score-0'>&#xA0;1549: <span class="sd">    simplices : (P,D) int array </span></pre>
<pre class='cython line score-0'>&#xA0;1550: <span class="sd">      Connectivity of the vertices. Each row contains the vertex </span></pre>
<pre class='cython line score-0'>&#xA0;1551: <span class="sd">      indices which form one simplex of the simplicial complex</span></pre>
<pre class='cython line score-0'>&#xA0;1552: </pre>
<pre class='cython line score-0'>&#xA0;1553: <span class="sd">    orient : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;1554: <span class="sd">      If true, the simplices are reordered with oriented_simplices. </span></pre>
<pre class='cython line score-0'>&#xA0;1555: <span class="sd">      The time for this function increase quadratically with the </span></pre>
<pre class='cython line score-0'>&#xA0;1556: <span class="sd">      number of simplices. Set to false if you are confident that the </span></pre>
<pre class='cython line score-0'>&#xA0;1557: <span class="sd">      simplices are properly oriented. This does nothing for </span></pre>
<pre class='cython line score-0'>&#xA0;1558: <span class="sd">      one-dimensional simplices</span></pre>
<pre class='cython line score-0'>&#xA0;1559: </pre>
<pre class='cython line score-0'>&#xA0;1560: <span class="sd">  Returns</span></pre>
<pre class='cython line score-0'>&#xA0;1561: <span class="sd">  -------</span></pre>
<pre class='cython line score-0'>&#xA0;1562: <span class="sd">    out : float</span></pre>
<pre class='cython line score-0'>&#xA0;1563: <span class="sd">     </span></pre>
<pre class='cython line score-0'>&#xA0;1564: <span class="sd">  Note</span></pre>
<pre class='cython line score-0'>&#xA0;1565: <span class="sd">  ----</span></pre>
<pre class='cython line score-0'>&#xA0;1566: <span class="sd">    This function does not ensure that the simplicial complex is </span></pre>
<pre class='cython line score-0'>&#xA0;1567: <span class="sd">    closed and does not intersect itself. If it is not then bogus </span></pre>
<pre class='cython line score-0'>&#xA0;1568: <span class="sd">    results will be returned.</span></pre>
<pre class='cython line score-0'>&#xA0;1569: <span class="sd">  &#39;&#39;&#39;</span></pre>
<pre class='cython line score-33' onclick='toggleDiv(this)'>+1570:   <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-33'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_vert);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyFloat_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_copy, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1570; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+1571:   <span class="n">smp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">smp</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_smp);
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)((PyObject*)(&amp;PyInt_Type)))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1572:   <span class="n">dim</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_smp, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1572; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+1573:   <span class="k">if</span> <span class="n">orient</span><span class="p">:</span></pre>
<pre class='cython code score-2'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_orient);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1573; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_5) {
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+1574:     <span class="n">smp</span> <span class="o">=</span> <span class="n">oriented_simplices</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">smp</span><span class="p">)</span></pre>
<pre class='cython code score-27'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_oriented_simplices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_vert);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_smp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_smp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_v_smp);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_smp, __pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1575: </pre>
<pre class='cython line score-0'>&#xA0;1576:   <span class="c"># If 1D vertices and simplices are given then sort the vertices</span></pre>
<pre class='cython line score-0'>&#xA0;1577:   <span class="c"># and sum the length between alternating pairs of vertices</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+1578:   <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_dim, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1578; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
</pre><pre class='cython line score-54' onclick='toggleDiv(this)'>+1579:     <span class="n">vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span></pre>
<pre class='cython code score-54'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1579; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+1580:     <span class="n">vert</span><span class="p">[::</span><span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-24'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__39);
    __pyx_t_8 = __pyx_slice__39;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_vert, __pyx_t_8, __pyx_t_3) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_slice__39 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_slice__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__39);
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+1581:     <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vert</span><span class="p">))</span></pre>
<pre class='cython code score-36'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_vert);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_vert);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Absolute</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;1582: </pre>
<pre class='cython line score-0'>&#xA0;1583:   <span class="c"># center the vertices for the purpose of numerical stability</span></pre>
<pre class='cython line score-34' onclick='toggleDiv(this)'>+1584:   <span class="n">vert</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vert</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-34'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vert);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_vert);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_v_vert, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_vert, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-73' onclick='toggleDiv(this)'>+1585:   <span class="n">signed_volumes</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">vert</span><span class="p">[</span><span class="n">smp</span><span class="p">])</span></pre>
<pre class='cython code score-73'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_dim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dim);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dim);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_dim);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_float_1_0, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_det);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vert, __pyx_v_smp);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1585; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_signed_volumes = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+1586:   <span class="n">volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">signed_volumes</span><span class="p">)</span></pre>
<pre class='cython code score-29'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_signed_volumes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_signed_volumes);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_signed_volumes);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_signed_volumes);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_volume = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+1587:   <span class="k">return</span> <span class="n">volume</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_volume);
  __pyx_r = __pyx_v_volume;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1588: </pre>
<pre class='cython line score-0'>&#xA0;1589: </pre>
</div></body></html>
